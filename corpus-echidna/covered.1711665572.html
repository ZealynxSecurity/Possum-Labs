<style> code { white-space: pre-wrap; display: block; background-color: #eee; }.executed { background-color: #afa; }.reverted { background-color: #ffa; }.unexecuted { background-color: #faa; }.neutral { background-color: #eee; }</style><b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/interfaces/IERC165.sol</b>
<code>
 1 |     | <span class='unexecuted'>// SPDX-License-Identifier: MIT</span>
 2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (interfaces/IERC165.sol)</span>
 3 |     | <span class='neutral'></span>
 4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
 5 |     | <span class='neutral'></span>
 6 |     | <span class='neutral'>import &quot;../utils/introspection/IERC165.sol&quot;;</span>
 7 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/interfaces/IERC4906.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (interfaces/IERC4906.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./IERC165.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;./IERC721.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>/// @title EIP-721 Metadata Update Extension</span>
 10 |     | <span class='neutral'>interface IERC4906 is IERC165, IERC721 {</span>
 11 |     | <span class='neutral'>    /// @dev This event emits when the metadata of a token is changed.</span>
 12 |     | <span class='neutral'>    /// So that the third-party platforms such as NFT market could</span>
 13 |     | <span class='neutral'>    /// timely update the images and related attributes of the NFT.</span>
 14 |     | <span class='neutral'>    event MetadataUpdate(uint256 _tokenId);</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    /// @dev This event emits when the metadata of a range of tokens is changed.</span>
 17 |     | <span class='neutral'>    /// So that the third-party platforms such as NFT market could</span>
 18 |     | <span class='neutral'>    /// timely update the images and related attributes of the NFTs.</span>
 19 |     | <span class='neutral'>    event BatchMetadataUpdate(uint256 _fromTokenId, uint256 _toTokenId);</span>
 20 |     | <span class='neutral'>}</span>
 21 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/interfaces/IERC5267.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (interfaces/IERC5267.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>interface IERC5267 {</span>
  7 |     | <span class='neutral'>    /**</span>
  8 |     | <span class='neutral'>     * @dev MAY be emitted to signal that the domain could have changed.</span>
  9 |     | <span class='neutral'>     */</span>
 10 |     | <span class='neutral'>    event EIP712DomainChanged();</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>    /**</span>
 13 |     | <span class='neutral'>     * @dev returns the fields and values that describe the domain separator used by this contract for EIP-712</span>
 14 |     | <span class='neutral'>     * signature.</span>
 15 |     | <span class='neutral'>     */</span>
 16 |     | <span class='neutral'>    function eip712Domain()</span>
 17 |     | <span class='neutral'>        external</span>
 18 |     | <span class='neutral'>        view</span>
 19 |     | <span class='neutral'>        returns (</span>
 20 |     | <span class='neutral'>            bytes1 fields,</span>
 21 |     | <span class='neutral'>            string memory name,</span>
 22 |     | <span class='neutral'>            string memory version,</span>
 23 |     | <span class='neutral'>            uint256 chainId,</span>
 24 |     | <span class='neutral'>            address verifyingContract,</span>
 25 |     | <span class='neutral'>            bytes32 salt,</span>
 26 |     | <span class='neutral'>            uint256[] memory extensions</span>
 27 |     | <span class='neutral'>        );</span>
 28 |     | <span class='neutral'>}</span>
 29 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/interfaces/IERC721.sol</b>
<code>
 1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
 2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (interfaces/IERC721.sol)</span>
 3 |     | <span class='neutral'></span>
 4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
 5 |     | <span class='neutral'></span>
 6 |     | <span class='neutral'>import &quot;../token/ERC721/IERC721.sol&quot;;</span>
 7 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/security/ReentrancyGuard.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (security/ReentrancyGuard.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Contract module that helps prevent reentrant calls to a function.</span>
  8 |     | <span class='neutral'> *</span>
  9 |     | <span class='neutral'> * Inheriting from `ReentrancyGuard` will make the {nonReentrant} modifier</span>
 10 |     | <span class='neutral'> * available, which can be applied to functions to make sure there are no nested</span>
 11 |     | <span class='neutral'> * (reentrant) calls to them.</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> * Note that because there is a single `nonReentrant` guard, functions marked as</span>
 14 |     | <span class='neutral'> * `nonReentrant` may not call one another. This can be worked around by making</span>
 15 |     | <span class='neutral'> * those functions `private`, and then adding `external` `nonReentrant` entry</span>
 16 |     | <span class='neutral'> * points to them.</span>
 17 |     | <span class='neutral'> *</span>
 18 |     | <span class='neutral'> * TIP: If you would like to learn more about reentrancy and alternative ways</span>
 19 |     | <span class='neutral'> * to protect against it, check out our blog post</span>
 20 |     | <span class='neutral'> * https://blog.openzeppelin.com/reentrancy-after-istanbul/[Reentrancy After Istanbul].</span>
 21 |     | <span class='neutral'> */</span>
 22 |     | <span class='neutral'>abstract contract ReentrancyGuard {</span>
 23 |     | <span class='neutral'>    // Booleans are more expensive than uint256 or any type that takes up a full</span>
 24 |     | <span class='neutral'>    // word because each write operation emits an extra SLOAD to first read the</span>
 25 |     | <span class='neutral'>    // slot&#39;s contents, replace the bits taken up by the boolean, and then write</span>
 26 |     | <span class='neutral'>    // back. This is the compiler&#39;s defense against contract upgrades and</span>
 27 |     | <span class='neutral'>    // pointer aliasing, and it cannot be disabled.</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    // The values being non-zero value makes deployment a bit more expensive,</span>
 30 |     | <span class='neutral'>    // but in exchange the refund on every call to nonReentrant will be lower in</span>
 31 |     | <span class='neutral'>    // amount. Since refunds are capped to a percentage of the total</span>
 32 |     | <span class='neutral'>    // transaction&#39;s gas, it is best to keep them low in cases like this one, to</span>
 33 |     | <span class='neutral'>    // increase the likelihood of the full refund coming into effect.</span>
 34 |     | <span class='unexecuted'>    uint256 private constant _NOT_ENTERED = 1;</span>
 35 |     | <span class='unexecuted'>    uint256 private constant _ENTERED = 2;</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>    uint256 private _status;</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='neutral'>    constructor() {</span>
 40 |     | <span class='unexecuted'>        _status = _NOT_ENTERED;</span>
 41 |     | <span class='neutral'>    }</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='neutral'>    /**</span>
 44 |     | <span class='neutral'>     * @dev Prevents a contract from calling itself, directly or indirectly.</span>
 45 |     | <span class='neutral'>     * Calling a `nonReentrant` function from another `nonReentrant`</span>
 46 |     | <span class='neutral'>     * function is not supported. It is possible to prevent this from happening</span>
 47 |     | <span class='neutral'>     * by making the `nonReentrant` function external, and making it call a</span>
 48 |     | <span class='neutral'>     * `private` function that does the actual work.</span>
 49 |     | <span class='neutral'>     */</span>
 50 |     | <span class='neutral'>    modifier nonReentrant() {</span>
 51 |     | <span class='unexecuted'>        _nonReentrantBefore();</span>
 52 |     | <span class='neutral'>        _;</span>
 53 |     | <span class='unexecuted'>        _nonReentrantAfter();</span>
 54 |     | <span class='neutral'>    }</span>
 55 |     | <span class='neutral'></span>
 56 |     | <span class='unexecuted'>    function _nonReentrantBefore() private {</span>
 57 |     | <span class='neutral'>        // On the first call to nonReentrant, _status will be _NOT_ENTERED</span>
 58 |     | <span class='unexecuted'>        require(_status != _ENTERED, &quot;ReentrancyGuard: reentrant call&quot;);</span>
 59 |     | <span class='neutral'></span>
 60 |     | <span class='neutral'>        // Any calls to nonReentrant after this point will fail</span>
 61 |     | <span class='unexecuted'>        _status = _ENTERED;</span>
 62 |     | <span class='neutral'>    }</span>
 63 |     | <span class='neutral'></span>
 64 |     | <span class='unexecuted'>    function _nonReentrantAfter() private {</span>
 65 |     | <span class='neutral'>        // By storing the original value once again, a refund is triggered (see</span>
 66 |     | <span class='neutral'>        // https://eips.ethereum.org/EIPS/eip-2200)</span>
 67 |     | <span class='unexecuted'>        _status = _NOT_ENTERED;</span>
 68 |     | <span class='neutral'>    }</span>
 69 |     | <span class='neutral'></span>
 70 |     | <span class='neutral'>    /**</span>
 71 |     | <span class='neutral'>     * @dev Returns true if the reentrancy guard is currently set to &quot;entered&quot;, which indicates there is a</span>
 72 |     | <span class='neutral'>     * `nonReentrant` function in the call stack.</span>
 73 |     | <span class='neutral'>     */</span>
 74 |     | <span class='neutral'>    function _reentrancyGuardEntered() internal view returns (bool) {</span>
 75 |     | <span class='neutral'>        return _status == _ENTERED;</span>
 76 |     | <span class='neutral'>    }</span>
 77 |     | <span class='neutral'>}</span>
 78 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/ERC20.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./IERC20.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;./extensions/IERC20Metadata.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../../utils/Context.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @dev Implementation of the {IERC20} interface.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * This implementation is agnostic to the way tokens are created. This means</span>
  14 |     | <span class='neutral'> * that a supply mechanism has to be added in a derived contract using {_mint}.</span>
  15 |     | <span class='neutral'> * For a generic mechanism see {ERC20PresetMinterPauser}.</span>
  16 |     | <span class='neutral'> *</span>
  17 |     | <span class='neutral'> * TIP: For a detailed writeup see our guide</span>
  18 |     | <span class='neutral'> * https://forum.openzeppelin.com/t/how-to-implement-erc20-supply-mechanisms/226[How</span>
  19 |     | <span class='neutral'> * to implement supply mechanisms].</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> * The default value of {decimals} is 18. To change this, you should override</span>
  22 |     | <span class='neutral'> * this function so it returns a different value.</span>
  23 |     | <span class='neutral'> *</span>
  24 |     | <span class='neutral'> * We have followed general OpenZeppelin Contracts guidelines: functions revert</span>
  25 |     | <span class='neutral'> * instead returning `false` on failure. This behavior is nonetheless</span>
  26 |     | <span class='neutral'> * conventional and does not conflict with the expectations of ERC20</span>
  27 |     | <span class='neutral'> * applications.</span>
  28 |     | <span class='neutral'> *</span>
  29 |     | <span class='neutral'> * Additionally, an {Approval} event is emitted on calls to {transferFrom}.</span>
  30 |     | <span class='neutral'> * This allows applications to reconstruct the allowance for all accounts just</span>
  31 |     | <span class='neutral'> * by listening to said events. Other implementations of the EIP may not emit</span>
  32 |     | <span class='neutral'> * these events, as it isn&#39;t required by the specification.</span>
  33 |     | <span class='neutral'> *</span>
  34 |     | <span class='neutral'> * Finally, the non-standard {decreaseAllowance} and {increaseAllowance}</span>
  35 |     | <span class='neutral'> * functions have been added to mitigate the well-known issues around setting</span>
  36 |     | <span class='neutral'> * allowances. See {IERC20-approve}.</span>
  37 |     | <span class='neutral'> */</span>
  38 |     | <span class='unexecuted'>contract ERC20 is Context, IERC20, IERC20Metadata {</span>
  39 |     | <span class='neutral'>    mapping(address =&gt; uint256) private _balances;</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>    mapping(address =&gt; mapping(address =&gt; uint256)) private _allowances;</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>    uint256 private _totalSupply;</span>
  44 |     | <span class='neutral'></span>
  45 |     | <span class='neutral'>    string private _name;</span>
  46 |     | <span class='neutral'>    string private _symbol;</span>
  47 |     | <span class='neutral'></span>
  48 |     | <span class='neutral'>    /**</span>
  49 |     | <span class='neutral'>     * @dev Sets the values for {name} and {symbol}.</span>
  50 |     | <span class='neutral'>     *</span>
  51 |     | <span class='neutral'>     * All two of these values are immutable: they can only be set once during</span>
  52 |     | <span class='neutral'>     * construction.</span>
  53 |     | <span class='neutral'>     */</span>
  54 |     | <span class='unexecuted'>    constructor(string memory name_, string memory symbol_) {</span>
  55 |     | <span class='unexecuted'>        _name = name_;</span>
  56 |     | <span class='unexecuted'>        _symbol = symbol_;</span>
  57 |     | <span class='neutral'>    }</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    /**</span>
  60 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
  61 |     | <span class='neutral'>     */</span>
  62 |     | <span class='unexecuted'>    function name() public view virtual override returns (string memory) {</span>
  63 |     | <span class='unexecuted'>        return _name;</span>
  64 |     | <span class='neutral'>    }</span>
  65 |     | <span class='neutral'></span>
  66 |     | <span class='neutral'>    /**</span>
  67 |     | <span class='neutral'>     * @dev Returns the symbol of the token, usually a shorter version of the</span>
  68 |     | <span class='neutral'>     * name.</span>
  69 |     | <span class='neutral'>     */</span>
  70 |     | <span class='unexecuted'>    function symbol() public view virtual override returns (string memory) {</span>
  71 |     | <span class='unexecuted'>        return _symbol;</span>
  72 |     | <span class='neutral'>    }</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='neutral'>    /**</span>
  75 |     | <span class='neutral'>     * @dev Returns the number of decimals used to get its user representation.</span>
  76 |     | <span class='neutral'>     * For example, if `decimals` equals `2`, a balance of `505` tokens should</span>
  77 |     | <span class='neutral'>     * be displayed to a user as `5.05` (`505 / 10 ** 2`).</span>
  78 |     | <span class='neutral'>     *</span>
  79 |     | <span class='neutral'>     * Tokens usually opt for a value of 18, imitating the relationship between</span>
  80 |     | <span class='neutral'>     * Ether and Wei. This is the default value returned by this function, unless</span>
  81 |     | <span class='neutral'>     * it&#39;s overridden.</span>
  82 |     | <span class='neutral'>     *</span>
  83 |     | <span class='neutral'>     * NOTE: This information is only used for _display_ purposes: it in</span>
  84 |     | <span class='neutral'>     * no way affects any of the arithmetic of the contract, including</span>
  85 |     | <span class='neutral'>     * {IERC20-balanceOf} and {IERC20-transfer}.</span>
  86 |     | <span class='neutral'>     */</span>
  87 |     | <span class='unexecuted'>    function decimals() public view virtual override returns (uint8) {</span>
  88 |     | <span class='unexecuted'>        return 18;</span>
  89 |     | <span class='neutral'>    }</span>
  90 |     | <span class='neutral'></span>
  91 |     | <span class='neutral'>    /**</span>
  92 |     | <span class='neutral'>     * @dev See {IERC20-totalSupply}.</span>
  93 |     | <span class='neutral'>     */</span>
  94 |     | <span class='unexecuted'>    function totalSupply() public view virtual override returns (uint256) {</span>
  95 |     | <span class='unexecuted'>        return _totalSupply;</span>
  96 |     | <span class='neutral'>    }</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>    /**</span>
  99 |     | <span class='neutral'>     * @dev See {IERC20-balanceOf}.</span>
 100 |     | <span class='neutral'>     */</span>
 101 |     | <span class='unexecuted'>    function balanceOf(address account) public view virtual override returns (uint256) {</span>
 102 |     | <span class='unexecuted'>        return _balances[account];</span>
 103 |     | <span class='neutral'>    }</span>
 104 |     | <span class='neutral'></span>
 105 |     | <span class='neutral'>    /**</span>
 106 |     | <span class='neutral'>     * @dev See {IERC20-transfer}.</span>
 107 |     | <span class='neutral'>     *</span>
 108 |     | <span class='neutral'>     * Requirements:</span>
 109 |     | <span class='neutral'>     *</span>
 110 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 111 |     | <span class='neutral'>     * - the caller must have a balance of at least `amount`.</span>
 112 |     | <span class='neutral'>     */</span>
 113 |     | <span class='unexecuted'>    function transfer(address to, uint256 amount) public virtual override returns (bool) {</span>
 114 |     | <span class='neutral'>        address owner = _msgSender();</span>
 115 |     | <span class='unexecuted'>        _transfer(owner, to, amount);</span>
 116 |     | <span class='neutral'>        return true;</span>
 117 |     | <span class='neutral'>    }</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>    /**</span>
 120 |     | <span class='neutral'>     * @dev See {IERC20-allowance}.</span>
 121 |     | <span class='neutral'>     */</span>
 122 |     | <span class='unexecuted'>    function allowance(address owner, address spender) public view virtual override returns (uint256) {</span>
 123 |     | <span class='unexecuted'>        return _allowances[owner][spender];</span>
 124 |     | <span class='neutral'>    }</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    /**</span>
 127 |     | <span class='neutral'>     * @dev See {IERC20-approve}.</span>
 128 |     | <span class='neutral'>     *</span>
 129 |     | <span class='neutral'>     * NOTE: If `amount` is the maximum `uint256`, the allowance is not updated on</span>
 130 |     | <span class='neutral'>     * `transferFrom`. This is semantically equivalent to an infinite approval.</span>
 131 |     | <span class='neutral'>     *</span>
 132 |     | <span class='neutral'>     * Requirements:</span>
 133 |     | <span class='neutral'>     *</span>
 134 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 135 |     | <span class='neutral'>     */</span>
 136 |     | <span class='unexecuted'>    function approve(address spender, uint256 amount) public virtual override returns (bool) {</span>
 137 |     | <span class='neutral'>        address owner = _msgSender();</span>
 138 |     | <span class='unexecuted'>        _approve(owner, spender, amount);</span>
 139 |     | <span class='unexecuted'>        return true;</span>
 140 |     | <span class='neutral'>    }</span>
 141 |     | <span class='neutral'></span>
 142 |     | <span class='neutral'>    /**</span>
 143 |     | <span class='neutral'>     * @dev See {IERC20-transferFrom}.</span>
 144 |     | <span class='neutral'>     *</span>
 145 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance. This is not</span>
 146 |     | <span class='neutral'>     * required by the EIP. See the note at the beginning of {ERC20}.</span>
 147 |     | <span class='neutral'>     *</span>
 148 |     | <span class='neutral'>     * NOTE: Does not update the allowance if the current allowance</span>
 149 |     | <span class='neutral'>     * is the maximum `uint256`.</span>
 150 |     | <span class='neutral'>     *</span>
 151 |     | <span class='neutral'>     * Requirements:</span>
 152 |     | <span class='neutral'>     *</span>
 153 |     | <span class='neutral'>     * - `from` and `to` cannot be the zero address.</span>
 154 |     | <span class='neutral'>     * - `from` must have a balance of at least `amount`.</span>
 155 |     | <span class='neutral'>     * - the caller must have allowance for ``from``&#39;s tokens of at least</span>
 156 |     | <span class='neutral'>     * `amount`.</span>
 157 |     | <span class='neutral'>     */</span>
 158 |     | <span class='unexecuted'>    function transferFrom(address from, address to, uint256 amount) public virtual override returns (bool) {</span>
 159 |     | <span class='neutral'>        address spender = _msgSender();</span>
 160 |     | <span class='unexecuted'>        _spendAllowance(from, spender, amount);</span>
 161 |     | <span class='unexecuted'>        _transfer(from, to, amount);</span>
 162 |     | <span class='unexecuted'>        return true;</span>
 163 |     | <span class='neutral'>    }</span>
 164 |     | <span class='neutral'></span>
 165 |     | <span class='neutral'>    /**</span>
 166 |     | <span class='neutral'>     * @dev Atomically increases the allowance granted to `spender` by the caller.</span>
 167 |     | <span class='neutral'>     *</span>
 168 |     | <span class='neutral'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 169 |     | <span class='neutral'>     * problems described in {IERC20-approve}.</span>
 170 |     | <span class='neutral'>     *</span>
 171 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance.</span>
 172 |     | <span class='neutral'>     *</span>
 173 |     | <span class='neutral'>     * Requirements:</span>
 174 |     | <span class='neutral'>     *</span>
 175 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 176 |     | <span class='neutral'>     */</span>
 177 |     | <span class='unexecuted'>    function increaseAllowance(address spender, uint256 addedValue) public virtual returns (bool) {</span>
 178 |     | <span class='neutral'>        address owner = _msgSender();</span>
 179 |     | <span class='unexecuted'>        _approve(owner, spender, allowance(owner, spender) + addedValue);</span>
 180 |     | <span class='neutral'>        return true;</span>
 181 |     | <span class='neutral'>    }</span>
 182 |     | <span class='neutral'></span>
 183 |     | <span class='neutral'>    /**</span>
 184 |     | <span class='neutral'>     * @dev Atomically decreases the allowance granted to `spender` by the caller.</span>
 185 |     | <span class='neutral'>     *</span>
 186 |     | <span class='neutral'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 187 |     | <span class='neutral'>     * problems described in {IERC20-approve}.</span>
 188 |     | <span class='neutral'>     *</span>
 189 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance.</span>
 190 |     | <span class='neutral'>     *</span>
 191 |     | <span class='neutral'>     * Requirements:</span>
 192 |     | <span class='neutral'>     *</span>
 193 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 194 |     | <span class='neutral'>     * - `spender` must have allowance for the caller of at least</span>
 195 |     | <span class='neutral'>     * `subtractedValue`.</span>
 196 |     | <span class='neutral'>     */</span>
 197 |     | <span class='unexecuted'>    function decreaseAllowance(address spender, uint256 subtractedValue) public virtual returns (bool) {</span>
 198 |     | <span class='neutral'>        address owner = _msgSender();</span>
 199 |     | <span class='unexecuted'>        uint256 currentAllowance = allowance(owner, spender);</span>
 200 |     | <span class='unexecuted'>        require(currentAllowance &gt;= subtractedValue, &quot;ERC20: decreased allowance below zero&quot;);</span>
 201 |     | <span class='neutral'>        unchecked {</span>
 202 |     | <span class='unexecuted'>            _approve(owner, spender, currentAllowance - subtractedValue);</span>
 203 |     | <span class='neutral'>        }</span>
 204 |     | <span class='neutral'></span>
 205 |     | <span class='neutral'>        return true;</span>
 206 |     | <span class='neutral'>    }</span>
 207 |     | <span class='neutral'></span>
 208 |     | <span class='neutral'>    /**</span>
 209 |     | <span class='neutral'>     * @dev Moves `amount` of tokens from `from` to `to`.</span>
 210 |     | <span class='neutral'>     *</span>
 211 |     | <span class='neutral'>     * This internal function is equivalent to {transfer}, and can be used to</span>
 212 |     | <span class='neutral'>     * e.g. implement automatic token fees, slashing mechanisms, etc.</span>
 213 |     | <span class='neutral'>     *</span>
 214 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 215 |     | <span class='neutral'>     *</span>
 216 |     | <span class='neutral'>     * Requirements:</span>
 217 |     | <span class='neutral'>     *</span>
 218 |     | <span class='neutral'>     * - `from` cannot be the zero address.</span>
 219 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 220 |     | <span class='neutral'>     * - `from` must have a balance of at least `amount`.</span>
 221 |     | <span class='neutral'>     */</span>
 222 |     | <span class='unexecuted'>    function _transfer(address from, address to, uint256 amount) internal virtual {</span>
 223 |     | <span class='unexecuted'>        require(from != address(0), &quot;ERC20: transfer from the zero address&quot;);</span>
 224 |     | <span class='unexecuted'>        require(to != address(0), &quot;ERC20: transfer to the zero address&quot;);</span>
 225 |     | <span class='neutral'></span>
 226 |     | <span class='neutral'>        _beforeTokenTransfer(from, to, amount);</span>
 227 |     | <span class='neutral'></span>
 228 |     | <span class='unexecuted'>        uint256 fromBalance = _balances[from];</span>
 229 |     | <span class='unexecuted'>        require(fromBalance &gt;= amount, &quot;ERC20: transfer amount exceeds balance&quot;);</span>
 230 |     | <span class='neutral'>        unchecked {</span>
 231 |     | <span class='unexecuted'>            _balances[from] = fromBalance - amount;</span>
 232 |     | <span class='neutral'>            // Overflow not possible: the sum of all balances is capped by totalSupply, and the sum is preserved by</span>
 233 |     | <span class='neutral'>            // decrementing then incrementing.</span>
 234 |     | <span class='unexecuted'>            _balances[to] += amount;</span>
 235 |     | <span class='neutral'>        }</span>
 236 |     | <span class='neutral'></span>
 237 |     | <span class='unexecuted'>        emit Transfer(from, to, amount);</span>
 238 |     | <span class='neutral'></span>
 239 |     | <span class='unexecuted'>        _afterTokenTransfer(from, to, amount);</span>
 240 |     | <span class='neutral'>    }</span>
 241 |     | <span class='neutral'></span>
 242 |     | <span class='neutral'>    /** @dev Creates `amount` tokens and assigns them to `account`, increasing</span>
 243 |     | <span class='neutral'>     * the total supply.</span>
 244 |     | <span class='neutral'>     *</span>
 245 |     | <span class='neutral'>     * Emits a {Transfer} event with `from` set to the zero address.</span>
 246 |     | <span class='neutral'>     *</span>
 247 |     | <span class='neutral'>     * Requirements:</span>
 248 |     | <span class='neutral'>     *</span>
 249 |     | <span class='neutral'>     * - `account` cannot be the zero address.</span>
 250 |     | <span class='neutral'>     */</span>
 251 |     | <span class='unexecuted'>    function _mint(address account, uint256 amount) internal virtual {</span>
 252 |     | <span class='unexecuted'>        require(account != address(0), &quot;ERC20: mint to the zero address&quot;);</span>
 253 |     | <span class='neutral'></span>
 254 |     | <span class='neutral'>        _beforeTokenTransfer(address(0), account, amount);</span>
 255 |     | <span class='neutral'></span>
 256 |     | <span class='unexecuted'>        _totalSupply += amount;</span>
 257 |     | <span class='neutral'>        unchecked {</span>
 258 |     | <span class='neutral'>            // Overflow not possible: balance + amount is at most totalSupply + amount, which is checked above.</span>
 259 |     | <span class='unexecuted'>            _balances[account] += amount;</span>
 260 |     | <span class='neutral'>        }</span>
 261 |     | <span class='unexecuted'>        emit Transfer(address(0), account, amount);</span>
 262 |     | <span class='neutral'></span>
 263 |     | <span class='neutral'>        _afterTokenTransfer(address(0), account, amount);</span>
 264 |     | <span class='neutral'>    }</span>
 265 |     | <span class='neutral'></span>
 266 |     | <span class='neutral'>    /**</span>
 267 |     | <span class='neutral'>     * @dev Destroys `amount` tokens from `account`, reducing the</span>
 268 |     | <span class='neutral'>     * total supply.</span>
 269 |     | <span class='neutral'>     *</span>
 270 |     | <span class='neutral'>     * Emits a {Transfer} event with `to` set to the zero address.</span>
 271 |     | <span class='neutral'>     *</span>
 272 |     | <span class='neutral'>     * Requirements:</span>
 273 |     | <span class='neutral'>     *</span>
 274 |     | <span class='neutral'>     * - `account` cannot be the zero address.</span>
 275 |     | <span class='neutral'>     * - `account` must have at least `amount` tokens.</span>
 276 |     | <span class='neutral'>     */</span>
 277 |     | <span class='unexecuted'>    function _burn(address account, uint256 amount) internal virtual {</span>
 278 |     | <span class='unexecuted'>        require(account != address(0), &quot;ERC20: burn from the zero address&quot;);</span>
 279 |     | <span class='neutral'></span>
 280 |     | <span class='neutral'>        _beforeTokenTransfer(account, address(0), amount);</span>
 281 |     | <span class='neutral'></span>
 282 |     | <span class='unexecuted'>        uint256 accountBalance = _balances[account];</span>
 283 |     | <span class='unexecuted'>        require(accountBalance &gt;= amount, &quot;ERC20: burn amount exceeds balance&quot;);</span>
 284 |     | <span class='neutral'>        unchecked {</span>
 285 |     | <span class='unexecuted'>            _balances[account] = accountBalance - amount;</span>
 286 |     | <span class='neutral'>            // Overflow not possible: amount &lt;= accountBalance &lt;= totalSupply.</span>
 287 |     | <span class='unexecuted'>            _totalSupply -= amount;</span>
 288 |     | <span class='neutral'>        }</span>
 289 |     | <span class='neutral'></span>
 290 |     | <span class='unexecuted'>        emit Transfer(account, address(0), amount);</span>
 291 |     | <span class='neutral'></span>
 292 |     | <span class='neutral'>        _afterTokenTransfer(account, address(0), amount);</span>
 293 |     | <span class='neutral'>    }</span>
 294 |     | <span class='neutral'></span>
 295 |     | <span class='neutral'>    /**</span>
 296 |     | <span class='neutral'>     * @dev Sets `amount` as the allowance of `spender` over the `owner` s tokens.</span>
 297 |     | <span class='neutral'>     *</span>
 298 |     | <span class='neutral'>     * This internal function is equivalent to `approve`, and can be used to</span>
 299 |     | <span class='neutral'>     * e.g. set automatic allowances for certain subsystems, etc.</span>
 300 |     | <span class='neutral'>     *</span>
 301 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 302 |     | <span class='neutral'>     *</span>
 303 |     | <span class='neutral'>     * Requirements:</span>
 304 |     | <span class='neutral'>     *</span>
 305 |     | <span class='neutral'>     * - `owner` cannot be the zero address.</span>
 306 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 307 |     | <span class='neutral'>     */</span>
 308 |     | <span class='unexecuted'>    function _approve(address owner, address spender, uint256 amount) internal virtual {</span>
 309 |     | <span class='unexecuted'>        require(owner != address(0), &quot;ERC20: approve from the zero address&quot;);</span>
 310 |     | <span class='unexecuted'>        require(spender != address(0), &quot;ERC20: approve to the zero address&quot;);</span>
 311 |     | <span class='neutral'></span>
 312 |     | <span class='unexecuted'>        _allowances[owner][spender] = amount;</span>
 313 |     | <span class='unexecuted'>        emit Approval(owner, spender, amount);</span>
 314 |     | <span class='neutral'>    }</span>
 315 |     | <span class='neutral'></span>
 316 |     | <span class='neutral'>    /**</span>
 317 |     | <span class='neutral'>     * @dev Updates `owner` s allowance for `spender` based on spent `amount`.</span>
 318 |     | <span class='neutral'>     *</span>
 319 |     | <span class='neutral'>     * Does not update the allowance amount in case of infinite allowance.</span>
 320 |     | <span class='neutral'>     * Revert if not enough allowance is available.</span>
 321 |     | <span class='neutral'>     *</span>
 322 |     | <span class='neutral'>     * Might emit an {Approval} event.</span>
 323 |     | <span class='neutral'>     */</span>
 324 |     | <span class='unexecuted'>    function _spendAllowance(address owner, address spender, uint256 amount) internal virtual {</span>
 325 |     | <span class='unexecuted'>        uint256 currentAllowance = allowance(owner, spender);</span>
 326 |     | <span class='unexecuted'>        if (currentAllowance != type(uint256).max) {</span>
 327 |     | <span class='unexecuted'>            require(currentAllowance &gt;= amount, &quot;ERC20: insufficient allowance&quot;);</span>
 328 |     | <span class='neutral'>            unchecked {</span>
 329 |     | <span class='unexecuted'>                _approve(owner, spender, currentAllowance - amount);</span>
 330 |     | <span class='neutral'>            }</span>
 331 |     | <span class='neutral'>        }</span>
 332 |     | <span class='neutral'>    }</span>
 333 |     | <span class='neutral'></span>
 334 |     | <span class='neutral'>    /**</span>
 335 |     | <span class='neutral'>     * @dev Hook that is called before any transfer of tokens. This includes</span>
 336 |     | <span class='neutral'>     * minting and burning.</span>
 337 |     | <span class='neutral'>     *</span>
 338 |     | <span class='neutral'>     * Calling conditions:</span>
 339 |     | <span class='neutral'>     *</span>
 340 |     | <span class='neutral'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 341 |     | <span class='neutral'>     * will be transferred to `to`.</span>
 342 |     | <span class='neutral'>     * - when `from` is zero, `amount` tokens will be minted for `to`.</span>
 343 |     | <span class='neutral'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens will be burned.</span>
 344 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 345 |     | <span class='neutral'>     *</span>
 346 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 347 |     | <span class='neutral'>     */</span>
 348 |     | <span class='unexecuted'>    function _beforeTokenTransfer(address from, address to, uint256 amount) internal virtual {}</span>
 349 |     | <span class='neutral'></span>
 350 |     | <span class='neutral'>    /**</span>
 351 |     | <span class='neutral'>     * @dev Hook that is called after any transfer of tokens. This includes</span>
 352 |     | <span class='neutral'>     * minting and burning.</span>
 353 |     | <span class='neutral'>     *</span>
 354 |     | <span class='neutral'>     * Calling conditions:</span>
 355 |     | <span class='neutral'>     *</span>
 356 |     | <span class='neutral'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 357 |     | <span class='neutral'>     * has been transferred to `to`.</span>
 358 |     | <span class='neutral'>     * - when `from` is zero, `amount` tokens have been minted for `to`.</span>
 359 |     | <span class='neutral'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens have been burned.</span>
 360 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 361 |     | <span class='neutral'>     *</span>
 362 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 363 |     | <span class='neutral'>     */</span>
 364 |     | <span class='neutral'>    function _afterTokenTransfer(address from, address to, uint256 amount) internal virtual {}</span>
 365 |     | <span class='neutral'>}</span>
 366 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/IERC20.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC20 standard as defined in the EIP.</span>
  8 |     | <span class='neutral'> */</span>
  9 |     | <span class='neutral'>interface IERC20 {</span>
 10 |     | <span class='neutral'>    /**</span>
 11 |     | <span class='neutral'>     * @dev Emitted when `value` tokens are moved from one account (`from`) to</span>
 12 |     | <span class='neutral'>     * another (`to`).</span>
 13 |     | <span class='neutral'>     *</span>
 14 |     | <span class='neutral'>     * Note that `value` may be zero.</span>
 15 |     | <span class='neutral'>     */</span>
 16 |     | <span class='neutral'>    event Transfer(address indexed from, address indexed to, uint256 value);</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='neutral'>    /**</span>
 19 |     | <span class='neutral'>     * @dev Emitted when the allowance of a `spender` for an `owner` is set by</span>
 20 |     | <span class='neutral'>     * a call to {approve}. `value` is the new allowance.</span>
 21 |     | <span class='neutral'>     */</span>
 22 |     | <span class='neutral'>    event Approval(address indexed owner, address indexed spender, uint256 value);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the amount of tokens in existence.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function totalSupply() external view returns (uint256);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    /**</span>
 30 |     | <span class='neutral'>     * @dev Returns the amount of tokens owned by `account`.</span>
 31 |     | <span class='neutral'>     */</span>
 32 |     | <span class='neutral'>    function balanceOf(address account) external view returns (uint256);</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    /**</span>
 35 |     | <span class='neutral'>     * @dev Moves `amount` tokens from the caller&#39;s account to `to`.</span>
 36 |     | <span class='neutral'>     *</span>
 37 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 38 |     | <span class='neutral'>     *</span>
 39 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 40 |     | <span class='neutral'>     */</span>
 41 |     | <span class='neutral'>    function transfer(address to, uint256 amount) external returns (bool);</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='neutral'>    /**</span>
 44 |     | <span class='neutral'>     * @dev Returns the remaining number of tokens that `spender` will be</span>
 45 |     | <span class='neutral'>     * allowed to spend on behalf of `owner` through {transferFrom}. This is</span>
 46 |     | <span class='neutral'>     * zero by default.</span>
 47 |     | <span class='neutral'>     *</span>
 48 |     | <span class='neutral'>     * This value changes when {approve} or {transferFrom} are called.</span>
 49 |     | <span class='neutral'>     */</span>
 50 |     | <span class='neutral'>    function allowance(address owner, address spender) external view returns (uint256);</span>
 51 |     | <span class='neutral'></span>
 52 |     | <span class='neutral'>    /**</span>
 53 |     | <span class='neutral'>     * @dev Sets `amount` as the allowance of `spender` over the caller&#39;s tokens.</span>
 54 |     | <span class='neutral'>     *</span>
 55 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 56 |     | <span class='neutral'>     *</span>
 57 |     | <span class='neutral'>     * IMPORTANT: Beware that changing an allowance with this method brings the risk</span>
 58 |     | <span class='neutral'>     * that someone may use both the old and the new allowance by unfortunate</span>
 59 |     | <span class='neutral'>     * transaction ordering. One possible solution to mitigate this race</span>
 60 |     | <span class='neutral'>     * condition is to first reduce the spender&#39;s allowance to 0 and set the</span>
 61 |     | <span class='neutral'>     * desired value afterwards:</span>
 62 |     | <span class='neutral'>     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729</span>
 63 |     | <span class='neutral'>     *</span>
 64 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 65 |     | <span class='neutral'>     */</span>
 66 |     | <span class='neutral'>    function approve(address spender, uint256 amount) external returns (bool);</span>
 67 |     | <span class='neutral'></span>
 68 |     | <span class='neutral'>    /**</span>
 69 |     | <span class='neutral'>     * @dev Moves `amount` tokens from `from` to `to` using the</span>
 70 |     | <span class='neutral'>     * allowance mechanism. `amount` is then deducted from the caller&#39;s</span>
 71 |     | <span class='neutral'>     * allowance.</span>
 72 |     | <span class='neutral'>     *</span>
 73 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 74 |     | <span class='neutral'>     *</span>
 75 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 76 |     | <span class='neutral'>     */</span>
 77 |     | <span class='neutral'>    function transferFrom(address from, address to, uint256 amount) external returns (bool);</span>
 78 |     | <span class='neutral'>}</span>
 79 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Burnable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.5.0) (token/ERC20/extensions/ERC20Burnable.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../ERC20.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;../../../utils/Context.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>/**</span>
 10 |     | <span class='neutral'> * @dev Extension of {ERC20} that allows token holders to destroy both their own</span>
 11 |     | <span class='neutral'> * tokens and those that they have an allowance for, in a way that can be</span>
 12 |     | <span class='neutral'> * recognized off-chain (via event analysis).</span>
 13 |     | <span class='neutral'> */</span>
 14 |     | <span class='neutral'>abstract contract ERC20Burnable is Context, ERC20 {</span>
 15 |     | <span class='neutral'>    /**</span>
 16 |     | <span class='neutral'>     * @dev Destroys `amount` tokens from the caller.</span>
 17 |     | <span class='neutral'>     *</span>
 18 |     | <span class='neutral'>     * See {ERC20-_burn}.</span>
 19 |     | <span class='neutral'>     */</span>
 20 |     | <span class='unexecuted'>    function burn(uint256 amount) public virtual {</span>
 21 |     | <span class='unexecuted'>        _burn(_msgSender(), amount);</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Destroys `amount` tokens from `account`, deducting from the caller&#39;s</span>
 26 |     | <span class='neutral'>     * allowance.</span>
 27 |     | <span class='neutral'>     *</span>
 28 |     | <span class='neutral'>     * See {ERC20-_burn} and {ERC20-allowance}.</span>
 29 |     | <span class='neutral'>     *</span>
 30 |     | <span class='neutral'>     * Requirements:</span>
 31 |     | <span class='neutral'>     *</span>
 32 |     | <span class='neutral'>     * - the caller must have allowance for ``accounts``&#39;s tokens of at least</span>
 33 |     | <span class='neutral'>     * `amount`.</span>
 34 |     | <span class='neutral'>     */</span>
 35 |     | <span class='unexecuted'>    function burnFrom(address account, uint256 amount) public virtual {</span>
 36 |     | <span class='unexecuted'>        _spendAllowance(account, _msgSender(), amount);</span>
 37 |     | <span class='unexecuted'>        _burn(account, amount);</span>
 38 |     | <span class='neutral'>    }</span>
 39 |     | <span class='neutral'>}</span>
 40 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Permit.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/extensions/ERC20Permit.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./IERC20Permit.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;../ERC20.sol&quot;;</span>
  8 |     | <span class='neutral'>import &quot;../../../utils/cryptography/ECDSA.sol&quot;;</span>
  9 |     | <span class='neutral'>import &quot;../../../utils/cryptography/EIP712.sol&quot;;</span>
 10 |     | <span class='neutral'>import &quot;../../../utils/Counters.sol&quot;;</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>/**</span>
 13 |     | <span class='neutral'> * @dev Implementation of the ERC20 Permit extension allowing approvals to be made via signatures, as defined in</span>
 14 |     | <span class='neutral'> * https://eips.ethereum.org/EIPS/eip-2612[EIP-2612].</span>
 15 |     | <span class='neutral'> *</span>
 16 |     | <span class='neutral'> * Adds the {permit} method, which can be used to change an account&#39;s ERC20 allowance (see {IERC20-allowance}) by</span>
 17 |     | <span class='neutral'> * presenting a message signed by the account. By not relying on `{IERC20-approve}`, the token holder account doesn&#39;t</span>
 18 |     | <span class='neutral'> * need to send a transaction, and thus is not required to hold Ether at all.</span>
 19 |     | <span class='neutral'> *</span>
 20 |     | <span class='neutral'> * _Available since v3.4._</span>
 21 |     | <span class='neutral'> */</span>
 22 |     | <span class='neutral'>abstract contract ERC20Permit is ERC20, IERC20Permit, EIP712 {</span>
 23 |     | <span class='neutral'>    using Counters for Counters.Counter;</span>
 24 |     | <span class='neutral'></span>
 25 |     | <span class='neutral'>    mapping(address =&gt; Counters.Counter) private _nonces;</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='neutral'>    // solhint-disable-next-line var-name-mixedcase</span>
 28 |     | <span class='neutral'>    bytes32 private constant _PERMIT_TYPEHASH =</span>
 29 |     | <span class='unexecuted'>        keccak256(&quot;Permit(address owner,address spender,uint256 value,uint256 nonce,uint256 deadline)&quot;);</span>
 30 |     | <span class='neutral'>    /**</span>
 31 |     | <span class='neutral'>     * @dev In previous versions `_PERMIT_TYPEHASH` was declared as `immutable`.</span>
 32 |     | <span class='neutral'>     * However, to ensure consistency with the upgradeable transpiler, we will continue</span>
 33 |     | <span class='neutral'>     * to reserve a slot.</span>
 34 |     | <span class='neutral'>     * @custom:oz-renamed-from _PERMIT_TYPEHASH</span>
 35 |     | <span class='neutral'>     */</span>
 36 |     | <span class='neutral'>    // solhint-disable-next-line var-name-mixedcase</span>
 37 |     | <span class='neutral'>    bytes32 private _PERMIT_TYPEHASH_DEPRECATED_SLOT;</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='neutral'>    /**</span>
 40 |     | <span class='neutral'>     * @dev Initializes the {EIP712} domain separator using the `name` parameter, and setting `version` to `&quot;1&quot;`.</span>
 41 |     | <span class='neutral'>     *</span>
 42 |     | <span class='neutral'>     * It&#39;s a good idea to use the same `name` that is defined as the ERC20 token name.</span>
 43 |     | <span class='neutral'>     */</span>
 44 |     | <span class='neutral'>    constructor(string memory name) EIP712(name, &quot;1&quot;) {}</span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'>    /**</span>
 47 |     | <span class='neutral'>     * @dev See {IERC20Permit-permit}.</span>
 48 |     | <span class='neutral'>     */</span>
 49 |     | <span class='unexecuted'>    function permit(</span>
 50 |     | <span class='neutral'>        address owner,</span>
 51 |     | <span class='neutral'>        address spender,</span>
 52 |     | <span class='neutral'>        uint256 value,</span>
 53 |     | <span class='neutral'>        uint256 deadline,</span>
 54 |     | <span class='neutral'>        uint8 v,</span>
 55 |     | <span class='neutral'>        bytes32 r,</span>
 56 |     | <span class='neutral'>        bytes32 s</span>
 57 |     | <span class='unexecuted'>    ) public virtual override {</span>
 58 |     | <span class='unexecuted'>        require(block.timestamp &lt;= deadline, &quot;ERC20Permit: expired deadline&quot;);</span>
 59 |     | <span class='neutral'></span>
 60 |     | <span class='unexecuted'>        bytes32 structHash = keccak256(abi.encode(_PERMIT_TYPEHASH, owner, spender, value, _useNonce(owner), deadline));</span>
 61 |     | <span class='neutral'></span>
 62 |     | <span class='unexecuted'>        bytes32 hash = _hashTypedDataV4(structHash);</span>
 63 |     | <span class='neutral'></span>
 64 |     | <span class='unexecuted'>        address signer = ECDSA.recover(hash, v, r, s);</span>
 65 |     | <span class='unexecuted'>        require(signer == owner, &quot;ERC20Permit: invalid signature&quot;);</span>
 66 |     | <span class='neutral'></span>
 67 |     | <span class='unexecuted'>        _approve(owner, spender, value);</span>
 68 |     | <span class='neutral'>    }</span>
 69 |     | <span class='neutral'></span>
 70 |     | <span class='neutral'>    /**</span>
 71 |     | <span class='neutral'>     * @dev See {IERC20Permit-nonces}.</span>
 72 |     | <span class='neutral'>     */</span>
 73 |     | <span class='unexecuted'>    function nonces(address owner) public view virtual override returns (uint256) {</span>
 74 |     | <span class='unexecuted'>        return _nonces[owner].current();</span>
 75 |     | <span class='neutral'>    }</span>
 76 |     | <span class='neutral'></span>
 77 |     | <span class='neutral'>    /**</span>
 78 |     | <span class='neutral'>     * @dev See {IERC20Permit-DOMAIN_SEPARATOR}.</span>
 79 |     | <span class='neutral'>     */</span>
 80 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
 81 |     | <span class='unexecuted'>    function DOMAIN_SEPARATOR() external view override returns (bytes32) {</span>
 82 |     | <span class='unexecuted'>        return _domainSeparatorV4();</span>
 83 |     | <span class='neutral'>    }</span>
 84 |     | <span class='neutral'></span>
 85 |     | <span class='neutral'>    /**</span>
 86 |     | <span class='neutral'>     * @dev &quot;Consume a nonce&quot;: return the current value and increment.</span>
 87 |     | <span class='neutral'>     *</span>
 88 |     | <span class='neutral'>     * _Available since v4.1._</span>
 89 |     | <span class='neutral'>     */</span>
 90 |     | <span class='unexecuted'>    function _useNonce(address owner) internal virtual returns (uint256 current) {</span>
 91 |     | <span class='unexecuted'>        Counters.Counter storage nonce = _nonces[owner];</span>
 92 |     | <span class='neutral'>        current = nonce.current();</span>
 93 |     | <span class='unexecuted'>        nonce.increment();</span>
 94 |     | <span class='neutral'>    }</span>
 95 |     | <span class='neutral'>}</span>
 96 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/IERC20Metadata.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (token/ERC20/extensions/IERC20Metadata.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../IERC20.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Interface for the optional metadata functions from the ERC20 standard.</span>
 10 |     | <span class='neutral'> *</span>
 11 |     | <span class='neutral'> * _Available since v4.1._</span>
 12 |     | <span class='neutral'> */</span>
 13 |     | <span class='neutral'>interface IERC20Metadata is IERC20 {</span>
 14 |     | <span class='neutral'>    /**</span>
 15 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
 16 |     | <span class='neutral'>     */</span>
 17 |     | <span class='neutral'>    function name() external view returns (string memory);</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    /**</span>
 20 |     | <span class='neutral'>     * @dev Returns the symbol of the token.</span>
 21 |     | <span class='neutral'>     */</span>
 22 |     | <span class='neutral'>    function symbol() external view returns (string memory);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the decimals places of the token.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function decimals() external view returns (uint8);</span>
 28 |     | <span class='neutral'>}</span>
 29 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/IERC20Permit.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/extensions/IERC20Permit.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC20 Permit extension allowing approvals to be made via signatures, as defined in</span>
  8 |     | <span class='neutral'> * https://eips.ethereum.org/EIPS/eip-2612[EIP-2612].</span>
  9 |     | <span class='neutral'> *</span>
 10 |     | <span class='neutral'> * Adds the {permit} method, which can be used to change an account&#39;s ERC20 allowance (see {IERC20-allowance}) by</span>
 11 |     | <span class='neutral'> * presenting a message signed by the account. By not relying on {IERC20-approve}, the token holder account doesn&#39;t</span>
 12 |     | <span class='neutral'> * need to send a transaction, and thus is not required to hold Ether at all.</span>
 13 |     | <span class='neutral'> */</span>
 14 |     | <span class='neutral'>interface IERC20Permit {</span>
 15 |     | <span class='neutral'>    /**</span>
 16 |     | <span class='neutral'>     * @dev Sets `value` as the allowance of `spender` over ``owner``&#39;s tokens,</span>
 17 |     | <span class='neutral'>     * given ``owner``&#39;s signed approval.</span>
 18 |     | <span class='neutral'>     *</span>
 19 |     | <span class='neutral'>     * IMPORTANT: The same issues {IERC20-approve} has related to transaction</span>
 20 |     | <span class='neutral'>     * ordering also apply here.</span>
 21 |     | <span class='neutral'>     *</span>
 22 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 23 |     | <span class='neutral'>     *</span>
 24 |     | <span class='neutral'>     * Requirements:</span>
 25 |     | <span class='neutral'>     *</span>
 26 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 27 |     | <span class='neutral'>     * - `deadline` must be a timestamp in the future.</span>
 28 |     | <span class='neutral'>     * - `v`, `r` and `s` must be a valid `secp256k1` signature from `owner`</span>
 29 |     | <span class='neutral'>     * over the EIP712-formatted function arguments.</span>
 30 |     | <span class='neutral'>     * - the signature must use ``owner``&#39;s current nonce (see {nonces}).</span>
 31 |     | <span class='neutral'>     *</span>
 32 |     | <span class='neutral'>     * For more information on the signature format, see the</span>
 33 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-2612#specification[relevant EIP</span>
 34 |     | <span class='neutral'>     * section].</span>
 35 |     | <span class='neutral'>     */</span>
 36 |     | <span class='neutral'>    function permit(</span>
 37 |     | <span class='neutral'>        address owner,</span>
 38 |     | <span class='neutral'>        address spender,</span>
 39 |     | <span class='neutral'>        uint256 value,</span>
 40 |     | <span class='neutral'>        uint256 deadline,</span>
 41 |     | <span class='neutral'>        uint8 v,</span>
 42 |     | <span class='neutral'>        bytes32 r,</span>
 43 |     | <span class='neutral'>        bytes32 s</span>
 44 |     | <span class='neutral'>    ) external;</span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'>    /**</span>
 47 |     | <span class='neutral'>     * @dev Returns the current nonce for `owner`. This value must be</span>
 48 |     | <span class='neutral'>     * included whenever a signature is generated for {permit}.</span>
 49 |     | <span class='neutral'>     *</span>
 50 |     | <span class='neutral'>     * Every successful call to {permit} increases ``owner``&#39;s nonce by one. This</span>
 51 |     | <span class='neutral'>     * prevents a signature from being used multiple times.</span>
 52 |     | <span class='neutral'>     */</span>
 53 |     | <span class='neutral'>    function nonces(address owner) external view returns (uint256);</span>
 54 |     | <span class='neutral'></span>
 55 |     | <span class='neutral'>    /**</span>
 56 |     | <span class='neutral'>     * @dev Returns the domain separator used in the encoding of the signature for {permit}, as defined by {EIP712}.</span>
 57 |     | <span class='neutral'>     */</span>
 58 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
 59 |     | <span class='neutral'>    function DOMAIN_SEPARATOR() external view returns (bytes32);</span>
 60 |     | <span class='neutral'>}</span>
 61 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/utils/SafeERC20.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../IERC20.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../extensions/IERC20Permit.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../../../utils/Address.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @title SafeERC20</span>
  12 |     | <span class='neutral'> * @dev Wrappers around ERC20 operations that throw on failure (when the token</span>
  13 |     | <span class='neutral'> * contract returns false). Tokens that return no value (and instead revert or</span>
  14 |     | <span class='neutral'> * throw on failure) are also supported, non-reverting calls are assumed to be</span>
  15 |     | <span class='neutral'> * successful.</span>
  16 |     | <span class='neutral'> * To use this library you can add a `using SafeERC20 for IERC20;` statement to your contract,</span>
  17 |     | <span class='neutral'> * which allows you to call the safe operations as `token.safeTransfer(...)`, etc.</span>
  18 |     | <span class='neutral'> */</span>
  19 |     | <span class='unexecuted'>library SafeERC20 {</span>
  20 |     | <span class='neutral'>    using Address for address;</span>
  21 |     | <span class='neutral'></span>
  22 |     | <span class='neutral'>    /**</span>
  23 |     | <span class='neutral'>     * @dev Transfer `value` amount of `token` from the calling contract to `to`. If `token` returns no value,</span>
  24 |     | <span class='neutral'>     * non-reverting calls are assumed to be successful.</span>
  25 |     | <span class='neutral'>     */</span>
  26 |     | <span class='unexecuted'>    function safeTransfer(IERC20 token, address to, uint256 value) internal {</span>
  27 |     | <span class='unexecuted'>        _callOptionalReturn(token, abi.encodeWithSelector(token.transfer.selector, to, value));</span>
  28 |     | <span class='neutral'>    }</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    /**</span>
  31 |     | <span class='neutral'>     * @dev Transfer `value` amount of `token` from `from` to `to`, spending the approval given by `from` to the</span>
  32 |     | <span class='neutral'>     * calling contract. If `token` returns no value, non-reverting calls are assumed to be successful.</span>
  33 |     | <span class='neutral'>     */</span>
  34 |     | <span class='unexecuted'>    function safeTransferFrom(IERC20 token, address from, address to, uint256 value) internal {</span>
  35 |     | <span class='unexecuted'>        _callOptionalReturn(token, abi.encodeWithSelector(token.transferFrom.selector, from, to, value));</span>
  36 |     | <span class='neutral'>    }</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    /**</span>
  39 |     | <span class='neutral'>     * @dev Deprecated. This function has issues similar to the ones found in</span>
  40 |     | <span class='neutral'>     * {IERC20-approve}, and its usage is discouraged.</span>
  41 |     | <span class='neutral'>     *</span>
  42 |     | <span class='neutral'>     * Whenever possible, use {safeIncreaseAllowance} and</span>
  43 |     | <span class='neutral'>     * {safeDecreaseAllowance} instead.</span>
  44 |     | <span class='neutral'>     */</span>
  45 |     | <span class='neutral'>    function safeApprove(IERC20 token, address spender, uint256 value) internal {</span>
  46 |     | <span class='neutral'>        // safeApprove should only be called when setting an initial allowance,</span>
  47 |     | <span class='neutral'>        // or when resetting it to zero. To increase and decrease it, use</span>
  48 |     | <span class='neutral'>        // &#39;safeIncreaseAllowance&#39; and &#39;safeDecreaseAllowance&#39;</span>
  49 |     | <span class='neutral'>        require(</span>
  50 |     | <span class='neutral'>            (value == 0) || (token.allowance(address(this), spender) == 0),</span>
  51 |     | <span class='neutral'>            &quot;SafeERC20: approve from non-zero to non-zero allowance&quot;</span>
  52 |     | <span class='neutral'>        );</span>
  53 |     | <span class='neutral'>        _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, value));</span>
  54 |     | <span class='neutral'>    }</span>
  55 |     | <span class='neutral'></span>
  56 |     | <span class='neutral'>    /**</span>
  57 |     | <span class='neutral'>     * @dev Increase the calling contract&#39;s allowance toward `spender` by `value`. If `token` returns no value,</span>
  58 |     | <span class='neutral'>     * non-reverting calls are assumed to be successful.</span>
  59 |     | <span class='neutral'>     */</span>
  60 |     | <span class='unexecuted'>    function safeIncreaseAllowance(IERC20 token, address spender, uint256 value) internal {</span>
  61 |     | <span class='unexecuted'>        uint256 oldAllowance = token.allowance(address(this), spender);</span>
  62 |     | <span class='unexecuted'>        _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, oldAllowance + value));</span>
  63 |     | <span class='neutral'>    }</span>
  64 |     | <span class='neutral'></span>
  65 |     | <span class='neutral'>    /**</span>
  66 |     | <span class='neutral'>     * @dev Decrease the calling contract&#39;s allowance toward `spender` by `value`. If `token` returns no value,</span>
  67 |     | <span class='neutral'>     * non-reverting calls are assumed to be successful.</span>
  68 |     | <span class='neutral'>     */</span>
  69 |     | <span class='neutral'>    function safeDecreaseAllowance(IERC20 token, address spender, uint256 value) internal {</span>
  70 |     | <span class='neutral'>        unchecked {</span>
  71 |     | <span class='neutral'>            uint256 oldAllowance = token.allowance(address(this), spender);</span>
  72 |     | <span class='neutral'>            require(oldAllowance &gt;= value, &quot;SafeERC20: decreased allowance below zero&quot;);</span>
  73 |     | <span class='neutral'>            _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, oldAllowance - value));</span>
  74 |     | <span class='neutral'>        }</span>
  75 |     | <span class='neutral'>    }</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>    /**</span>
  78 |     | <span class='neutral'>     * @dev Set the calling contract&#39;s allowance toward `spender` to `value`. If `token` returns no value,</span>
  79 |     | <span class='neutral'>     * non-reverting calls are assumed to be successful. Compatible with tokens that require the approval to be set to</span>
  80 |     | <span class='neutral'>     * 0 before setting it to a non-zero value.</span>
  81 |     | <span class='neutral'>     */</span>
  82 |     | <span class='neutral'>    function forceApprove(IERC20 token, address spender, uint256 value) internal {</span>
  83 |     | <span class='neutral'>        bytes memory approvalCall = abi.encodeWithSelector(token.approve.selector, spender, value);</span>
  84 |     | <span class='neutral'></span>
  85 |     | <span class='neutral'>        if (!_callOptionalReturnBool(token, approvalCall)) {</span>
  86 |     | <span class='neutral'>            _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, 0));</span>
  87 |     | <span class='neutral'>            _callOptionalReturn(token, approvalCall);</span>
  88 |     | <span class='neutral'>        }</span>
  89 |     | <span class='neutral'>    }</span>
  90 |     | <span class='neutral'></span>
  91 |     | <span class='neutral'>    /**</span>
  92 |     | <span class='neutral'>     * @dev Use a ERC-2612 signature to set the `owner` approval toward `spender` on `token`.</span>
  93 |     | <span class='neutral'>     * Revert on invalid signature.</span>
  94 |     | <span class='neutral'>     */</span>
  95 |     | <span class='neutral'>    function safePermit(</span>
  96 |     | <span class='neutral'>        IERC20Permit token,</span>
  97 |     | <span class='neutral'>        address owner,</span>
  98 |     | <span class='neutral'>        address spender,</span>
  99 |     | <span class='neutral'>        uint256 value,</span>
 100 |     | <span class='neutral'>        uint256 deadline,</span>
 101 |     | <span class='neutral'>        uint8 v,</span>
 102 |     | <span class='neutral'>        bytes32 r,</span>
 103 |     | <span class='neutral'>        bytes32 s</span>
 104 |     | <span class='neutral'>    ) internal {</span>
 105 |     | <span class='neutral'>        uint256 nonceBefore = token.nonces(owner);</span>
 106 |     | <span class='neutral'>        token.permit(owner, spender, value, deadline, v, r, s);</span>
 107 |     | <span class='neutral'>        uint256 nonceAfter = token.nonces(owner);</span>
 108 |     | <span class='neutral'>        require(nonceAfter == nonceBefore + 1, &quot;SafeERC20: permit did not succeed&quot;);</span>
 109 |     | <span class='neutral'>    }</span>
 110 |     | <span class='neutral'></span>
 111 |     | <span class='neutral'>    /**</span>
 112 |     | <span class='neutral'>     * @dev Imitates a Solidity high-level call (i.e. a regular function call to a contract), relaxing the requirement</span>
 113 |     | <span class='neutral'>     * on the return value: the return value is optional (but if data is returned, it must not be false).</span>
 114 |     | <span class='neutral'>     * @param token The token targeted by the call.</span>
 115 |     | <span class='neutral'>     * @param data The call data (encoded using abi.encode or one of its variants).</span>
 116 |     | <span class='neutral'>     */</span>
 117 |     | <span class='unexecuted'>    function _callOptionalReturn(IERC20 token, bytes memory data) private {</span>
 118 |     | <span class='neutral'>        // We need to perform a low level call here, to bypass Solidity&#39;s return data size checking mechanism, since</span>
 119 |     | <span class='neutral'>        // we&#39;re implementing it ourselves. We use {Address-functionCall} to perform this call, which verifies that</span>
 120 |     | <span class='neutral'>        // the target address contains contract code and also asserts for success in the low-level call.</span>
 121 |     | <span class='neutral'></span>
 122 |     | <span class='unexecuted'>        bytes memory returndata = address(token).functionCall(data, &quot;SafeERC20: low-level call failed&quot;);</span>
 123 |     | <span class='unexecuted'>        require(returndata.length == 0 || abi.decode(returndata, (bool)), &quot;SafeERC20: ERC20 operation did not succeed&quot;);</span>
 124 |     | <span class='neutral'>    }</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    /**</span>
 127 |     | <span class='neutral'>     * @dev Imitates a Solidity high-level call (i.e. a regular function call to a contract), relaxing the requirement</span>
 128 |     | <span class='neutral'>     * on the return value: the return value is optional (but if data is returned, it must not be false).</span>
 129 |     | <span class='neutral'>     * @param token The token targeted by the call.</span>
 130 |     | <span class='neutral'>     * @param data The call data (encoded using abi.encode or one of its variants).</span>
 131 |     | <span class='neutral'>     *</span>
 132 |     | <span class='neutral'>     * This is a variant of {_callOptionalReturn} that silents catches all reverts and returns a bool instead.</span>
 133 |     | <span class='neutral'>     */</span>
 134 |     | <span class='neutral'>    function _callOptionalReturnBool(IERC20 token, bytes memory data) private returns (bool) {</span>
 135 |     | <span class='neutral'>        // We need to perform a low level call here, to bypass Solidity&#39;s return data size checking mechanism, since</span>
 136 |     | <span class='neutral'>        // we&#39;re implementing it ourselves. We cannot use {Address-functionCall} here since this should return false</span>
 137 |     | <span class='neutral'>        // and not revert is the subcall reverts.</span>
 138 |     | <span class='neutral'></span>
 139 |     | <span class='neutral'>        (bool success, bytes memory returndata) = address(token).call(data);</span>
 140 |     | <span class='neutral'>        return</span>
 141 |     | <span class='neutral'>            success &amp;&amp; (returndata.length == 0 || abi.decode(returndata, (bool))) &amp;&amp; Address.isContract(address(token));</span>
 142 |     | <span class='neutral'>    }</span>
 143 |     | <span class='neutral'>}</span>
 144 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC721/ERC721.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC721/ERC721.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./IERC721.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;./IERC721Receiver.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;./extensions/IERC721Metadata.sol&quot;;</span>
   9 |     | <span class='neutral'>import &quot;../../utils/Address.sol&quot;;</span>
  10 |     | <span class='neutral'>import &quot;../../utils/Context.sol&quot;;</span>
  11 |     | <span class='neutral'>import &quot;../../utils/Strings.sol&quot;;</span>
  12 |     | <span class='neutral'>import &quot;../../utils/introspection/ERC165.sol&quot;;</span>
  13 |     | <span class='neutral'></span>
  14 |     | <span class='neutral'>/**</span>
  15 |     | <span class='neutral'> * @dev Implementation of https://eips.ethereum.org/EIPS/eip-721[ERC721] Non-Fungible Token Standard, including</span>
  16 |     | <span class='neutral'> * the Metadata extension, but not including the Enumerable extension, which is available separately as</span>
  17 |     | <span class='neutral'> * {ERC721Enumerable}.</span>
  18 |     | <span class='neutral'> */</span>
  19 |     | <span class='unexecuted'>contract ERC721 is Context, ERC165, IERC721, IERC721Metadata {</span>
  20 |     | <span class='neutral'>    using Address for address;</span>
  21 |     | <span class='neutral'>    using Strings for uint256;</span>
  22 |     | <span class='neutral'></span>
  23 |     | <span class='neutral'>    // Token name</span>
  24 |     | <span class='neutral'>    string private _name;</span>
  25 |     | <span class='neutral'></span>
  26 |     | <span class='neutral'>    // Token symbol</span>
  27 |     | <span class='neutral'>    string private _symbol;</span>
  28 |     | <span class='neutral'></span>
  29 |     | <span class='neutral'>    // Mapping from token ID to owner address</span>
  30 |     | <span class='neutral'>    mapping(uint256 =&gt; address) private _owners;</span>
  31 |     | <span class='neutral'></span>
  32 |     | <span class='neutral'>    // Mapping owner address to token count</span>
  33 |     | <span class='neutral'>    mapping(address =&gt; uint256) private _balances;</span>
  34 |     | <span class='neutral'></span>
  35 |     | <span class='neutral'>    // Mapping from token ID to approved address</span>
  36 |     | <span class='neutral'>    mapping(uint256 =&gt; address) private _tokenApprovals;</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    // Mapping from owner to operator approvals</span>
  39 |     | <span class='neutral'>    mapping(address =&gt; mapping(address =&gt; bool)) private _operatorApprovals;</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>    /**</span>
  42 |     | <span class='neutral'>     * @dev Initializes the contract by setting a `name` and a `symbol` to the token collection.</span>
  43 |     | <span class='neutral'>     */</span>
  44 |     | <span class='unexecuted'>    constructor(string memory name_, string memory symbol_) {</span>
  45 |     | <span class='unexecuted'>        _name = name_;</span>
  46 |     | <span class='unexecuted'>        _symbol = symbol_;</span>
  47 |     | <span class='neutral'>    }</span>
  48 |     | <span class='neutral'></span>
  49 |     | <span class='neutral'>    /**</span>
  50 |     | <span class='neutral'>     * @dev See {IERC165-supportsInterface}.</span>
  51 |     | <span class='neutral'>     */</span>
  52 |     | <span class='unexecuted'>    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {</span>
  53 |     | <span class='unexecuted'>        return</span>
  54 |     | <span class='unexecuted'>            interfaceId == type(IERC721).interfaceId ||</span>
  55 |     | <span class='unexecuted'>            interfaceId == type(IERC721Metadata).interfaceId ||</span>
  56 |     | <span class='unexecuted'>            super.supportsInterface(interfaceId);</span>
  57 |     | <span class='neutral'>    }</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    /**</span>
  60 |     | <span class='neutral'>     * @dev See {IERC721-balanceOf}.</span>
  61 |     | <span class='neutral'>     */</span>
  62 |     | <span class='unexecuted'>    function balanceOf(address owner) public view virtual override returns (uint256) {</span>
  63 |     | <span class='unexecuted'>        require(owner != address(0), &quot;ERC721: address zero is not a valid owner&quot;);</span>
  64 |     | <span class='unexecuted'>        return _balances[owner];</span>
  65 |     | <span class='neutral'>    }</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='neutral'>    /**</span>
  68 |     | <span class='neutral'>     * @dev See {IERC721-ownerOf}.</span>
  69 |     | <span class='neutral'>     */</span>
  70 |     | <span class='unexecuted'>    function ownerOf(uint256 tokenId) public view virtual override returns (address) {</span>
  71 |     | <span class='neutral'>        address owner = _ownerOf(tokenId);</span>
  72 |     | <span class='unexecuted'>        require(owner != address(0), &quot;ERC721: invalid token ID&quot;);</span>
  73 |     | <span class='neutral'>        return owner;</span>
  74 |     | <span class='neutral'>    }</span>
  75 |     | <span class='neutral'></span>
  76 |     | <span class='neutral'>    /**</span>
  77 |     | <span class='neutral'>     * @dev See {IERC721Metadata-name}.</span>
  78 |     | <span class='neutral'>     */</span>
  79 |     | <span class='unexecuted'>    function name() public view virtual override returns (string memory) {</span>
  80 |     | <span class='unexecuted'>        return _name;</span>
  81 |     | <span class='neutral'>    }</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    /**</span>
  84 |     | <span class='neutral'>     * @dev See {IERC721Metadata-symbol}.</span>
  85 |     | <span class='neutral'>     */</span>
  86 |     | <span class='unexecuted'>    function symbol() public view virtual override returns (string memory) {</span>
  87 |     | <span class='unexecuted'>        return _symbol;</span>
  88 |     | <span class='neutral'>    }</span>
  89 |     | <span class='neutral'></span>
  90 |     | <span class='neutral'>    /**</span>
  91 |     | <span class='neutral'>     * @dev See {IERC721Metadata-tokenURI}.</span>
  92 |     | <span class='neutral'>     */</span>
  93 |     | <span class='unexecuted'>    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {</span>
  94 |     | <span class='unexecuted'>        _requireMinted(tokenId);</span>
  95 |     | <span class='neutral'></span>
  96 |     | <span class='unexecuted'>        string memory baseURI = _baseURI();</span>
  97 |     | <span class='unexecuted'>        return bytes(baseURI).length &gt; 0 ? string(abi.encodePacked(baseURI, tokenId.toString())) : &quot;&quot;;</span>
  98 |     | <span class='neutral'>    }</span>
  99 |     | <span class='neutral'></span>
 100 |     | <span class='neutral'>    /**</span>
 101 |     | <span class='neutral'>     * @dev Base URI for computing {tokenURI}. If set, the resulting URI for each</span>
 102 |     | <span class='neutral'>     * token will be the concatenation of the `baseURI` and the `tokenId`. Empty</span>
 103 |     | <span class='neutral'>     * by default, can be overridden in child contracts.</span>
 104 |     | <span class='neutral'>     */</span>
 105 |     | <span class='unexecuted'>    function _baseURI() internal view virtual returns (string memory) {</span>
 106 |     | <span class='unexecuted'>        return &quot;&quot;;</span>
 107 |     | <span class='neutral'>    }</span>
 108 |     | <span class='neutral'></span>
 109 |     | <span class='neutral'>    /**</span>
 110 |     | <span class='neutral'>     * @dev See {IERC721-approve}.</span>
 111 |     | <span class='neutral'>     */</span>
 112 |     | <span class='unexecuted'>    function approve(address to, uint256 tokenId) public virtual override {</span>
 113 |     | <span class='unexecuted'>        address owner = ERC721.ownerOf(tokenId);</span>
 114 |     | <span class='unexecuted'>        require(to != owner, &quot;ERC721: approval to current owner&quot;);</span>
 115 |     | <span class='neutral'></span>
 116 |     | <span class='unexecuted'>        require(</span>
 117 |     | <span class='unexecuted'>            _msgSender() == owner || isApprovedForAll(owner, _msgSender()),</span>
 118 |     | <span class='neutral'>            &quot;ERC721: approve caller is not token owner or approved for all&quot;</span>
 119 |     | <span class='neutral'>        );</span>
 120 |     | <span class='neutral'></span>
 121 |     | <span class='unexecuted'>        _approve(to, tokenId);</span>
 122 |     | <span class='neutral'>    }</span>
 123 |     | <span class='neutral'></span>
 124 |     | <span class='neutral'>    /**</span>
 125 |     | <span class='neutral'>     * @dev See {IERC721-getApproved}.</span>
 126 |     | <span class='neutral'>     */</span>
 127 |     | <span class='unexecuted'>    function getApproved(uint256 tokenId) public view virtual override returns (address) {</span>
 128 |     | <span class='unexecuted'>        _requireMinted(tokenId);</span>
 129 |     | <span class='neutral'></span>
 130 |     | <span class='unexecuted'>        return _tokenApprovals[tokenId];</span>
 131 |     | <span class='neutral'>    }</span>
 132 |     | <span class='neutral'></span>
 133 |     | <span class='neutral'>    /**</span>
 134 |     | <span class='neutral'>     * @dev See {IERC721-setApprovalForAll}.</span>
 135 |     | <span class='neutral'>     */</span>
 136 |     | <span class='unexecuted'>    function setApprovalForAll(address operator, bool approved) public virtual override {</span>
 137 |     | <span class='unexecuted'>        _setApprovalForAll(_msgSender(), operator, approved);</span>
 138 |     | <span class='neutral'>    }</span>
 139 |     | <span class='neutral'></span>
 140 |     | <span class='neutral'>    /**</span>
 141 |     | <span class='neutral'>     * @dev See {IERC721-isApprovedForAll}.</span>
 142 |     | <span class='neutral'>     */</span>
 143 |     | <span class='unexecuted'>    function isApprovedForAll(address owner, address operator) public view virtual override returns (bool) {</span>
 144 |     | <span class='unexecuted'>        return _operatorApprovals[owner][operator];</span>
 145 |     | <span class='neutral'>    }</span>
 146 |     | <span class='neutral'></span>
 147 |     | <span class='neutral'>    /**</span>
 148 |     | <span class='neutral'>     * @dev See {IERC721-transferFrom}.</span>
 149 |     | <span class='neutral'>     */</span>
 150 |     | <span class='unexecuted'>    function transferFrom(address from, address to, uint256 tokenId) public virtual override {</span>
 151 |     | <span class='neutral'>        //solhint-disable-next-line max-line-length</span>
 152 |     | <span class='unexecuted'>        require(_isApprovedOrOwner(_msgSender(), tokenId), &quot;ERC721: caller is not token owner or approved&quot;);</span>
 153 |     | <span class='neutral'></span>
 154 |     | <span class='unexecuted'>        _transfer(from, to, tokenId);</span>
 155 |     | <span class='neutral'>    }</span>
 156 |     | <span class='neutral'></span>
 157 |     | <span class='neutral'>    /**</span>
 158 |     | <span class='neutral'>     * @dev See {IERC721-safeTransferFrom}.</span>
 159 |     | <span class='neutral'>     */</span>
 160 |     | <span class='unexecuted'>    function safeTransferFrom(address from, address to, uint256 tokenId) public virtual override {</span>
 161 |     | <span class='unexecuted'>        safeTransferFrom(from, to, tokenId, &quot;&quot;);</span>
 162 |     | <span class='neutral'>    }</span>
 163 |     | <span class='neutral'></span>
 164 |     | <span class='neutral'>    /**</span>
 165 |     | <span class='neutral'>     * @dev See {IERC721-safeTransferFrom}.</span>
 166 |     | <span class='neutral'>     */</span>
 167 |     | <span class='unexecuted'>    function safeTransferFrom(address from, address to, uint256 tokenId, bytes memory data) public virtual override {</span>
 168 |     | <span class='unexecuted'>        require(_isApprovedOrOwner(_msgSender(), tokenId), &quot;ERC721: caller is not token owner or approved&quot;);</span>
 169 |     | <span class='unexecuted'>        _safeTransfer(from, to, tokenId, data);</span>
 170 |     | <span class='neutral'>    }</span>
 171 |     | <span class='neutral'></span>
 172 |     | <span class='neutral'>    /**</span>
 173 |     | <span class='neutral'>     * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients</span>
 174 |     | <span class='neutral'>     * are aware of the ERC721 protocol to prevent tokens from being forever locked.</span>
 175 |     | <span class='neutral'>     *</span>
 176 |     | <span class='neutral'>     * `data` is additional data, it has no specified format and it is sent in call to `to`.</span>
 177 |     | <span class='neutral'>     *</span>
 178 |     | <span class='neutral'>     * This internal function is equivalent to {safeTransferFrom}, and can be used to e.g.</span>
 179 |     | <span class='neutral'>     * implement alternative mechanisms to perform token transfer, such as signature-based.</span>
 180 |     | <span class='neutral'>     *</span>
 181 |     | <span class='neutral'>     * Requirements:</span>
 182 |     | <span class='neutral'>     *</span>
 183 |     | <span class='neutral'>     * - `from` cannot be the zero address.</span>
 184 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 185 |     | <span class='neutral'>     * - `tokenId` token must exist and be owned by `from`.</span>
 186 |     | <span class='neutral'>     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.</span>
 187 |     | <span class='neutral'>     *</span>
 188 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 189 |     | <span class='neutral'>     */</span>
 190 |     | <span class='unexecuted'>    function _safeTransfer(address from, address to, uint256 tokenId, bytes memory data) internal virtual {</span>
 191 |     | <span class='unexecuted'>        _transfer(from, to, tokenId);</span>
 192 |     | <span class='unexecuted'>        require(_checkOnERC721Received(from, to, tokenId, data), &quot;ERC721: transfer to non ERC721Receiver implementer&quot;);</span>
 193 |     | <span class='neutral'>    }</span>
 194 |     | <span class='neutral'></span>
 195 |     | <span class='neutral'>    /**</span>
 196 |     | <span class='neutral'>     * @dev Returns the owner of the `tokenId`. Does NOT revert if token doesn&#39;t exist</span>
 197 |     | <span class='neutral'>     */</span>
 198 |     | <span class='unexecuted'>    function _ownerOf(uint256 tokenId) internal view virtual returns (address) {</span>
 199 |     | <span class='unexecuted'>        return _owners[tokenId];</span>
 200 |     | <span class='neutral'>    }</span>
 201 |     | <span class='neutral'></span>
 202 |     | <span class='neutral'>    /**</span>
 203 |     | <span class='neutral'>     * @dev Returns whether `tokenId` exists.</span>
 204 |     | <span class='neutral'>     *</span>
 205 |     | <span class='neutral'>     * Tokens can be managed by their owner or approved accounts via {approve} or {setApprovalForAll}.</span>
 206 |     | <span class='neutral'>     *</span>
 207 |     | <span class='neutral'>     * Tokens start existing when they are minted (`_mint`),</span>
 208 |     | <span class='neutral'>     * and stop existing when they are burned (`_burn`).</span>
 209 |     | <span class='neutral'>     */</span>
 210 |     | <span class='unexecuted'>    function _exists(uint256 tokenId) internal view virtual returns (bool) {</span>
 211 |     | <span class='unexecuted'>        return _ownerOf(tokenId) != address(0);</span>
 212 |     | <span class='neutral'>    }</span>
 213 |     | <span class='neutral'></span>
 214 |     | <span class='neutral'>    /**</span>
 215 |     | <span class='neutral'>     * @dev Returns whether `spender` is allowed to manage `tokenId`.</span>
 216 |     | <span class='neutral'>     *</span>
 217 |     | <span class='neutral'>     * Requirements:</span>
 218 |     | <span class='neutral'>     *</span>
 219 |     | <span class='neutral'>     * - `tokenId` must exist.</span>
 220 |     | <span class='neutral'>     */</span>
 221 |     | <span class='unexecuted'>    function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {</span>
 222 |     | <span class='unexecuted'>        address owner = ERC721.ownerOf(tokenId);</span>
 223 |     | <span class='unexecuted'>        return (spender == owner || isApprovedForAll(owner, spender) || getApproved(tokenId) == spender);</span>
 224 |     | <span class='neutral'>    }</span>
 225 |     | <span class='neutral'></span>
 226 |     | <span class='neutral'>    /**</span>
 227 |     | <span class='neutral'>     * @dev Safely mints `tokenId` and transfers it to `to`.</span>
 228 |     | <span class='neutral'>     *</span>
 229 |     | <span class='neutral'>     * Requirements:</span>
 230 |     | <span class='neutral'>     *</span>
 231 |     | <span class='neutral'>     * - `tokenId` must not exist.</span>
 232 |     | <span class='neutral'>     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.</span>
 233 |     | <span class='neutral'>     *</span>
 234 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 235 |     | <span class='neutral'>     */</span>
 236 |     | <span class='unexecuted'>    function _safeMint(address to, uint256 tokenId) internal virtual {</span>
 237 |     | <span class='unexecuted'>        _safeMint(to, tokenId, &quot;&quot;);</span>
 238 |     | <span class='neutral'>    }</span>
 239 |     | <span class='neutral'></span>
 240 |     | <span class='neutral'>    /**</span>
 241 |     | <span class='neutral'>     * @dev Same as {xref-ERC721-_safeMint-address-uint256-}[`_safeMint`], with an additional `data` parameter which is</span>
 242 |     | <span class='neutral'>     * forwarded in {IERC721Receiver-onERC721Received} to contract recipients.</span>
 243 |     | <span class='neutral'>     */</span>
 244 |     | <span class='unexecuted'>    function _safeMint(address to, uint256 tokenId, bytes memory data) internal virtual {</span>
 245 |     | <span class='unexecuted'>        _mint(to, tokenId);</span>
 246 |     | <span class='unexecuted'>        require(</span>
 247 |     | <span class='unexecuted'>            _checkOnERC721Received(address(0), to, tokenId, data),</span>
 248 |     | <span class='neutral'>            &quot;ERC721: transfer to non ERC721Receiver implementer&quot;</span>
 249 |     | <span class='neutral'>        );</span>
 250 |     | <span class='neutral'>    }</span>
 251 |     | <span class='neutral'></span>
 252 |     | <span class='neutral'>    /**</span>
 253 |     | <span class='neutral'>     * @dev Mints `tokenId` and transfers it to `to`.</span>
 254 |     | <span class='neutral'>     *</span>
 255 |     | <span class='neutral'>     * WARNING: Usage of this method is discouraged, use {_safeMint} whenever possible</span>
 256 |     | <span class='neutral'>     *</span>
 257 |     | <span class='neutral'>     * Requirements:</span>
 258 |     | <span class='neutral'>     *</span>
 259 |     | <span class='neutral'>     * - `tokenId` must not exist.</span>
 260 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 261 |     | <span class='neutral'>     *</span>
 262 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 263 |     | <span class='neutral'>     */</span>
 264 |     | <span class='unexecuted'>    function _mint(address to, uint256 tokenId) internal virtual {</span>
 265 |     | <span class='unexecuted'>        require(to != address(0), &quot;ERC721: mint to the zero address&quot;);</span>
 266 |     | <span class='unexecuted'>        require(!_exists(tokenId), &quot;ERC721: token already minted&quot;);</span>
 267 |     | <span class='neutral'></span>
 268 |     | <span class='neutral'>        _beforeTokenTransfer(address(0), to, tokenId, 1);</span>
 269 |     | <span class='neutral'></span>
 270 |     | <span class='neutral'>        // Check that tokenId was not minted by `_beforeTokenTransfer` hook</span>
 271 |     | <span class='unexecuted'>        require(!_exists(tokenId), &quot;ERC721: token already minted&quot;);</span>
 272 |     | <span class='neutral'></span>
 273 |     | <span class='neutral'>        unchecked {</span>
 274 |     | <span class='neutral'>            // Will not overflow unless all 2**256 token ids are minted to the same owner.</span>
 275 |     | <span class='neutral'>            // Given that tokens are minted one by one, it is impossible in practice that</span>
 276 |     | <span class='neutral'>            // this ever happens. Might change if we allow batch minting.</span>
 277 |     | <span class='neutral'>            // The ERC fails to describe this case.</span>
 278 |     | <span class='unexecuted'>            _balances[to] += 1;</span>
 279 |     | <span class='neutral'>        }</span>
 280 |     | <span class='neutral'></span>
 281 |     | <span class='unexecuted'>        _owners[tokenId] = to;</span>
 282 |     | <span class='neutral'></span>
 283 |     | <span class='unexecuted'>        emit Transfer(address(0), to, tokenId);</span>
 284 |     | <span class='neutral'></span>
 285 |     | <span class='neutral'>        _afterTokenTransfer(address(0), to, tokenId, 1);</span>
 286 |     | <span class='neutral'>    }</span>
 287 |     | <span class='neutral'></span>
 288 |     | <span class='neutral'>    /**</span>
 289 |     | <span class='neutral'>     * @dev Destroys `tokenId`.</span>
 290 |     | <span class='neutral'>     * The approval is cleared when the token is burned.</span>
 291 |     | <span class='neutral'>     * This is an internal function that does not check if the sender is authorized to operate on the token.</span>
 292 |     | <span class='neutral'>     *</span>
 293 |     | <span class='neutral'>     * Requirements:</span>
 294 |     | <span class='neutral'>     *</span>
 295 |     | <span class='neutral'>     * - `tokenId` must exist.</span>
 296 |     | <span class='neutral'>     *</span>
 297 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 298 |     | <span class='neutral'>     */</span>
 299 |     | <span class='unexecuted'>    function _burn(uint256 tokenId) internal virtual {</span>
 300 |     | <span class='unexecuted'>        address owner = ERC721.ownerOf(tokenId);</span>
 301 |     | <span class='neutral'></span>
 302 |     | <span class='neutral'>        _beforeTokenTransfer(owner, address(0), tokenId, 1);</span>
 303 |     | <span class='neutral'></span>
 304 |     | <span class='neutral'>        // Update ownership in case tokenId was transferred by `_beforeTokenTransfer` hook</span>
 305 |     | <span class='unexecuted'>        owner = ERC721.ownerOf(tokenId);</span>
 306 |     | <span class='neutral'></span>
 307 |     | <span class='neutral'>        // Clear approvals</span>
 308 |     | <span class='unexecuted'>        delete _tokenApprovals[tokenId];</span>
 309 |     | <span class='neutral'></span>
 310 |     | <span class='neutral'>        unchecked {</span>
 311 |     | <span class='neutral'>            // Cannot overflow, as that would require more tokens to be burned/transferred</span>
 312 |     | <span class='neutral'>            // out than the owner initially received through minting and transferring in.</span>
 313 |     | <span class='unexecuted'>            _balances[owner] -= 1;</span>
 314 |     | <span class='neutral'>        }</span>
 315 |     | <span class='unexecuted'>        delete _owners[tokenId];</span>
 316 |     | <span class='neutral'></span>
 317 |     | <span class='unexecuted'>        emit Transfer(owner, address(0), tokenId);</span>
 318 |     | <span class='neutral'></span>
 319 |     | <span class='neutral'>        _afterTokenTransfer(owner, address(0), tokenId, 1);</span>
 320 |     | <span class='neutral'>    }</span>
 321 |     | <span class='neutral'></span>
 322 |     | <span class='neutral'>    /**</span>
 323 |     | <span class='neutral'>     * @dev Transfers `tokenId` from `from` to `to`.</span>
 324 |     | <span class='neutral'>     *  As opposed to {transferFrom}, this imposes no restrictions on msg.sender.</span>
 325 |     | <span class='neutral'>     *</span>
 326 |     | <span class='neutral'>     * Requirements:</span>
 327 |     | <span class='neutral'>     *</span>
 328 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 329 |     | <span class='neutral'>     * - `tokenId` token must be owned by `from`.</span>
 330 |     | <span class='neutral'>     *</span>
 331 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 332 |     | <span class='neutral'>     */</span>
 333 |     | <span class='unexecuted'>    function _transfer(address from, address to, uint256 tokenId) internal virtual {</span>
 334 |     | <span class='unexecuted'>        require(ERC721.ownerOf(tokenId) == from, &quot;ERC721: transfer from incorrect owner&quot;);</span>
 335 |     | <span class='unexecuted'>        require(to != address(0), &quot;ERC721: transfer to the zero address&quot;);</span>
 336 |     | <span class='neutral'></span>
 337 |     | <span class='neutral'>        _beforeTokenTransfer(from, to, tokenId, 1);</span>
 338 |     | <span class='neutral'></span>
 339 |     | <span class='neutral'>        // Check that tokenId was not transferred by `_beforeTokenTransfer` hook</span>
 340 |     | <span class='unexecuted'>        require(ERC721.ownerOf(tokenId) == from, &quot;ERC721: transfer from incorrect owner&quot;);</span>
 341 |     | <span class='neutral'></span>
 342 |     | <span class='neutral'>        // Clear approvals from the previous owner</span>
 343 |     | <span class='unexecuted'>        delete _tokenApprovals[tokenId];</span>
 344 |     | <span class='neutral'></span>
 345 |     | <span class='neutral'>        unchecked {</span>
 346 |     | <span class='neutral'>            // `_balances[from]` cannot overflow for the same reason as described in `_burn`:</span>
 347 |     | <span class='neutral'>            // `from`&#39;s balance is the number of token held, which is at least one before the current</span>
 348 |     | <span class='neutral'>            // transfer.</span>
 349 |     | <span class='neutral'>            // `_balances[to]` could overflow in the conditions described in `_mint`. That would require</span>
 350 |     | <span class='neutral'>            // all 2**256 token ids to be minted, which in practice is impossible.</span>
 351 |     | <span class='unexecuted'>            _balances[from] -= 1;</span>
 352 |     | <span class='unexecuted'>            _balances[to] += 1;</span>
 353 |     | <span class='neutral'>        }</span>
 354 |     | <span class='unexecuted'>        _owners[tokenId] = to;</span>
 355 |     | <span class='neutral'></span>
 356 |     | <span class='unexecuted'>        emit Transfer(from, to, tokenId);</span>
 357 |     | <span class='neutral'></span>
 358 |     | <span class='neutral'>        _afterTokenTransfer(from, to, tokenId, 1);</span>
 359 |     | <span class='neutral'>    }</span>
 360 |     | <span class='neutral'></span>
 361 |     | <span class='neutral'>    /**</span>
 362 |     | <span class='neutral'>     * @dev Approve `to` to operate on `tokenId`</span>
 363 |     | <span class='neutral'>     *</span>
 364 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 365 |     | <span class='neutral'>     */</span>
 366 |     | <span class='unexecuted'>    function _approve(address to, uint256 tokenId) internal virtual {</span>
 367 |     | <span class='unexecuted'>        _tokenApprovals[tokenId] = to;</span>
 368 |     | <span class='unexecuted'>        emit Approval(ERC721.ownerOf(tokenId), to, tokenId);</span>
 369 |     | <span class='neutral'>    }</span>
 370 |     | <span class='neutral'></span>
 371 |     | <span class='neutral'>    /**</span>
 372 |     | <span class='neutral'>     * @dev Approve `operator` to operate on all of `owner` tokens</span>
 373 |     | <span class='neutral'>     *</span>
 374 |     | <span class='neutral'>     * Emits an {ApprovalForAll} event.</span>
 375 |     | <span class='neutral'>     */</span>
 376 |     | <span class='unexecuted'>    function _setApprovalForAll(address owner, address operator, bool approved) internal virtual {</span>
 377 |     | <span class='unexecuted'>        require(owner != operator, &quot;ERC721: approve to caller&quot;);</span>
 378 |     | <span class='unexecuted'>        _operatorApprovals[owner][operator] = approved;</span>
 379 |     | <span class='unexecuted'>        emit ApprovalForAll(owner, operator, approved);</span>
 380 |     | <span class='neutral'>    }</span>
 381 |     | <span class='neutral'></span>
 382 |     | <span class='neutral'>    /**</span>
 383 |     | <span class='neutral'>     * @dev Reverts if the `tokenId` has not been minted yet.</span>
 384 |     | <span class='neutral'>     */</span>
 385 |     | <span class='unexecuted'>    function _requireMinted(uint256 tokenId) internal view virtual {</span>
 386 |     | <span class='unexecuted'>        require(_exists(tokenId), &quot;ERC721: invalid token ID&quot;);</span>
 387 |     | <span class='neutral'>    }</span>
 388 |     | <span class='neutral'></span>
 389 |     | <span class='neutral'>    /**</span>
 390 |     | <span class='neutral'>     * @dev Internal function to invoke {IERC721Receiver-onERC721Received} on a target address.</span>
 391 |     | <span class='neutral'>     * The call is not executed if the target address is not a contract.</span>
 392 |     | <span class='neutral'>     *</span>
 393 |     | <span class='neutral'>     * @param from address representing the previous owner of the given token ID</span>
 394 |     | <span class='neutral'>     * @param to target address that will receive the tokens</span>
 395 |     | <span class='neutral'>     * @param tokenId uint256 ID of the token to be transferred</span>
 396 |     | <span class='neutral'>     * @param data bytes optional data to send along with the call</span>
 397 |     | <span class='neutral'>     * @return bool whether the call correctly returned the expected magic value</span>
 398 |     | <span class='neutral'>     */</span>
 399 |     | <span class='unexecuted'>    function _checkOnERC721Received(</span>
 400 |     | <span class='neutral'>        address from,</span>
 401 |     | <span class='neutral'>        address to,</span>
 402 |     | <span class='neutral'>        uint256 tokenId,</span>
 403 |     | <span class='neutral'>        bytes memory data</span>
 404 |     | <span class='unexecuted'>    ) private returns (bool) {</span>
 405 |     | <span class='unexecuted'>        if (to.isContract()) {</span>
 406 |     | <span class='unexecuted'>            try IERC721Receiver(to).onERC721Received(_msgSender(), from, tokenId, data) returns (bytes4 retval) {</span>
 407 |     | <span class='unexecuted'>                return retval == IERC721Receiver.onERC721Received.selector;</span>
 408 |     | <span class='neutral'>            } catch (bytes memory reason) {</span>
 409 |     | <span class='unexecuted'>                if (reason.length == 0) {</span>
 410 |     | <span class='unexecuted'>                    revert(&quot;ERC721: transfer to non ERC721Receiver implementer&quot;);</span>
 411 |     | <span class='neutral'>                } else {</span>
 412 |     | <span class='neutral'>                    /// @solidity memory-safe-assembly</span>
 413 |     | <span class='neutral'>                    assembly {</span>
 414 |     | <span class='unexecuted'>                        revert(add(32, reason), mload(reason))</span>
 415 |     | <span class='neutral'>                    }</span>
 416 |     | <span class='neutral'>                }</span>
 417 |     | <span class='neutral'>            }</span>
 418 |     | <span class='neutral'>        } else {</span>
 419 |     | <span class='unexecuted'>            return true;</span>
 420 |     | <span class='neutral'>        }</span>
 421 |     | <span class='neutral'>    }</span>
 422 |     | <span class='neutral'></span>
 423 |     | <span class='neutral'>    /**</span>
 424 |     | <span class='neutral'>     * @dev Hook that is called before any token transfer. This includes minting and burning. If {ERC721Consecutive} is</span>
 425 |     | <span class='neutral'>     * used, the hook may be called as part of a consecutive (batch) mint, as indicated by `batchSize` greater than 1.</span>
 426 |     | <span class='neutral'>     *</span>
 427 |     | <span class='neutral'>     * Calling conditions:</span>
 428 |     | <span class='neutral'>     *</span>
 429 |     | <span class='neutral'>     * - When `from` and `to` are both non-zero, ``from``&#39;s tokens will be transferred to `to`.</span>
 430 |     | <span class='neutral'>     * - When `from` is zero, the tokens will be minted for `to`.</span>
 431 |     | <span class='neutral'>     * - When `to` is zero, ``from``&#39;s tokens will be burned.</span>
 432 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 433 |     | <span class='neutral'>     * - `batchSize` is non-zero.</span>
 434 |     | <span class='neutral'>     *</span>
 435 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 436 |     | <span class='neutral'>     */</span>
 437 |     | <span class='neutral'>    function _beforeTokenTransfer(address from, address to, uint256 firstTokenId, uint256 batchSize) internal virtual {}</span>
 438 |     | <span class='neutral'></span>
 439 |     | <span class='neutral'>    /**</span>
 440 |     | <span class='neutral'>     * @dev Hook that is called after any token transfer. This includes minting and burning. If {ERC721Consecutive} is</span>
 441 |     | <span class='neutral'>     * used, the hook may be called as part of a consecutive (batch) mint, as indicated by `batchSize` greater than 1.</span>
 442 |     | <span class='neutral'>     *</span>
 443 |     | <span class='neutral'>     * Calling conditions:</span>
 444 |     | <span class='neutral'>     *</span>
 445 |     | <span class='neutral'>     * - When `from` and `to` are both non-zero, ``from``&#39;s tokens were transferred to `to`.</span>
 446 |     | <span class='neutral'>     * - When `from` is zero, the tokens were minted for `to`.</span>
 447 |     | <span class='neutral'>     * - When `to` is zero, ``from``&#39;s tokens were burned.</span>
 448 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 449 |     | <span class='neutral'>     * - `batchSize` is non-zero.</span>
 450 |     | <span class='neutral'>     *</span>
 451 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 452 |     | <span class='neutral'>     */</span>
 453 |     | <span class='neutral'>    function _afterTokenTransfer(address from, address to, uint256 firstTokenId, uint256 batchSize) internal virtual {}</span>
 454 |     | <span class='neutral'></span>
 455 |     | <span class='neutral'>    /**</span>
 456 |     | <span class='neutral'>     * @dev Unsafe write access to the balances, used by extensions that &quot;mint&quot; tokens using an {ownerOf} override.</span>
 457 |     | <span class='neutral'>     *</span>
 458 |     | <span class='neutral'>     * WARNING: Anyone calling this MUST ensure that the balances remain consistent with the ownership. The invariant</span>
 459 |     | <span class='neutral'>     * being that for any address `a` the value returned by `balanceOf(a)` must be equal to the number of tokens such</span>
 460 |     | <span class='neutral'>     * that `ownerOf(tokenId)` is `a`.</span>
 461 |     | <span class='neutral'>     */</span>
 462 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
 463 |     | <span class='neutral'>    function __unsafe_increaseBalance(address account, uint256 amount) internal {</span>
 464 |     | <span class='neutral'>        _balances[account] += amount;</span>
 465 |     | <span class='neutral'>    }</span>
 466 |     | <span class='neutral'>}</span>
 467 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC721/IERC721.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC721/IERC721.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../../utils/introspection/IERC165.sol&quot;;</span>
   7 |     | <span class='neutral'></span>
   8 |     | <span class='neutral'>/**</span>
   9 |     | <span class='neutral'> * @dev Required interface of an ERC721 compliant contract.</span>
  10 |     | <span class='neutral'> */</span>
  11 |     | <span class='neutral'>interface IERC721 is IERC165 {</span>
  12 |     | <span class='neutral'>    /**</span>
  13 |     | <span class='neutral'>     * @dev Emitted when `tokenId` token is transferred from `from` to `to`.</span>
  14 |     | <span class='neutral'>     */</span>
  15 |     | <span class='neutral'>    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);</span>
  16 |     | <span class='neutral'></span>
  17 |     | <span class='neutral'>    /**</span>
  18 |     | <span class='neutral'>     * @dev Emitted when `owner` enables `approved` to manage the `tokenId` token.</span>
  19 |     | <span class='neutral'>     */</span>
  20 |     | <span class='neutral'>    event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);</span>
  21 |     | <span class='neutral'></span>
  22 |     | <span class='neutral'>    /**</span>
  23 |     | <span class='neutral'>     * @dev Emitted when `owner` enables or disables (`approved`) `operator` to manage all of its assets.</span>
  24 |     | <span class='neutral'>     */</span>
  25 |     | <span class='neutral'>    event ApprovalForAll(address indexed owner, address indexed operator, bool approved);</span>
  26 |     | <span class='neutral'></span>
  27 |     | <span class='neutral'>    /**</span>
  28 |     | <span class='neutral'>     * @dev Returns the number of tokens in ``owner``&#39;s account.</span>
  29 |     | <span class='neutral'>     */</span>
  30 |     | <span class='neutral'>    function balanceOf(address owner) external view returns (uint256 balance);</span>
  31 |     | <span class='neutral'></span>
  32 |     | <span class='neutral'>    /**</span>
  33 |     | <span class='neutral'>     * @dev Returns the owner of the `tokenId` token.</span>
  34 |     | <span class='neutral'>     *</span>
  35 |     | <span class='neutral'>     * Requirements:</span>
  36 |     | <span class='neutral'>     *</span>
  37 |     | <span class='neutral'>     * - `tokenId` must exist.</span>
  38 |     | <span class='neutral'>     */</span>
  39 |     | <span class='neutral'>    function ownerOf(uint256 tokenId) external view returns (address owner);</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>    /**</span>
  42 |     | <span class='neutral'>     * @dev Safely transfers `tokenId` token from `from` to `to`.</span>
  43 |     | <span class='neutral'>     *</span>
  44 |     | <span class='neutral'>     * Requirements:</span>
  45 |     | <span class='neutral'>     *</span>
  46 |     | <span class='neutral'>     * - `from` cannot be the zero address.</span>
  47 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
  48 |     | <span class='neutral'>     * - `tokenId` token must exist and be owned by `from`.</span>
  49 |     | <span class='neutral'>     * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.</span>
  50 |     | <span class='neutral'>     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.</span>
  51 |     | <span class='neutral'>     *</span>
  52 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
  53 |     | <span class='neutral'>     */</span>
  54 |     | <span class='neutral'>    function safeTransferFrom(address from, address to, uint256 tokenId, bytes calldata data) external;</span>
  55 |     | <span class='neutral'></span>
  56 |     | <span class='neutral'>    /**</span>
  57 |     | <span class='neutral'>     * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients</span>
  58 |     | <span class='neutral'>     * are aware of the ERC721 protocol to prevent tokens from being forever locked.</span>
  59 |     | <span class='neutral'>     *</span>
  60 |     | <span class='neutral'>     * Requirements:</span>
  61 |     | <span class='neutral'>     *</span>
  62 |     | <span class='neutral'>     * - `from` cannot be the zero address.</span>
  63 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
  64 |     | <span class='neutral'>     * - `tokenId` token must exist and be owned by `from`.</span>
  65 |     | <span class='neutral'>     * - If the caller is not `from`, it must have been allowed to move this token by either {approve} or {setApprovalForAll}.</span>
  66 |     | <span class='neutral'>     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.</span>
  67 |     | <span class='neutral'>     *</span>
  68 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
  69 |     | <span class='neutral'>     */</span>
  70 |     | <span class='neutral'>    function safeTransferFrom(address from, address to, uint256 tokenId) external;</span>
  71 |     | <span class='neutral'></span>
  72 |     | <span class='neutral'>    /**</span>
  73 |     | <span class='neutral'>     * @dev Transfers `tokenId` token from `from` to `to`.</span>
  74 |     | <span class='neutral'>     *</span>
  75 |     | <span class='neutral'>     * WARNING: Note that the caller is responsible to confirm that the recipient is capable of receiving ERC721</span>
  76 |     | <span class='neutral'>     * or else they may be permanently lost. Usage of {safeTransferFrom} prevents loss, though the caller must</span>
  77 |     | <span class='neutral'>     * understand this adds an external call which potentially creates a reentrancy vulnerability.</span>
  78 |     | <span class='neutral'>     *</span>
  79 |     | <span class='neutral'>     * Requirements:</span>
  80 |     | <span class='neutral'>     *</span>
  81 |     | <span class='neutral'>     * - `from` cannot be the zero address.</span>
  82 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
  83 |     | <span class='neutral'>     * - `tokenId` token must be owned by `from`.</span>
  84 |     | <span class='neutral'>     * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.</span>
  85 |     | <span class='neutral'>     *</span>
  86 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
  87 |     | <span class='neutral'>     */</span>
  88 |     | <span class='neutral'>    function transferFrom(address from, address to, uint256 tokenId) external;</span>
  89 |     | <span class='neutral'></span>
  90 |     | <span class='neutral'>    /**</span>
  91 |     | <span class='neutral'>     * @dev Gives permission to `to` to transfer `tokenId` token to another account.</span>
  92 |     | <span class='neutral'>     * The approval is cleared when the token is transferred.</span>
  93 |     | <span class='neutral'>     *</span>
  94 |     | <span class='neutral'>     * Only a single account can be approved at a time, so approving the zero address clears previous approvals.</span>
  95 |     | <span class='neutral'>     *</span>
  96 |     | <span class='neutral'>     * Requirements:</span>
  97 |     | <span class='neutral'>     *</span>
  98 |     | <span class='neutral'>     * - The caller must own the token or be an approved operator.</span>
  99 |     | <span class='neutral'>     * - `tokenId` must exist.</span>
 100 |     | <span class='neutral'>     *</span>
 101 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 102 |     | <span class='neutral'>     */</span>
 103 |     | <span class='neutral'>    function approve(address to, uint256 tokenId) external;</span>
 104 |     | <span class='neutral'></span>
 105 |     | <span class='neutral'>    /**</span>
 106 |     | <span class='neutral'>     * @dev Approve or remove `operator` as an operator for the caller.</span>
 107 |     | <span class='neutral'>     * Operators can call {transferFrom} or {safeTransferFrom} for any token owned by the caller.</span>
 108 |     | <span class='neutral'>     *</span>
 109 |     | <span class='neutral'>     * Requirements:</span>
 110 |     | <span class='neutral'>     *</span>
 111 |     | <span class='neutral'>     * - The `operator` cannot be the caller.</span>
 112 |     | <span class='neutral'>     *</span>
 113 |     | <span class='neutral'>     * Emits an {ApprovalForAll} event.</span>
 114 |     | <span class='neutral'>     */</span>
 115 |     | <span class='neutral'>    function setApprovalForAll(address operator, bool approved) external;</span>
 116 |     | <span class='neutral'></span>
 117 |     | <span class='neutral'>    /**</span>
 118 |     | <span class='neutral'>     * @dev Returns the account approved for `tokenId` token.</span>
 119 |     | <span class='neutral'>     *</span>
 120 |     | <span class='neutral'>     * Requirements:</span>
 121 |     | <span class='neutral'>     *</span>
 122 |     | <span class='neutral'>     * - `tokenId` must exist.</span>
 123 |     | <span class='neutral'>     */</span>
 124 |     | <span class='neutral'>    function getApproved(uint256 tokenId) external view returns (address operator);</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    /**</span>
 127 |     | <span class='neutral'>     * @dev Returns if the `operator` is allowed to manage all of the assets of `owner`.</span>
 128 |     | <span class='neutral'>     *</span>
 129 |     | <span class='neutral'>     * See {setApprovalForAll}</span>
 130 |     | <span class='neutral'>     */</span>
 131 |     | <span class='neutral'>    function isApprovedForAll(address owner, address operator) external view returns (bool);</span>
 132 |     | <span class='neutral'>}</span>
 133 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC721/IERC721Receiver.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.6.0) (token/ERC721/IERC721Receiver.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @title ERC721 token receiver interface</span>
  8 |     | <span class='neutral'> * @dev Interface for any contract that wants to support safeTransfers</span>
  9 |     | <span class='neutral'> * from ERC721 asset contracts.</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='neutral'>interface IERC721Receiver {</span>
 12 |     | <span class='neutral'>    /**</span>
 13 |     | <span class='neutral'>     * @dev Whenever an {IERC721} `tokenId` token is transferred to this contract via {IERC721-safeTransferFrom}</span>
 14 |     | <span class='neutral'>     * by `operator` from `from`, this function is called.</span>
 15 |     | <span class='neutral'>     *</span>
 16 |     | <span class='neutral'>     * It must return its Solidity selector to confirm the token transfer.</span>
 17 |     | <span class='neutral'>     * If any other value is returned or the interface is not implemented by the recipient, the transfer will be reverted.</span>
 18 |     | <span class='neutral'>     *</span>
 19 |     | <span class='neutral'>     * The selector can be obtained in Solidity with `IERC721Receiver.onERC721Received.selector`.</span>
 20 |     | <span class='neutral'>     */</span>
 21 |     | <span class='neutral'>    function onERC721Received(</span>
 22 |     | <span class='neutral'>        address operator,</span>
 23 |     | <span class='neutral'>        address from,</span>
 24 |     | <span class='neutral'>        uint256 tokenId,</span>
 25 |     | <span class='neutral'>        bytes calldata data</span>
 26 |     | <span class='neutral'>    ) external returns (bytes4);</span>
 27 |     | <span class='neutral'>}</span>
 28 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC721/extensions/ERC721URIStorage.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC721/extensions/ERC721URIStorage.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../ERC721.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;../../../interfaces/IERC4906.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>/**</span>
 10 |     | <span class='neutral'> * @dev ERC721 token with storage based token URI management.</span>
 11 |     | <span class='neutral'> */</span>
 12 |     | <span class='neutral'>abstract contract ERC721URIStorage is IERC4906, ERC721 {</span>
 13 |     | <span class='neutral'>    using Strings for uint256;</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'>    // Optional mapping for token URIs</span>
 16 |     | <span class='neutral'>    mapping(uint256 =&gt; string) private _tokenURIs;</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='neutral'>    /**</span>
 19 |     | <span class='neutral'>     * @dev See {IERC165-supportsInterface}</span>
 20 |     | <span class='neutral'>     */</span>
 21 |     | <span class='unexecuted'>    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC721, IERC165) returns (bool) {</span>
 22 |     | <span class='unexecuted'>        return interfaceId == bytes4(0x49064906) || super.supportsInterface(interfaceId);</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='neutral'></span>
 25 |     | <span class='neutral'>    /**</span>
 26 |     | <span class='neutral'>     * @dev See {IERC721Metadata-tokenURI}.</span>
 27 |     | <span class='neutral'>     */</span>
 28 |     | <span class='unexecuted'>    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {</span>
 29 |     | <span class='unexecuted'>        _requireMinted(tokenId);</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='unexecuted'>        string memory _tokenURI = _tokenURIs[tokenId];</span>
 32 |     | <span class='unexecuted'>        string memory base = _baseURI();</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>        // If there is no base URI, return the token URI.</span>
 35 |     | <span class='unexecuted'>        if (bytes(base).length == 0) {</span>
 36 |     | <span class='unexecuted'>            return _tokenURI;</span>
 37 |     | <span class='neutral'>        }</span>
 38 |     | <span class='neutral'>        // If both are set, concatenate the baseURI and tokenURI (via abi.encodePacked).</span>
 39 |     | <span class='unexecuted'>        if (bytes(_tokenURI).length &gt; 0) {</span>
 40 |     | <span class='unexecuted'>            return string(abi.encodePacked(base, _tokenURI));</span>
 41 |     | <span class='neutral'>        }</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='unexecuted'>        return super.tokenURI(tokenId);</span>
 44 |     | <span class='neutral'>    }</span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'>    /**</span>
 47 |     | <span class='neutral'>     * @dev Sets `_tokenURI` as the tokenURI of `tokenId`.</span>
 48 |     | <span class='neutral'>     *</span>
 49 |     | <span class='neutral'>     * Emits {MetadataUpdate}.</span>
 50 |     | <span class='neutral'>     *</span>
 51 |     | <span class='neutral'>     * Requirements:</span>
 52 |     | <span class='neutral'>     *</span>
 53 |     | <span class='neutral'>     * - `tokenId` must exist.</span>
 54 |     | <span class='neutral'>     */</span>
 55 |     | <span class='unexecuted'>    function _setTokenURI(uint256 tokenId, string memory _tokenURI) internal virtual {</span>
 56 |     | <span class='unexecuted'>        require(_exists(tokenId), &quot;ERC721URIStorage: URI set of nonexistent token&quot;);</span>
 57 |     | <span class='unexecuted'>        _tokenURIs[tokenId] = _tokenURI;</span>
 58 |     | <span class='neutral'></span>
 59 |     | <span class='unexecuted'>        emit MetadataUpdate(tokenId);</span>
 60 |     | <span class='neutral'>    }</span>
 61 |     | <span class='neutral'></span>
 62 |     | <span class='neutral'>    /**</span>
 63 |     | <span class='neutral'>     * @dev See {ERC721-_burn}. This override additionally checks to see if a</span>
 64 |     | <span class='neutral'>     * token-specific URI was set for the token, and if so, it deletes the token URI from</span>
 65 |     | <span class='neutral'>     * the storage mapping.</span>
 66 |     | <span class='neutral'>     */</span>
 67 |     | <span class='unexecuted'>    function _burn(uint256 tokenId) internal virtual override {</span>
 68 |     | <span class='unexecuted'>        super._burn(tokenId);</span>
 69 |     | <span class='neutral'></span>
 70 |     | <span class='unexecuted'>        if (bytes(_tokenURIs[tokenId]).length != 0) {</span>
 71 |     | <span class='unexecuted'>            delete _tokenURIs[tokenId];</span>
 72 |     | <span class='neutral'>        }</span>
 73 |     | <span class='neutral'>    }</span>
 74 |     | <span class='neutral'>}</span>
 75 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/token/ERC721/extensions/IERC721Metadata.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (token/ERC721/extensions/IERC721Metadata.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../IERC721.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @title ERC-721 Non-Fungible Token Standard, optional metadata extension</span>
 10 |     | <span class='neutral'> * @dev See https://eips.ethereum.org/EIPS/eip-721</span>
 11 |     | <span class='neutral'> */</span>
 12 |     | <span class='neutral'>interface IERC721Metadata is IERC721 {</span>
 13 |     | <span class='neutral'>    /**</span>
 14 |     | <span class='neutral'>     * @dev Returns the token collection name.</span>
 15 |     | <span class='neutral'>     */</span>
 16 |     | <span class='neutral'>    function name() external view returns (string memory);</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='neutral'>    /**</span>
 19 |     | <span class='neutral'>     * @dev Returns the token collection symbol.</span>
 20 |     | <span class='neutral'>     */</span>
 21 |     | <span class='neutral'>    function symbol() external view returns (string memory);</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>    /**</span>
 24 |     | <span class='neutral'>     * @dev Returns the Uniform Resource Identifier (URI) for `tokenId` token.</span>
 25 |     | <span class='neutral'>     */</span>
 26 |     | <span class='neutral'>    function tokenURI(uint256 tokenId) external view returns (string memory);</span>
 27 |     | <span class='neutral'>}</span>
 28 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/Address.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/Address.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.1;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>/**</span>
   7 |     | <span class='neutral'> * @dev Collection of functions related to the address type</span>
   8 |     | <span class='neutral'> */</span>
   9 |     | <span class='unexecuted'>library Address {</span>
  10 |     | <span class='neutral'>    /**</span>
  11 |     | <span class='neutral'>     * @dev Returns true if `account` is a contract.</span>
  12 |     | <span class='neutral'>     *</span>
  13 |     | <span class='neutral'>     * [IMPORTANT]</span>
  14 |     | <span class='neutral'>     * ====</span>
  15 |     | <span class='neutral'>     * It is unsafe to assume that an address for which this function returns</span>
  16 |     | <span class='neutral'>     * false is an externally-owned account (EOA) and not a contract.</span>
  17 |     | <span class='neutral'>     *</span>
  18 |     | <span class='neutral'>     * Among others, `isContract` will return false for the following</span>
  19 |     | <span class='neutral'>     * types of addresses:</span>
  20 |     | <span class='neutral'>     *</span>
  21 |     | <span class='neutral'>     *  - an externally-owned account</span>
  22 |     | <span class='neutral'>     *  - a contract in construction</span>
  23 |     | <span class='neutral'>     *  - an address where a contract will be created</span>
  24 |     | <span class='neutral'>     *  - an address where a contract lived, but was destroyed</span>
  25 |     | <span class='neutral'>     *</span>
  26 |     | <span class='neutral'>     * Furthermore, `isContract` will also return true if the target contract within</span>
  27 |     | <span class='neutral'>     * the same transaction is already scheduled for destruction by `SELFDESTRUCT`,</span>
  28 |     | <span class='neutral'>     * which only has an effect at the end of a transaction.</span>
  29 |     | <span class='neutral'>     * ====</span>
  30 |     | <span class='neutral'>     *</span>
  31 |     | <span class='neutral'>     * [IMPORTANT]</span>
  32 |     | <span class='neutral'>     * ====</span>
  33 |     | <span class='neutral'>     * You shouldn&#39;t rely on `isContract` to protect against flash loan attacks!</span>
  34 |     | <span class='neutral'>     *</span>
  35 |     | <span class='neutral'>     * Preventing calls from contracts is highly discouraged. It breaks composability, breaks support for smart wallets</span>
  36 |     | <span class='neutral'>     * like Gnosis Safe, and does not provide security since it can be circumvented by calling from a contract</span>
  37 |     | <span class='neutral'>     * constructor.</span>
  38 |     | <span class='neutral'>     * ====</span>
  39 |     | <span class='neutral'>     */</span>
  40 |     | <span class='neutral'>    function isContract(address account) internal view returns (bool) {</span>
  41 |     | <span class='neutral'>        // This method relies on extcodesize/address.code.length, which returns 0</span>
  42 |     | <span class='neutral'>        // for contracts in construction, since the code is only stored at the end</span>
  43 |     | <span class='neutral'>        // of the constructor execution.</span>
  44 |     | <span class='neutral'></span>
  45 |     | <span class='unexecuted'>        return account.code.length &gt; 0;</span>
  46 |     | <span class='neutral'>    }</span>
  47 |     | <span class='neutral'></span>
  48 |     | <span class='neutral'>    /**</span>
  49 |     | <span class='neutral'>     * @dev Replacement for Solidity&#39;s `transfer`: sends `amount` wei to</span>
  50 |     | <span class='neutral'>     * `recipient`, forwarding all available gas and reverting on errors.</span>
  51 |     | <span class='neutral'>     *</span>
  52 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost</span>
  53 |     | <span class='neutral'>     * of certain opcodes, possibly making contracts go over the 2300 gas limit</span>
  54 |     | <span class='neutral'>     * imposed by `transfer`, making them unable to receive funds via</span>
  55 |     | <span class='neutral'>     * `transfer`. {sendValue} removes this limitation.</span>
  56 |     | <span class='neutral'>     *</span>
  57 |     | <span class='neutral'>     * https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/[Learn more].</span>
  58 |     | <span class='neutral'>     *</span>
  59 |     | <span class='neutral'>     * IMPORTANT: because control is transferred to `recipient`, care must be</span>
  60 |     | <span class='neutral'>     * taken to not create reentrancy vulnerabilities. Consider using</span>
  61 |     | <span class='neutral'>     * {ReentrancyGuard} or the</span>
  62 |     | <span class='neutral'>     * https://solidity.readthedocs.io/en/v0.8.0/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].</span>
  63 |     | <span class='neutral'>     */</span>
  64 |     | <span class='neutral'>    function sendValue(address payable recipient, uint256 amount) internal {</span>
  65 |     | <span class='neutral'>        require(address(this).balance &gt;= amount, &quot;Address: insufficient balance&quot;);</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='neutral'>        (bool success, ) = recipient.call{value: amount}(&quot;&quot;);</span>
  68 |     | <span class='neutral'>        require(success, &quot;Address: unable to send value, recipient may have reverted&quot;);</span>
  69 |     | <span class='neutral'>    }</span>
  70 |     | <span class='neutral'></span>
  71 |     | <span class='neutral'>    /**</span>
  72 |     | <span class='neutral'>     * @dev Performs a Solidity function call using a low level `call`. A</span>
  73 |     | <span class='neutral'>     * plain `call` is an unsafe replacement for a function call: use this</span>
  74 |     | <span class='neutral'>     * function instead.</span>
  75 |     | <span class='neutral'>     *</span>
  76 |     | <span class='neutral'>     * If `target` reverts with a revert reason, it is bubbled up by this</span>
  77 |     | <span class='neutral'>     * function (like regular Solidity function calls).</span>
  78 |     | <span class='neutral'>     *</span>
  79 |     | <span class='neutral'>     * Returns the raw returned data. To convert to the expected return value,</span>
  80 |     | <span class='neutral'>     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].</span>
  81 |     | <span class='neutral'>     *</span>
  82 |     | <span class='neutral'>     * Requirements:</span>
  83 |     | <span class='neutral'>     *</span>
  84 |     | <span class='neutral'>     * - `target` must be a contract.</span>
  85 |     | <span class='neutral'>     * - calling `target` with `data` must not revert.</span>
  86 |     | <span class='neutral'>     *</span>
  87 |     | <span class='neutral'>     * _Available since v3.1._</span>
  88 |     | <span class='neutral'>     */</span>
  89 |     | <span class='neutral'>    function functionCall(address target, bytes memory data) internal returns (bytes memory) {</span>
  90 |     | <span class='neutral'>        return functionCallWithValue(target, data, 0, &quot;Address: low-level call failed&quot;);</span>
  91 |     | <span class='neutral'>    }</span>
  92 |     | <span class='neutral'></span>
  93 |     | <span class='neutral'>    /**</span>
  94 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with</span>
  95 |     | <span class='neutral'>     * `errorMessage` as a fallback revert reason when `target` reverts.</span>
  96 |     | <span class='neutral'>     *</span>
  97 |     | <span class='neutral'>     * _Available since v3.1._</span>
  98 |     | <span class='neutral'>     */</span>
  99 |     | <span class='unexecuted'>    function functionCall(</span>
 100 |     | <span class='neutral'>        address target,</span>
 101 |     | <span class='neutral'>        bytes memory data,</span>
 102 |     | <span class='neutral'>        string memory errorMessage</span>
 103 |     | <span class='unexecuted'>    ) internal returns (bytes memory) {</span>
 104 |     | <span class='unexecuted'>        return functionCallWithValue(target, data, 0, errorMessage);</span>
 105 |     | <span class='neutral'>    }</span>
 106 |     | <span class='neutral'></span>
 107 |     | <span class='neutral'>    /**</span>
 108 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 109 |     | <span class='neutral'>     * but also transferring `value` wei to `target`.</span>
 110 |     | <span class='neutral'>     *</span>
 111 |     | <span class='neutral'>     * Requirements:</span>
 112 |     | <span class='neutral'>     *</span>
 113 |     | <span class='neutral'>     * - the calling contract must have an ETH balance of at least `value`.</span>
 114 |     | <span class='neutral'>     * - the called Solidity function must be `payable`.</span>
 115 |     | <span class='neutral'>     *</span>
 116 |     | <span class='neutral'>     * _Available since v3.1._</span>
 117 |     | <span class='neutral'>     */</span>
 118 |     | <span class='neutral'>    function functionCallWithValue(address target, bytes memory data, uint256 value) internal returns (bytes memory) {</span>
 119 |     | <span class='neutral'>        return functionCallWithValue(target, data, value, &quot;Address: low-level call with value failed&quot;);</span>
 120 |     | <span class='neutral'>    }</span>
 121 |     | <span class='neutral'></span>
 122 |     | <span class='neutral'>    /**</span>
 123 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but</span>
 124 |     | <span class='neutral'>     * with `errorMessage` as a fallback revert reason when `target` reverts.</span>
 125 |     | <span class='neutral'>     *</span>
 126 |     | <span class='neutral'>     * _Available since v3.1._</span>
 127 |     | <span class='neutral'>     */</span>
 128 |     | <span class='unexecuted'>    function functionCallWithValue(</span>
 129 |     | <span class='neutral'>        address target,</span>
 130 |     | <span class='neutral'>        bytes memory data,</span>
 131 |     | <span class='neutral'>        uint256 value,</span>
 132 |     | <span class='neutral'>        string memory errorMessage</span>
 133 |     | <span class='neutral'>    ) internal returns (bytes memory) {</span>
 134 |     | <span class='neutral'>        require(address(this).balance &gt;= value, &quot;Address: insufficient balance for call&quot;);</span>
 135 |     | <span class='unexecuted'>        (bool success, bytes memory returndata) = target.call{value: value}(data);</span>
 136 |     | <span class='unexecuted'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 137 |     | <span class='neutral'>    }</span>
 138 |     | <span class='neutral'></span>
 139 |     | <span class='neutral'>    /**</span>
 140 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 141 |     | <span class='neutral'>     * but performing a static call.</span>
 142 |     | <span class='neutral'>     *</span>
 143 |     | <span class='neutral'>     * _Available since v3.3._</span>
 144 |     | <span class='neutral'>     */</span>
 145 |     | <span class='neutral'>    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {</span>
 146 |     | <span class='neutral'>        return functionStaticCall(target, data, &quot;Address: low-level static call failed&quot;);</span>
 147 |     | <span class='neutral'>    }</span>
 148 |     | <span class='neutral'></span>
 149 |     | <span class='neutral'>    /**</span>
 150 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 151 |     | <span class='neutral'>     * but performing a static call.</span>
 152 |     | <span class='neutral'>     *</span>
 153 |     | <span class='neutral'>     * _Available since v3.3._</span>
 154 |     | <span class='neutral'>     */</span>
 155 |     | <span class='neutral'>    function functionStaticCall(</span>
 156 |     | <span class='neutral'>        address target,</span>
 157 |     | <span class='neutral'>        bytes memory data,</span>
 158 |     | <span class='neutral'>        string memory errorMessage</span>
 159 |     | <span class='neutral'>    ) internal view returns (bytes memory) {</span>
 160 |     | <span class='neutral'>        (bool success, bytes memory returndata) = target.staticcall(data);</span>
 161 |     | <span class='neutral'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 162 |     | <span class='neutral'>    }</span>
 163 |     | <span class='neutral'></span>
 164 |     | <span class='neutral'>    /**</span>
 165 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 166 |     | <span class='neutral'>     * but performing a delegate call.</span>
 167 |     | <span class='neutral'>     *</span>
 168 |     | <span class='neutral'>     * _Available since v3.4._</span>
 169 |     | <span class='neutral'>     */</span>
 170 |     | <span class='neutral'>    function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {</span>
 171 |     | <span class='neutral'>        return functionDelegateCall(target, data, &quot;Address: low-level delegate call failed&quot;);</span>
 172 |     | <span class='neutral'>    }</span>
 173 |     | <span class='neutral'></span>
 174 |     | <span class='neutral'>    /**</span>
 175 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 176 |     | <span class='neutral'>     * but performing a delegate call.</span>
 177 |     | <span class='neutral'>     *</span>
 178 |     | <span class='neutral'>     * _Available since v3.4._</span>
 179 |     | <span class='neutral'>     */</span>
 180 |     | <span class='neutral'>    function functionDelegateCall(</span>
 181 |     | <span class='neutral'>        address target,</span>
 182 |     | <span class='neutral'>        bytes memory data,</span>
 183 |     | <span class='neutral'>        string memory errorMessage</span>
 184 |     | <span class='neutral'>    ) internal returns (bytes memory) {</span>
 185 |     | <span class='neutral'>        (bool success, bytes memory returndata) = target.delegatecall(data);</span>
 186 |     | <span class='neutral'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 187 |     | <span class='neutral'>    }</span>
 188 |     | <span class='neutral'></span>
 189 |     | <span class='neutral'>    /**</span>
 190 |     | <span class='neutral'>     * @dev Tool to verify that a low level call to smart-contract was successful, and revert (either by bubbling</span>
 191 |     | <span class='neutral'>     * the revert reason or using the provided one) in case of unsuccessful call or if target was not a contract.</span>
 192 |     | <span class='neutral'>     *</span>
 193 |     | <span class='neutral'>     * _Available since v4.8._</span>
 194 |     | <span class='neutral'>     */</span>
 195 |     | <span class='unexecuted'>    function verifyCallResultFromTarget(</span>
 196 |     | <span class='neutral'>        address target,</span>
 197 |     | <span class='neutral'>        bool success,</span>
 198 |     | <span class='neutral'>        bytes memory returndata,</span>
 199 |     | <span class='neutral'>        string memory errorMessage</span>
 200 |     | <span class='unexecuted'>    ) internal view returns (bytes memory) {</span>
 201 |     | <span class='unexecuted'>        if (success) {</span>
 202 |     | <span class='unexecuted'>            if (returndata.length == 0) {</span>
 203 |     | <span class='neutral'>                // only check isContract if the call was successful and the return data is empty</span>
 204 |     | <span class='neutral'>                // otherwise we already know that it was a contract</span>
 205 |     | <span class='unexecuted'>                require(isContract(target), &quot;Address: call to non-contract&quot;);</span>
 206 |     | <span class='neutral'>            }</span>
 207 |     | <span class='unexecuted'>            return returndata;</span>
 208 |     | <span class='neutral'>        } else {</span>
 209 |     | <span class='unexecuted'>            _revert(returndata, errorMessage);</span>
 210 |     | <span class='neutral'>        }</span>
 211 |     | <span class='neutral'>    }</span>
 212 |     | <span class='neutral'></span>
 213 |     | <span class='neutral'>    /**</span>
 214 |     | <span class='neutral'>     * @dev Tool to verify that a low level call was successful, and revert if it wasn&#39;t, either by bubbling the</span>
 215 |     | <span class='neutral'>     * revert reason or using the provided one.</span>
 216 |     | <span class='neutral'>     *</span>
 217 |     | <span class='neutral'>     * _Available since v4.3._</span>
 218 |     | <span class='neutral'>     */</span>
 219 |     | <span class='neutral'>    function verifyCallResult(</span>
 220 |     | <span class='neutral'>        bool success,</span>
 221 |     | <span class='neutral'>        bytes memory returndata,</span>
 222 |     | <span class='neutral'>        string memory errorMessage</span>
 223 |     | <span class='neutral'>    ) internal pure returns (bytes memory) {</span>
 224 |     | <span class='neutral'>        if (success) {</span>
 225 |     | <span class='neutral'>            return returndata;</span>
 226 |     | <span class='neutral'>        } else {</span>
 227 |     | <span class='neutral'>            _revert(returndata, errorMessage);</span>
 228 |     | <span class='neutral'>        }</span>
 229 |     | <span class='neutral'>    }</span>
 230 |     | <span class='neutral'></span>
 231 |     | <span class='neutral'>    function _revert(bytes memory returndata, string memory errorMessage) private pure {</span>
 232 |     | <span class='neutral'>        // Look for revert reason and bubble it up if present</span>
 233 |     | <span class='unexecuted'>        if (returndata.length &gt; 0) {</span>
 234 |     | <span class='neutral'>            // The easiest way to bubble the revert reason is using memory via assembly</span>
 235 |     | <span class='neutral'>            /// @solidity memory-safe-assembly</span>
 236 |     | <span class='neutral'>            assembly {</span>
 237 |     | <span class='unexecuted'>                let returndata_size := mload(returndata)</span>
 238 |     | <span class='unexecuted'>                revert(add(32, returndata), returndata_size)</span>
 239 |     | <span class='neutral'>            }</span>
 240 |     | <span class='neutral'>        } else {</span>
 241 |     | <span class='unexecuted'>            revert(errorMessage);</span>
 242 |     | <span class='neutral'>        }</span>
 243 |     | <span class='neutral'>    }</span>
 244 |     | <span class='neutral'>}</span>
 245 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/Context.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/Context.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Provides information about the current execution context, including the</span>
  8 |     | <span class='neutral'> * sender of the transaction and its data. While these are generally available</span>
  9 |     | <span class='neutral'> * via msg.sender and msg.data, they should not be accessed in such a direct</span>
 10 |     | <span class='neutral'> * manner, since when dealing with meta-transactions the account sending and</span>
 11 |     | <span class='neutral'> * paying for execution may not be the actual sender (as far as an application</span>
 12 |     | <span class='neutral'> * is concerned).</span>
 13 |     | <span class='neutral'> *</span>
 14 |     | <span class='neutral'> * This contract is only required for intermediate, library-like contracts.</span>
 15 |     | <span class='neutral'> */</span>
 16 |     | <span class='neutral'>abstract contract Context {</span>
 17 |     | <span class='neutral'>    function _msgSender() internal view virtual returns (address) {</span>
 18 |     | <span class='unexecuted'>        return msg.sender;</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    function _msgData() internal view virtual returns (bytes calldata) {</span>
 22 |     | <span class='neutral'>        return msg.data;</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='neutral'>}</span>
 25 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/Counters.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/Counters.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @title Counters</span>
  8 |     | <span class='neutral'> * @author Matt Condon (@shrugs)</span>
  9 |     | <span class='neutral'> * @dev Provides counters that can only be incremented, decremented or reset. This can be used e.g. to track the number</span>
 10 |     | <span class='neutral'> * of elements in a mapping, issuing ERC721 ids, or counting request ids.</span>
 11 |     | <span class='neutral'> *</span>
 12 |     | <span class='neutral'> * Include with `using Counters for Counters.Counter;`</span>
 13 |     | <span class='neutral'> */</span>
 14 |     | <span class='unexecuted'>library Counters {</span>
 15 |     | <span class='neutral'>    struct Counter {</span>
 16 |     | <span class='neutral'>        // This variable should never be directly accessed by users of the library: interactions must be restricted to</span>
 17 |     | <span class='neutral'>        // the library&#39;s function. As of Solidity v0.5.2, this cannot be enforced, though there is a proposal to add</span>
 18 |     | <span class='neutral'>        // this feature: see https://github.com/ethereum/solidity/issues/4637</span>
 19 |     | <span class='neutral'>        uint256 _value; // default: 0</span>
 20 |     | <span class='neutral'>    }</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='unexecuted'>    function current(Counter storage counter) internal view returns (uint256) {</span>
 23 |     | <span class='unexecuted'>        return counter._value;</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'>    function increment(Counter storage counter) internal {</span>
 27 |     | <span class='neutral'>        unchecked {</span>
 28 |     | <span class='unexecuted'>            counter._value += 1;</span>
 29 |     | <span class='neutral'>        }</span>
 30 |     | <span class='neutral'>    }</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    function decrement(Counter storage counter) internal {</span>
 33 |     | <span class='neutral'>        uint256 value = counter._value;</span>
 34 |     | <span class='neutral'>        require(value &gt; 0, &quot;Counter: decrement overflow&quot;);</span>
 35 |     | <span class='neutral'>        unchecked {</span>
 36 |     | <span class='neutral'>            counter._value = value - 1;</span>
 37 |     | <span class='neutral'>        }</span>
 38 |     | <span class='neutral'>    }</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='neutral'>    function reset(Counter storage counter) internal {</span>
 41 |     | <span class='neutral'>        counter._value = 0;</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'>}</span>
 44 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/ShortStrings.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/ShortStrings.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.8;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./StorageSlot.sol&quot;;</span>
   7 |     | <span class='neutral'></span>
   8 |     | <span class='neutral'>// | string  | 0xAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA   |</span>
   9 |     | <span class='neutral'>// | length  | 0x                                                              BB |</span>
  10 |     | <span class='neutral'>type ShortString is bytes32;</span>
  11 |     | <span class='neutral'></span>
  12 |     | <span class='neutral'>/**</span>
  13 |     | <span class='neutral'> * @dev This library provides functions to convert short memory strings</span>
  14 |     | <span class='neutral'> * into a `ShortString` type that can be used as an immutable variable.</span>
  15 |     | <span class='neutral'> *</span>
  16 |     | <span class='neutral'> * Strings of arbitrary length can be optimized using this library if</span>
  17 |     | <span class='neutral'> * they are short enough (up to 31 bytes) by packing them with their</span>
  18 |     | <span class='neutral'> * length (1 byte) in a single EVM word (32 bytes). Additionally, a</span>
  19 |     | <span class='neutral'> * fallback mechanism can be used for every other case.</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> * Usage example:</span>
  22 |     | <span class='neutral'> *</span>
  23 |     | <span class='neutral'> * ```solidity</span>
  24 |     | <span class='neutral'> * contract Named {</span>
  25 |     | <span class='neutral'> *     using ShortStrings for *;</span>
  26 |     | <span class='neutral'> *</span>
  27 |     | <span class='neutral'> *     ShortString private immutable _name;</span>
  28 |     | <span class='neutral'> *     string private _nameFallback;</span>
  29 |     | <span class='neutral'> *</span>
  30 |     | <span class='neutral'> *     constructor(string memory contractName) {</span>
  31 |     | <span class='neutral'> *         _name = contractName.toShortStringWithFallback(_nameFallback);</span>
  32 |     | <span class='neutral'> *     }</span>
  33 |     | <span class='neutral'> *</span>
  34 |     | <span class='neutral'> *     function name() external view returns (string memory) {</span>
  35 |     | <span class='neutral'> *         return _name.toStringWithFallback(_nameFallback);</span>
  36 |     | <span class='neutral'> *     }</span>
  37 |     | <span class='neutral'> * }</span>
  38 |     | <span class='neutral'> * ```</span>
  39 |     | <span class='neutral'> */</span>
  40 |     | <span class='unexecuted'>library ShortStrings {</span>
  41 |     | <span class='neutral'>    // Used as an identifier for strings longer than 31 bytes.</span>
  42 |     | <span class='unexecuted'>    bytes32 private constant _FALLBACK_SENTINEL = 0x00000000000000000000000000000000000000000000000000000000000000FF;</span>
  43 |     | <span class='neutral'></span>
  44 |     | <span class='neutral'>    error StringTooLong(string str);</span>
  45 |     | <span class='neutral'>    error InvalidShortString();</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    /**</span>
  48 |     | <span class='neutral'>     * @dev Encode a string of at most 31 chars into a `ShortString`.</span>
  49 |     | <span class='neutral'>     *</span>
  50 |     | <span class='neutral'>     * This will trigger a `StringTooLong` error is the input string is too long.</span>
  51 |     | <span class='neutral'>     */</span>
  52 |     | <span class='unexecuted'>    function toShortString(string memory str) internal pure returns (ShortString) {</span>
  53 |     | <span class='unexecuted'>        bytes memory bstr = bytes(str);</span>
  54 |     | <span class='unexecuted'>        if (bstr.length &gt; 31) {</span>
  55 |     | <span class='unexecuted'>            revert StringTooLong(str);</span>
  56 |     | <span class='neutral'>        }</span>
  57 |     | <span class='unexecuted'>        return ShortString.wrap(bytes32(uint256(bytes32(bstr)) | bstr.length));</span>
  58 |     | <span class='neutral'>    }</span>
  59 |     | <span class='neutral'></span>
  60 |     | <span class='neutral'>    /**</span>
  61 |     | <span class='neutral'>     * @dev Decode a `ShortString` back to a &quot;normal&quot; string.</span>
  62 |     | <span class='neutral'>     */</span>
  63 |     | <span class='unexecuted'>    function toString(ShortString sstr) internal pure returns (string memory) {</span>
  64 |     | <span class='unexecuted'>        uint256 len = byteLength(sstr);</span>
  65 |     | <span class='neutral'>        // using `new string(len)` would work locally but is not memory safe.</span>
  66 |     | <span class='unexecuted'>        string memory str = new string(32);</span>
  67 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  68 |     | <span class='neutral'>        assembly {</span>
  69 |     | <span class='unexecuted'>            mstore(str, len)</span>
  70 |     | <span class='unexecuted'>            mstore(add(str, 0x20), sstr)</span>
  71 |     | <span class='neutral'>        }</span>
  72 |     | <span class='neutral'>        return str;</span>
  73 |     | <span class='neutral'>    }</span>
  74 |     | <span class='neutral'></span>
  75 |     | <span class='neutral'>    /**</span>
  76 |     | <span class='neutral'>     * @dev Return the length of a `ShortString`.</span>
  77 |     | <span class='neutral'>     */</span>
  78 |     | <span class='unexecuted'>    function byteLength(ShortString sstr) internal pure returns (uint256) {</span>
  79 |     | <span class='unexecuted'>        uint256 result = uint256(ShortString.unwrap(sstr)) &amp; 0xFF;</span>
  80 |     | <span class='unexecuted'>        if (result &gt; 31) {</span>
  81 |     | <span class='unexecuted'>            revert InvalidShortString();</span>
  82 |     | <span class='neutral'>        }</span>
  83 |     | <span class='neutral'>        return result;</span>
  84 |     | <span class='neutral'>    }</span>
  85 |     | <span class='neutral'></span>
  86 |     | <span class='neutral'>    /**</span>
  87 |     | <span class='neutral'>     * @dev Encode a string into a `ShortString`, or write it to storage if it is too long.</span>
  88 |     | <span class='neutral'>     */</span>
  89 |     | <span class='unexecuted'>    function toShortStringWithFallback(string memory value, string storage store) internal returns (ShortString) {</span>
  90 |     | <span class='unexecuted'>        if (bytes(value).length &lt; 32) {</span>
  91 |     | <span class='unexecuted'>            return toShortString(value);</span>
  92 |     | <span class='neutral'>        } else {</span>
  93 |     | <span class='unexecuted'>            StorageSlot.getStringSlot(store).value = value;</span>
  94 |     | <span class='neutral'>            return ShortString.wrap(_FALLBACK_SENTINEL);</span>
  95 |     | <span class='neutral'>        }</span>
  96 |     | <span class='neutral'>    }</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>    /**</span>
  99 |     | <span class='neutral'>     * @dev Decode a string that was encoded to `ShortString` or written to storage using {setWithFallback}.</span>
 100 |     | <span class='neutral'>     */</span>
 101 |     | <span class='unexecuted'>    function toStringWithFallback(ShortString value, string storage store) internal pure returns (string memory) {</span>
 102 |     | <span class='unexecuted'>        if (ShortString.unwrap(value) != _FALLBACK_SENTINEL) {</span>
 103 |     | <span class='unexecuted'>            return toString(value);</span>
 104 |     | <span class='neutral'>        } else {</span>
 105 |     | <span class='unexecuted'>            return store;</span>
 106 |     | <span class='neutral'>        }</span>
 107 |     | <span class='neutral'>    }</span>
 108 |     | <span class='neutral'></span>
 109 |     | <span class='neutral'>    /**</span>
 110 |     | <span class='neutral'>     * @dev Return the length of a string that was encoded to `ShortString` or written to storage using {setWithFallback}.</span>
 111 |     | <span class='neutral'>     *</span>
 112 |     | <span class='neutral'>     * WARNING: This will return the &quot;byte length&quot; of the string. This may not reflect the actual length in terms of</span>
 113 |     | <span class='neutral'>     * actual characters as the UTF-8 encoding of a single character can span over multiple bytes.</span>
 114 |     | <span class='neutral'>     */</span>
 115 |     | <span class='neutral'>    function byteLengthWithFallback(ShortString value, string storage store) internal view returns (uint256) {</span>
 116 |     | <span class='neutral'>        if (ShortString.unwrap(value) != _FALLBACK_SENTINEL) {</span>
 117 |     | <span class='neutral'>            return byteLength(value);</span>
 118 |     | <span class='neutral'>        } else {</span>
 119 |     | <span class='neutral'>            return bytes(store).length;</span>
 120 |     | <span class='neutral'>        }</span>
 121 |     | <span class='neutral'>    }</span>
 122 |     | <span class='neutral'>}</span>
 123 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/StorageSlot.sol)</span>
   3 |     | <span class='neutral'>// This file was procedurally generated from scripts/generate/templates/StorageSlot.js.</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   6 |     | <span class='neutral'></span>
   7 |     | <span class='neutral'>/**</span>
   8 |     | <span class='neutral'> * @dev Library for reading and writing primitive types to specific storage slots.</span>
   9 |     | <span class='neutral'> *</span>
  10 |     | <span class='neutral'> * Storage slots are often used to avoid storage conflict when dealing with upgradeable contracts.</span>
  11 |     | <span class='neutral'> * This library helps with reading and writing to such slots without the need for inline assembly.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * The functions in this library return Slot structs that contain a `value` member that can be used to read or write.</span>
  14 |     | <span class='neutral'> *</span>
  15 |     | <span class='neutral'> * Example usage to set ERC1967 implementation slot:</span>
  16 |     | <span class='neutral'> * ```solidity</span>
  17 |     | <span class='neutral'> * contract ERC1967 {</span>
  18 |     | <span class='neutral'> *     bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;</span>
  19 |     | <span class='neutral'> *</span>
  20 |     | <span class='neutral'> *     function _getImplementation() internal view returns (address) {</span>
  21 |     | <span class='neutral'> *         return StorageSlot.getAddressSlot(_IMPLEMENTATION_SLOT).value;</span>
  22 |     | <span class='neutral'> *     }</span>
  23 |     | <span class='neutral'> *</span>
  24 |     | <span class='neutral'> *     function _setImplementation(address newImplementation) internal {</span>
  25 |     | <span class='neutral'> *         require(Address.isContract(newImplementation), &quot;ERC1967: new implementation is not a contract&quot;);</span>
  26 |     | <span class='neutral'> *         StorageSlot.getAddressSlot(_IMPLEMENTATION_SLOT).value = newImplementation;</span>
  27 |     | <span class='neutral'> *     }</span>
  28 |     | <span class='neutral'> * }</span>
  29 |     | <span class='neutral'> * ```</span>
  30 |     | <span class='neutral'> *</span>
  31 |     | <span class='neutral'> * _Available since v4.1 for `address`, `bool`, `bytes32`, `uint256`._</span>
  32 |     | <span class='neutral'> * _Available since v4.9 for `string`, `bytes`._</span>
  33 |     | <span class='neutral'> */</span>
  34 |     | <span class='unexecuted'>library StorageSlot {</span>
  35 |     | <span class='neutral'>    struct AddressSlot {</span>
  36 |     | <span class='neutral'>        address value;</span>
  37 |     | <span class='neutral'>    }</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>    struct BooleanSlot {</span>
  40 |     | <span class='neutral'>        bool value;</span>
  41 |     | <span class='neutral'>    }</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>    struct Bytes32Slot {</span>
  44 |     | <span class='neutral'>        bytes32 value;</span>
  45 |     | <span class='neutral'>    }</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    struct Uint256Slot {</span>
  48 |     | <span class='neutral'>        uint256 value;</span>
  49 |     | <span class='neutral'>    }</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>    struct StringSlot {</span>
  52 |     | <span class='neutral'>        string value;</span>
  53 |     | <span class='neutral'>    }</span>
  54 |     | <span class='neutral'></span>
  55 |     | <span class='neutral'>    struct BytesSlot {</span>
  56 |     | <span class='neutral'>        bytes value;</span>
  57 |     | <span class='neutral'>    }</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    /**</span>
  60 |     | <span class='neutral'>     * @dev Returns an `AddressSlot` with member `value` located at `slot`.</span>
  61 |     | <span class='neutral'>     */</span>
  62 |     | <span class='neutral'>    function getAddressSlot(bytes32 slot) internal pure returns (AddressSlot storage r) {</span>
  63 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  64 |     | <span class='neutral'>        assembly {</span>
  65 |     | <span class='neutral'>            r.slot := slot</span>
  66 |     | <span class='neutral'>        }</span>
  67 |     | <span class='neutral'>    }</span>
  68 |     | <span class='neutral'></span>
  69 |     | <span class='neutral'>    /**</span>
  70 |     | <span class='neutral'>     * @dev Returns an `BooleanSlot` with member `value` located at `slot`.</span>
  71 |     | <span class='neutral'>     */</span>
  72 |     | <span class='neutral'>    function getBooleanSlot(bytes32 slot) internal pure returns (BooleanSlot storage r) {</span>
  73 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  74 |     | <span class='neutral'>        assembly {</span>
  75 |     | <span class='neutral'>            r.slot := slot</span>
  76 |     | <span class='neutral'>        }</span>
  77 |     | <span class='neutral'>    }</span>
  78 |     | <span class='neutral'></span>
  79 |     | <span class='neutral'>    /**</span>
  80 |     | <span class='neutral'>     * @dev Returns an `Bytes32Slot` with member `value` located at `slot`.</span>
  81 |     | <span class='neutral'>     */</span>
  82 |     | <span class='neutral'>    function getBytes32Slot(bytes32 slot) internal pure returns (Bytes32Slot storage r) {</span>
  83 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  84 |     | <span class='neutral'>        assembly {</span>
  85 |     | <span class='neutral'>            r.slot := slot</span>
  86 |     | <span class='neutral'>        }</span>
  87 |     | <span class='neutral'>    }</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>    /**</span>
  90 |     | <span class='neutral'>     * @dev Returns an `Uint256Slot` with member `value` located at `slot`.</span>
  91 |     | <span class='neutral'>     */</span>
  92 |     | <span class='neutral'>    function getUint256Slot(bytes32 slot) internal pure returns (Uint256Slot storage r) {</span>
  93 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  94 |     | <span class='neutral'>        assembly {</span>
  95 |     | <span class='neutral'>            r.slot := slot</span>
  96 |     | <span class='neutral'>        }</span>
  97 |     | <span class='neutral'>    }</span>
  98 |     | <span class='neutral'></span>
  99 |     | <span class='neutral'>    /**</span>
 100 |     | <span class='neutral'>     * @dev Returns an `StringSlot` with member `value` located at `slot`.</span>
 101 |     | <span class='neutral'>     */</span>
 102 |     | <span class='neutral'>    function getStringSlot(bytes32 slot) internal pure returns (StringSlot storage r) {</span>
 103 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 104 |     | <span class='neutral'>        assembly {</span>
 105 |     | <span class='neutral'>            r.slot := slot</span>
 106 |     | <span class='neutral'>        }</span>
 107 |     | <span class='neutral'>    }</span>
 108 |     | <span class='neutral'></span>
 109 |     | <span class='neutral'>    /**</span>
 110 |     | <span class='neutral'>     * @dev Returns an `StringSlot` representation of the string storage pointer `store`.</span>
 111 |     | <span class='neutral'>     */</span>
 112 |     | <span class='neutral'>    function getStringSlot(string storage store) internal pure returns (StringSlot storage r) {</span>
 113 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 114 |     | <span class='neutral'>        assembly {</span>
 115 |     | <span class='neutral'>            r.slot := store.slot</span>
 116 |     | <span class='neutral'>        }</span>
 117 |     | <span class='neutral'>    }</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>    /**</span>
 120 |     | <span class='neutral'>     * @dev Returns an `BytesSlot` with member `value` located at `slot`.</span>
 121 |     | <span class='neutral'>     */</span>
 122 |     | <span class='neutral'>    function getBytesSlot(bytes32 slot) internal pure returns (BytesSlot storage r) {</span>
 123 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 124 |     | <span class='neutral'>        assembly {</span>
 125 |     | <span class='neutral'>            r.slot := slot</span>
 126 |     | <span class='neutral'>        }</span>
 127 |     | <span class='neutral'>    }</span>
 128 |     | <span class='neutral'></span>
 129 |     | <span class='neutral'>    /**</span>
 130 |     | <span class='neutral'>     * @dev Returns an `BytesSlot` representation of the bytes storage pointer `store`.</span>
 131 |     | <span class='neutral'>     */</span>
 132 |     | <span class='neutral'>    function getBytesSlot(bytes storage store) internal pure returns (BytesSlot storage r) {</span>
 133 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 134 |     | <span class='neutral'>        assembly {</span>
 135 |     | <span class='neutral'>            r.slot := store.slot</span>
 136 |     | <span class='neutral'>        }</span>
 137 |     | <span class='neutral'>    }</span>
 138 |     | <span class='neutral'>}</span>
 139 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/Strings.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/Strings.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./math/Math.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;./math/SignedMath.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>/**</span>
 10 |     | <span class='neutral'> * @dev String operations.</span>
 11 |     | <span class='neutral'> */</span>
 12 |     | <span class='unexecuted'>library Strings {</span>
 13 |     | <span class='neutral'>    bytes16 private constant _SYMBOLS = &quot;0123456789abcdef&quot;;</span>
 14 |     | <span class='neutral'>    uint8 private constant _ADDRESS_LENGTH = 20;</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    /**</span>
 17 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span>
 18 |     | <span class='neutral'>     */</span>
 19 |     | <span class='unexecuted'>    function toString(uint256 value) internal pure returns (string memory) {</span>
 20 |     | <span class='neutral'>        unchecked {</span>
 21 |     | <span class='unexecuted'>            uint256 length = Math.log10(value) + 1;</span>
 22 |     | <span class='unexecuted'>            string memory buffer = new string(length);</span>
 23 |     | <span class='neutral'>            uint256 ptr;</span>
 24 |     | <span class='neutral'>            /// @solidity memory-safe-assembly</span>
 25 |     | <span class='neutral'>            assembly {</span>
 26 |     | <span class='unexecuted'>                ptr := add(buffer, add(32, length))</span>
 27 |     | <span class='neutral'>            }</span>
 28 |     | <span class='unexecuted'>            while (true) {</span>
 29 |     | <span class='unexecuted'>                ptr--;</span>
 30 |     | <span class='neutral'>                /// @solidity memory-safe-assembly</span>
 31 |     | <span class='neutral'>                assembly {</span>
 32 |     | <span class='unexecuted'>                    mstore8(ptr, byte(mod(value, 10), _SYMBOLS))</span>
 33 |     | <span class='neutral'>                }</span>
 34 |     | <span class='unexecuted'>                value /= 10;</span>
 35 |     | <span class='unexecuted'>                if (value == 0) break;</span>
 36 |     | <span class='neutral'>            }</span>
 37 |     | <span class='unexecuted'>            return buffer;</span>
 38 |     | <span class='neutral'>        }</span>
 39 |     | <span class='neutral'>    }</span>
 40 |     | <span class='neutral'></span>
 41 |     | <span class='neutral'>    /**</span>
 42 |     | <span class='neutral'>     * @dev Converts a `int256` to its ASCII `string` decimal representation.</span>
 43 |     | <span class='neutral'>     */</span>
 44 |     | <span class='neutral'>    function toString(int256 value) internal pure returns (string memory) {</span>
 45 |     | <span class='neutral'>        return string(abi.encodePacked(value &lt; 0 ? &quot;-&quot; : &quot;&quot;, toString(SignedMath.abs(value))));</span>
 46 |     | <span class='neutral'>    }</span>
 47 |     | <span class='neutral'></span>
 48 |     | <span class='neutral'>    /**</span>
 49 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span>
 50 |     | <span class='neutral'>     */</span>
 51 |     | <span class='neutral'>    function toHexString(uint256 value) internal pure returns (string memory) {</span>
 52 |     | <span class='neutral'>        unchecked {</span>
 53 |     | <span class='neutral'>            return toHexString(value, Math.log256(value) + 1);</span>
 54 |     | <span class='neutral'>        }</span>
 55 |     | <span class='neutral'>    }</span>
 56 |     | <span class='neutral'></span>
 57 |     | <span class='neutral'>    /**</span>
 58 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span>
 59 |     | <span class='neutral'>     */</span>
 60 |     | <span class='neutral'>    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {</span>
 61 |     | <span class='neutral'>        bytes memory buffer = new bytes(2 * length + 2);</span>
 62 |     | <span class='neutral'>        buffer[0] = &quot;0&quot;;</span>
 63 |     | <span class='neutral'>        buffer[1] = &quot;x&quot;;</span>
 64 |     | <span class='neutral'>        for (uint256 i = 2 * length + 1; i &gt; 1; --i) {</span>
 65 |     | <span class='neutral'>            buffer[i] = _SYMBOLS[value &amp; 0xf];</span>
 66 |     | <span class='neutral'>            value &gt;&gt;= 4;</span>
 67 |     | <span class='neutral'>        }</span>
 68 |     | <span class='neutral'>        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span>
 69 |     | <span class='neutral'>        return string(buffer);</span>
 70 |     | <span class='neutral'>    }</span>
 71 |     | <span class='neutral'></span>
 72 |     | <span class='neutral'>    /**</span>
 73 |     | <span class='neutral'>     * @dev Converts an `address` with fixed length of 20 bytes to its not checksummed ASCII `string` hexadecimal representation.</span>
 74 |     | <span class='neutral'>     */</span>
 75 |     | <span class='neutral'>    function toHexString(address addr) internal pure returns (string memory) {</span>
 76 |     | <span class='neutral'>        return toHexString(uint256(uint160(addr)), _ADDRESS_LENGTH);</span>
 77 |     | <span class='neutral'>    }</span>
 78 |     | <span class='neutral'></span>
 79 |     | <span class='neutral'>    /**</span>
 80 |     | <span class='neutral'>     * @dev Returns true if the two strings are equal.</span>
 81 |     | <span class='neutral'>     */</span>
 82 |     | <span class='neutral'>    function equal(string memory a, string memory b) internal pure returns (bool) {</span>
 83 |     | <span class='neutral'>        return keccak256(bytes(a)) == keccak256(bytes(b));</span>
 84 |     | <span class='neutral'>    }</span>
 85 |     | <span class='neutral'>}</span>
 86 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/cryptography/ECDSA.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../Strings.sol&quot;;</span>
   7 |     | <span class='neutral'></span>
   8 |     | <span class='neutral'>/**</span>
   9 |     | <span class='neutral'> * @dev Elliptic Curve Digital Signature Algorithm (ECDSA) operations.</span>
  10 |     | <span class='neutral'> *</span>
  11 |     | <span class='neutral'> * These functions can be used to verify that a message was signed by the holder</span>
  12 |     | <span class='neutral'> * of the private keys of a given address.</span>
  13 |     | <span class='neutral'> */</span>
  14 |     | <span class='unexecuted'>library ECDSA {</span>
  15 |     | <span class='neutral'>    enum RecoverError {</span>
  16 |     | <span class='neutral'>        NoError,</span>
  17 |     | <span class='neutral'>        InvalidSignature,</span>
  18 |     | <span class='neutral'>        InvalidSignatureLength,</span>
  19 |     | <span class='neutral'>        InvalidSignatureS,</span>
  20 |     | <span class='neutral'>        InvalidSignatureV // Deprecated in v4.8</span>
  21 |     | <span class='neutral'>    }</span>
  22 |     | <span class='neutral'></span>
  23 |     | <span class='unexecuted'>    function _throwError(RecoverError error) private pure {</span>
  24 |     | <span class='unexecuted'>        if (error == RecoverError.NoError) {</span>
  25 |     | <span class='neutral'>            return; // no error: do nothing</span>
  26 |     | <span class='unexecuted'>        } else if (error == RecoverError.InvalidSignature) {</span>
  27 |     | <span class='unexecuted'>            revert(&quot;ECDSA: invalid signature&quot;);</span>
  28 |     | <span class='unexecuted'>        } else if (error == RecoverError.InvalidSignatureLength) {</span>
  29 |     | <span class='unexecuted'>            revert(&quot;ECDSA: invalid signature length&quot;);</span>
  30 |     | <span class='unexecuted'>        } else if (error == RecoverError.InvalidSignatureS) {</span>
  31 |     | <span class='unexecuted'>            revert(&quot;ECDSA: invalid signature &#39;s&#39; value&quot;);</span>
  32 |     | <span class='neutral'>        }</span>
  33 |     | <span class='neutral'>    }</span>
  34 |     | <span class='neutral'></span>
  35 |     | <span class='neutral'>    /**</span>
  36 |     | <span class='neutral'>     * @dev Returns the address that signed a hashed message (`hash`) with</span>
  37 |     | <span class='neutral'>     * `signature` or error string. This address can then be used for verification purposes.</span>
  38 |     | <span class='neutral'>     *</span>
  39 |     | <span class='neutral'>     * The `ecrecover` EVM opcode allows for malleable (non-unique) signatures:</span>
  40 |     | <span class='neutral'>     * this function rejects them by requiring the `s` value to be in the lower</span>
  41 |     | <span class='neutral'>     * half order, and the `v` value to be either 27 or 28.</span>
  42 |     | <span class='neutral'>     *</span>
  43 |     | <span class='neutral'>     * IMPORTANT: `hash` _must_ be the result of a hash operation for the</span>
  44 |     | <span class='neutral'>     * verification to be secure: it is possible to craft signatures that</span>
  45 |     | <span class='neutral'>     * recover to arbitrary addresses for non-hashed data. A safe way to ensure</span>
  46 |     | <span class='neutral'>     * this is by receiving a hash of the original message (which may otherwise</span>
  47 |     | <span class='neutral'>     * be too long), and then calling {toEthSignedMessageHash} on it.</span>
  48 |     | <span class='neutral'>     *</span>
  49 |     | <span class='neutral'>     * Documentation for signature generation:</span>
  50 |     | <span class='neutral'>     * - with https://web3js.readthedocs.io/en/v1.3.4/web3-eth-accounts.html#sign[Web3.js]</span>
  51 |     | <span class='neutral'>     * - with https://docs.ethers.io/v5/api/signer/#Signer-signMessage[ethers]</span>
  52 |     | <span class='neutral'>     *</span>
  53 |     | <span class='neutral'>     * _Available since v4.3._</span>
  54 |     | <span class='neutral'>     */</span>
  55 |     | <span class='neutral'>    function tryRecover(bytes32 hash, bytes memory signature) internal pure returns (address, RecoverError) {</span>
  56 |     | <span class='neutral'>        if (signature.length == 65) {</span>
  57 |     | <span class='neutral'>            bytes32 r;</span>
  58 |     | <span class='neutral'>            bytes32 s;</span>
  59 |     | <span class='neutral'>            uint8 v;</span>
  60 |     | <span class='neutral'>            // ecrecover takes the signature parameters, and the only way to get them</span>
  61 |     | <span class='neutral'>            // currently is to use assembly.</span>
  62 |     | <span class='neutral'>            /// @solidity memory-safe-assembly</span>
  63 |     | <span class='neutral'>            assembly {</span>
  64 |     | <span class='neutral'>                r := mload(add(signature, 0x20))</span>
  65 |     | <span class='neutral'>                s := mload(add(signature, 0x40))</span>
  66 |     | <span class='neutral'>                v := byte(0, mload(add(signature, 0x60)))</span>
  67 |     | <span class='neutral'>            }</span>
  68 |     | <span class='neutral'>            return tryRecover(hash, v, r, s);</span>
  69 |     | <span class='neutral'>        } else {</span>
  70 |     | <span class='neutral'>            return (address(0), RecoverError.InvalidSignatureLength);</span>
  71 |     | <span class='neutral'>        }</span>
  72 |     | <span class='neutral'>    }</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='neutral'>    /**</span>
  75 |     | <span class='neutral'>     * @dev Returns the address that signed a hashed message (`hash`) with</span>
  76 |     | <span class='neutral'>     * `signature`. This address can then be used for verification purposes.</span>
  77 |     | <span class='neutral'>     *</span>
  78 |     | <span class='neutral'>     * The `ecrecover` EVM opcode allows for malleable (non-unique) signatures:</span>
  79 |     | <span class='neutral'>     * this function rejects them by requiring the `s` value to be in the lower</span>
  80 |     | <span class='neutral'>     * half order, and the `v` value to be either 27 or 28.</span>
  81 |     | <span class='neutral'>     *</span>
  82 |     | <span class='neutral'>     * IMPORTANT: `hash` _must_ be the result of a hash operation for the</span>
  83 |     | <span class='neutral'>     * verification to be secure: it is possible to craft signatures that</span>
  84 |     | <span class='neutral'>     * recover to arbitrary addresses for non-hashed data. A safe way to ensure</span>
  85 |     | <span class='neutral'>     * this is by receiving a hash of the original message (which may otherwise</span>
  86 |     | <span class='neutral'>     * be too long), and then calling {toEthSignedMessageHash} on it.</span>
  87 |     | <span class='neutral'>     */</span>
  88 |     | <span class='neutral'>    function recover(bytes32 hash, bytes memory signature) internal pure returns (address) {</span>
  89 |     | <span class='neutral'>        (address recovered, RecoverError error) = tryRecover(hash, signature);</span>
  90 |     | <span class='neutral'>        _throwError(error);</span>
  91 |     | <span class='neutral'>        return recovered;</span>
  92 |     | <span class='neutral'>    }</span>
  93 |     | <span class='neutral'></span>
  94 |     | <span class='neutral'>    /**</span>
  95 |     | <span class='neutral'>     * @dev Overload of {ECDSA-tryRecover} that receives the `r` and `vs` short-signature fields separately.</span>
  96 |     | <span class='neutral'>     *</span>
  97 |     | <span class='neutral'>     * See https://eips.ethereum.org/EIPS/eip-2098[EIP-2098 short signatures]</span>
  98 |     | <span class='neutral'>     *</span>
  99 |     | <span class='neutral'>     * _Available since v4.3._</span>
 100 |     | <span class='neutral'>     */</span>
 101 |     | <span class='neutral'>    function tryRecover(bytes32 hash, bytes32 r, bytes32 vs) internal pure returns (address, RecoverError) {</span>
 102 |     | <span class='neutral'>        bytes32 s = vs &amp; bytes32(0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff);</span>
 103 |     | <span class='neutral'>        uint8 v = uint8((uint256(vs) &gt;&gt; 255) + 27);</span>
 104 |     | <span class='neutral'>        return tryRecover(hash, v, r, s);</span>
 105 |     | <span class='neutral'>    }</span>
 106 |     | <span class='neutral'></span>
 107 |     | <span class='neutral'>    /**</span>
 108 |     | <span class='neutral'>     * @dev Overload of {ECDSA-recover} that receives the `r and `vs` short-signature fields separately.</span>
 109 |     | <span class='neutral'>     *</span>
 110 |     | <span class='neutral'>     * _Available since v4.2._</span>
 111 |     | <span class='neutral'>     */</span>
 112 |     | <span class='neutral'>    function recover(bytes32 hash, bytes32 r, bytes32 vs) internal pure returns (address) {</span>
 113 |     | <span class='neutral'>        (address recovered, RecoverError error) = tryRecover(hash, r, vs);</span>
 114 |     | <span class='neutral'>        _throwError(error);</span>
 115 |     | <span class='neutral'>        return recovered;</span>
 116 |     | <span class='neutral'>    }</span>
 117 |     | <span class='neutral'></span>
 118 |     | <span class='neutral'>    /**</span>
 119 |     | <span class='neutral'>     * @dev Overload of {ECDSA-tryRecover} that receives the `v`,</span>
 120 |     | <span class='neutral'>     * `r` and `s` signature fields separately.</span>
 121 |     | <span class='neutral'>     *</span>
 122 |     | <span class='neutral'>     * _Available since v4.3._</span>
 123 |     | <span class='neutral'>     */</span>
 124 |     | <span class='unexecuted'>    function tryRecover(bytes32 hash, uint8 v, bytes32 r, bytes32 s) internal pure returns (address, RecoverError) {</span>
 125 |     | <span class='neutral'>        // EIP-2 still allows signature malleability for ecrecover(). Remove this possibility and make the signature</span>
 126 |     | <span class='neutral'>        // unique. Appendix F in the Ethereum Yellow paper (https://ethereum.github.io/yellowpaper/paper.pdf), defines</span>
 127 |     | <span class='neutral'>        // the valid range for s in (301): 0 &lt; s &lt; secp256k1n  2 + 1, and for v in (302): v  {27, 28}. Most</span>
 128 |     | <span class='neutral'>        // signatures from current libraries generate a unique signature with an s-value in the lower half order.</span>
 129 |     | <span class='neutral'>        //</span>
 130 |     | <span class='neutral'>        // If your library generates malleable signatures, such as s-values in the upper range, calculate a new s-value</span>
 131 |     | <span class='neutral'>        // with 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141 - s1 and flip v from 27 to 28 or</span>
 132 |     | <span class='neutral'>        // vice versa. If your library also generates signatures with 0/1 for v instead 27/28, add 27 to v to accept</span>
 133 |     | <span class='neutral'>        // these malleable signatures as well.</span>
 134 |     | <span class='unexecuted'>        if (uint256(s) &gt; 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0) {</span>
 135 |     | <span class='unexecuted'>            return (address(0), RecoverError.InvalidSignatureS);</span>
 136 |     | <span class='neutral'>        }</span>
 137 |     | <span class='neutral'></span>
 138 |     | <span class='neutral'>        // If the signature is valid (and not malleable), return the signer address</span>
 139 |     | <span class='unexecuted'>        address signer = ecrecover(hash, v, r, s);</span>
 140 |     | <span class='unexecuted'>        if (signer == address(0)) {</span>
 141 |     | <span class='unexecuted'>            return (address(0), RecoverError.InvalidSignature);</span>
 142 |     | <span class='neutral'>        }</span>
 143 |     | <span class='neutral'></span>
 144 |     | <span class='unexecuted'>        return (signer, RecoverError.NoError);</span>
 145 |     | <span class='neutral'>    }</span>
 146 |     | <span class='neutral'></span>
 147 |     | <span class='neutral'>    /**</span>
 148 |     | <span class='neutral'>     * @dev Overload of {ECDSA-recover} that receives the `v`,</span>
 149 |     | <span class='neutral'>     * `r` and `s` signature fields separately.</span>
 150 |     | <span class='neutral'>     */</span>
 151 |     | <span class='unexecuted'>    function recover(bytes32 hash, uint8 v, bytes32 r, bytes32 s) internal pure returns (address) {</span>
 152 |     | <span class='unexecuted'>        (address recovered, RecoverError error) = tryRecover(hash, v, r, s);</span>
 153 |     | <span class='unexecuted'>        _throwError(error);</span>
 154 |     | <span class='unexecuted'>        return recovered;</span>
 155 |     | <span class='neutral'>    }</span>
 156 |     | <span class='neutral'></span>
 157 |     | <span class='neutral'>    /**</span>
 158 |     | <span class='neutral'>     * @dev Returns an Ethereum Signed Message, created from a `hash`. This</span>
 159 |     | <span class='neutral'>     * produces hash corresponding to the one signed with the</span>
 160 |     | <span class='neutral'>     * https://eth.wiki/json-rpc/API#eth_sign[`eth_sign`]</span>
 161 |     | <span class='neutral'>     * JSON-RPC method as part of EIP-191.</span>
 162 |     | <span class='neutral'>     *</span>
 163 |     | <span class='neutral'>     * See {recover}.</span>
 164 |     | <span class='neutral'>     */</span>
 165 |     | <span class='neutral'>    function toEthSignedMessageHash(bytes32 hash) internal pure returns (bytes32 message) {</span>
 166 |     | <span class='neutral'>        // 32 is the length in bytes of hash,</span>
 167 |     | <span class='neutral'>        // enforced by the type signature above</span>
 168 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 169 |     | <span class='neutral'>        assembly {</span>
 170 |     | <span class='neutral'>            mstore(0x00, &quot;\x19Ethereum Signed Message:\n32&quot;)</span>
 171 |     | <span class='neutral'>            mstore(0x1c, hash)</span>
 172 |     | <span class='neutral'>            message := keccak256(0x00, 0x3c)</span>
 173 |     | <span class='neutral'>        }</span>
 174 |     | <span class='neutral'>    }</span>
 175 |     | <span class='neutral'></span>
 176 |     | <span class='neutral'>    /**</span>
 177 |     | <span class='neutral'>     * @dev Returns an Ethereum Signed Message, created from `s`. This</span>
 178 |     | <span class='neutral'>     * produces hash corresponding to the one signed with the</span>
 179 |     | <span class='neutral'>     * https://eth.wiki/json-rpc/API#eth_sign[`eth_sign`]</span>
 180 |     | <span class='neutral'>     * JSON-RPC method as part of EIP-191.</span>
 181 |     | <span class='neutral'>     *</span>
 182 |     | <span class='neutral'>     * See {recover}.</span>
 183 |     | <span class='neutral'>     */</span>
 184 |     | <span class='neutral'>    function toEthSignedMessageHash(bytes memory s) internal pure returns (bytes32) {</span>
 185 |     | <span class='neutral'>        return keccak256(abi.encodePacked(&quot;\x19Ethereum Signed Message:\n&quot;, Strings.toString(s.length), s));</span>
 186 |     | <span class='neutral'>    }</span>
 187 |     | <span class='neutral'></span>
 188 |     | <span class='neutral'>    /**</span>
 189 |     | <span class='neutral'>     * @dev Returns an Ethereum Signed Typed Data, created from a</span>
 190 |     | <span class='neutral'>     * `domainSeparator` and a `structHash`. This produces hash corresponding</span>
 191 |     | <span class='neutral'>     * to the one signed with the</span>
 192 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-712[`eth_signTypedData`]</span>
 193 |     | <span class='neutral'>     * JSON-RPC method as part of EIP-712.</span>
 194 |     | <span class='neutral'>     *</span>
 195 |     | <span class='neutral'>     * See {recover}.</span>
 196 |     | <span class='neutral'>     */</span>
 197 |     | <span class='unexecuted'>    function toTypedDataHash(bytes32 domainSeparator, bytes32 structHash) internal pure returns (bytes32 data) {</span>
 198 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 199 |     | <span class='neutral'>        assembly {</span>
 200 |     | <span class='unexecuted'>            let ptr := mload(0x40)</span>
 201 |     | <span class='unexecuted'>            mstore(ptr, &quot;\x19\x01&quot;)</span>
 202 |     | <span class='unexecuted'>            mstore(add(ptr, 0x02), domainSeparator)</span>
 203 |     | <span class='unexecuted'>            mstore(add(ptr, 0x22), structHash)</span>
 204 |     | <span class='unexecuted'>            data := keccak256(ptr, 0x42)</span>
 205 |     | <span class='neutral'>        }</span>
 206 |     | <span class='neutral'>    }</span>
 207 |     | <span class='neutral'></span>
 208 |     | <span class='neutral'>    /**</span>
 209 |     | <span class='neutral'>     * @dev Returns an Ethereum Signed Data with intended validator, created from a</span>
 210 |     | <span class='neutral'>     * `validator` and `data` according to the version 0 of EIP-191.</span>
 211 |     | <span class='neutral'>     *</span>
 212 |     | <span class='neutral'>     * See {recover}.</span>
 213 |     | <span class='neutral'>     */</span>
 214 |     | <span class='neutral'>    function toDataWithIntendedValidatorHash(address validator, bytes memory data) internal pure returns (bytes32) {</span>
 215 |     | <span class='neutral'>        return keccak256(abi.encodePacked(&quot;\x19\x00&quot;, validator, data));</span>
 216 |     | <span class='neutral'>    }</span>
 217 |     | <span class='neutral'>}</span>
 218 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/cryptography/EIP712.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/cryptography/EIP712.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.8;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./ECDSA.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../ShortStrings.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../../interfaces/IERC5267.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @dev https://eips.ethereum.org/EIPS/eip-712[EIP 712] is a standard for hashing and signing of typed structured data.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * The encoding specified in the EIP is very generic, and such a generic implementation in Solidity is not feasible,</span>
  14 |     | <span class='neutral'> * thus this contract does not implement the encoding itself. Protocols need to implement the type-specific encoding</span>
  15 |     | <span class='neutral'> * they need in their contracts using a combination of `abi.encode` and `keccak256`.</span>
  16 |     | <span class='neutral'> *</span>
  17 |     | <span class='neutral'> * This contract implements the EIP 712 domain separator ({_domainSeparatorV4}) that is used as part of the encoding</span>
  18 |     | <span class='neutral'> * scheme, and the final step of the encoding to obtain the message digest that is then signed via ECDSA</span>
  19 |     | <span class='neutral'> * ({_hashTypedDataV4}).</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> * The implementation of the domain separator was designed to be as efficient as possible while still properly updating</span>
  22 |     | <span class='neutral'> * the chain id to protect against replay attacks on an eventual fork of the chain.</span>
  23 |     | <span class='neutral'> *</span>
  24 |     | <span class='neutral'> * NOTE: This contract implements the version of the encoding known as &quot;v4&quot;, as implemented by the JSON RPC method</span>
  25 |     | <span class='neutral'> * https://docs.metamask.io/guide/signing-data.html[`eth_signTypedDataV4` in MetaMask].</span>
  26 |     | <span class='neutral'> *</span>
  27 |     | <span class='neutral'> * NOTE: In the upgradeable version of this contract, the cached values will correspond to the address, and the domain</span>
  28 |     | <span class='neutral'> * separator of the implementation contract. This will cause the `_domainSeparatorV4` function to always rebuild the</span>
  29 |     | <span class='neutral'> * separator from the immutable values, which is cheaper than accessing a cached version in cold storage.</span>
  30 |     | <span class='neutral'> *</span>
  31 |     | <span class='neutral'> * _Available since v3.4._</span>
  32 |     | <span class='neutral'> *</span>
  33 |     | <span class='neutral'> * @custom:oz-upgrades-unsafe-allow state-variable-immutable state-variable-assignment</span>
  34 |     | <span class='neutral'> */</span>
  35 |     | <span class='neutral'>abstract contract EIP712 is IERC5267 {</span>
  36 |     | <span class='neutral'>    using ShortStrings for *;</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    bytes32 private constant _TYPE_HASH =</span>
  39 |     | <span class='unexecuted'>        keccak256(&quot;EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)&quot;);</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>    // Cache the domain separator as an immutable value, but also store the chain id that it corresponds to, in order to</span>
  42 |     | <span class='neutral'>    // invalidate the cached domain separator if the chain id changes.</span>
  43 |     | <span class='neutral'>    bytes32 private immutable _cachedDomainSeparator;</span>
  44 |     | <span class='neutral'>    uint256 private immutable _cachedChainId;</span>
  45 |     | <span class='neutral'>    address private immutable _cachedThis;</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    bytes32 private immutable _hashedName;</span>
  48 |     | <span class='neutral'>    bytes32 private immutable _hashedVersion;</span>
  49 |     | <span class='neutral'></span>
  50 |     | <span class='neutral'>    ShortString private immutable _name;</span>
  51 |     | <span class='neutral'>    ShortString private immutable _version;</span>
  52 |     | <span class='neutral'>    string private _nameFallback;</span>
  53 |     | <span class='neutral'>    string private _versionFallback;</span>
  54 |     | <span class='neutral'></span>
  55 |     | <span class='neutral'>    /**</span>
  56 |     | <span class='neutral'>     * @dev Initializes the domain separator and parameter caches.</span>
  57 |     | <span class='neutral'>     *</span>
  58 |     | <span class='neutral'>     * The meaning of `name` and `version` is specified in</span>
  59 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-712#definition-of-domainseparator[EIP 712]:</span>
  60 |     | <span class='neutral'>     *</span>
  61 |     | <span class='neutral'>     * - `name`: the user readable name of the signing domain, i.e. the name of the DApp or the protocol.</span>
  62 |     | <span class='neutral'>     * - `version`: the current major version of the signing domain.</span>
  63 |     | <span class='neutral'>     *</span>
  64 |     | <span class='neutral'>     * NOTE: These parameters cannot be changed except through a xref:learn::upgrading-smart-contracts.adoc[smart</span>
  65 |     | <span class='neutral'>     * contract upgrade].</span>
  66 |     | <span class='neutral'>     */</span>
  67 |     | <span class='unexecuted'>    constructor(string memory name, string memory version) {</span>
  68 |     | <span class='unexecuted'>        _name = name.toShortStringWithFallback(_nameFallback);</span>
  69 |     | <span class='unexecuted'>        _version = version.toShortStringWithFallback(_versionFallback);</span>
  70 |     | <span class='unexecuted'>        _hashedName = keccak256(bytes(name));</span>
  71 |     | <span class='unexecuted'>        _hashedVersion = keccak256(bytes(version));</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='unexecuted'>        _cachedChainId = block.chainid;</span>
  74 |     | <span class='unexecuted'>        _cachedDomainSeparator = _buildDomainSeparator();</span>
  75 |     | <span class='unexecuted'>        _cachedThis = address(this);</span>
  76 |     | <span class='neutral'>    }</span>
  77 |     | <span class='neutral'></span>
  78 |     | <span class='neutral'>    /**</span>
  79 |     | <span class='neutral'>     * @dev Returns the domain separator for the current chain.</span>
  80 |     | <span class='neutral'>     */</span>
  81 |     | <span class='unexecuted'>    function _domainSeparatorV4() internal view returns (bytes32) {</span>
  82 |     | <span class='unexecuted'>        if (address(this) == _cachedThis &amp;&amp; block.chainid == _cachedChainId) {</span>
  83 |     | <span class='unexecuted'>            return _cachedDomainSeparator;</span>
  84 |     | <span class='neutral'>        } else {</span>
  85 |     | <span class='unexecuted'>            return _buildDomainSeparator();</span>
  86 |     | <span class='neutral'>        }</span>
  87 |     | <span class='neutral'>    }</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='unexecuted'>    function _buildDomainSeparator() private view returns (bytes32) {</span>
  90 |     | <span class='unexecuted'>        return keccak256(abi.encode(_TYPE_HASH, _hashedName, _hashedVersion, block.chainid, address(this)));</span>
  91 |     | <span class='neutral'>    }</span>
  92 |     | <span class='neutral'></span>
  93 |     | <span class='neutral'>    /**</span>
  94 |     | <span class='neutral'>     * @dev Given an already https://eips.ethereum.org/EIPS/eip-712#definition-of-hashstruct[hashed struct], this</span>
  95 |     | <span class='neutral'>     * function returns the hash of the fully encoded EIP712 message for this domain.</span>
  96 |     | <span class='neutral'>     *</span>
  97 |     | <span class='neutral'>     * This hash can be used together with {ECDSA-recover} to obtain the signer of a message. For example:</span>
  98 |     | <span class='neutral'>     *</span>
  99 |     | <span class='neutral'>     * ```solidity</span>
 100 |     | <span class='neutral'>     * bytes32 digest = _hashTypedDataV4(keccak256(abi.encode(</span>
 101 |     | <span class='neutral'>     *     keccak256(&quot;Mail(address to,string contents)&quot;),</span>
 102 |     | <span class='neutral'>     *     mailTo,</span>
 103 |     | <span class='neutral'>     *     keccak256(bytes(mailContents))</span>
 104 |     | <span class='neutral'>     * )));</span>
 105 |     | <span class='neutral'>     * address signer = ECDSA.recover(digest, signature);</span>
 106 |     | <span class='neutral'>     * ```</span>
 107 |     | <span class='neutral'>     */</span>
 108 |     | <span class='unexecuted'>    function _hashTypedDataV4(bytes32 structHash) internal view virtual returns (bytes32) {</span>
 109 |     | <span class='unexecuted'>        return ECDSA.toTypedDataHash(_domainSeparatorV4(), structHash);</span>
 110 |     | <span class='neutral'>    }</span>
 111 |     | <span class='neutral'></span>
 112 |     | <span class='neutral'>    /**</span>
 113 |     | <span class='neutral'>     * @dev See {EIP-5267}.</span>
 114 |     | <span class='neutral'>     *</span>
 115 |     | <span class='neutral'>     * _Available since v4.9._</span>
 116 |     | <span class='neutral'>     */</span>
 117 |     | <span class='unexecuted'>    function eip712Domain()</span>
 118 |     | <span class='neutral'>        public</span>
 119 |     | <span class='neutral'>        view</span>
 120 |     | <span class='neutral'>        virtual</span>
 121 |     | <span class='neutral'>        override</span>
 122 |     | <span class='neutral'>        returns (</span>
 123 |     | <span class='unexecuted'>            bytes1 fields,</span>
 124 |     | <span class='unexecuted'>            string memory name,</span>
 125 |     | <span class='neutral'>            string memory version,</span>
 126 |     | <span class='neutral'>            uint256 chainId,</span>
 127 |     | <span class='neutral'>            address verifyingContract,</span>
 128 |     | <span class='neutral'>            bytes32 salt,</span>
 129 |     | <span class='neutral'>            uint256[] memory extensions</span>
 130 |     | <span class='neutral'>        )</span>
 131 |     | <span class='neutral'>    {</span>
 132 |     | <span class='unexecuted'>        return (</span>
 133 |     | <span class='neutral'>            hex&quot;0f&quot;, // 01111</span>
 134 |     | <span class='unexecuted'>            _name.toStringWithFallback(_nameFallback),</span>
 135 |     | <span class='unexecuted'>            _version.toStringWithFallback(_versionFallback),</span>
 136 |     | <span class='unexecuted'>            block.chainid,</span>
 137 |     | <span class='unexecuted'>            address(this),</span>
 138 |     | <span class='unexecuted'>            bytes32(0),</span>
 139 |     | <span class='unexecuted'>            new uint256[](0)</span>
 140 |     | <span class='neutral'>        );</span>
 141 |     | <span class='neutral'>    }</span>
 142 |     | <span class='neutral'>}</span>
 143 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/introspection/ERC165.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/introspection/ERC165.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./IERC165.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Implementation of the {IERC165} interface.</span>
 10 |     | <span class='neutral'> *</span>
 11 |     | <span class='neutral'> * Contracts that want to implement ERC165 should inherit from this contract and override {supportsInterface} to check</span>
 12 |     | <span class='neutral'> * for the additional interface id that will be supported. For example:</span>
 13 |     | <span class='neutral'> *</span>
 14 |     | <span class='neutral'> * ```solidity</span>
 15 |     | <span class='neutral'> * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 16 |     | <span class='neutral'> *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);</span>
 17 |     | <span class='neutral'> * }</span>
 18 |     | <span class='neutral'> * ```</span>
 19 |     | <span class='neutral'> *</span>
 20 |     | <span class='neutral'> * Alternatively, {ERC165Storage} provides an easier to use but more expensive implementation.</span>
 21 |     | <span class='neutral'> */</span>
 22 |     | <span class='neutral'>abstract contract ERC165 is IERC165 {</span>
 23 |     | <span class='neutral'>    /**</span>
 24 |     | <span class='neutral'>     * @dev See {IERC165-supportsInterface}.</span>
 25 |     | <span class='neutral'>     */</span>
 26 |     | <span class='unexecuted'>    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 27 |     | <span class='unexecuted'>        return interfaceId == type(IERC165).interfaceId;</span>
 28 |     | <span class='neutral'>    }</span>
 29 |     | <span class='neutral'>}</span>
 30 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/introspection/IERC165.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/introspection/IERC165.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC165 standard, as defined in the</span>
  8 |     | <span class='neutral'> * https://eips.ethereum.org/EIPS/eip-165[EIP].</span>
  9 |     | <span class='neutral'> *</span>
 10 |     | <span class='neutral'> * Implementers can declare support of contract interfaces, which can then be</span>
 11 |     | <span class='neutral'> * queried by others ({ERC165Checker}).</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> * For an implementation, see {ERC165}.</span>
 14 |     | <span class='neutral'> */</span>
 15 |     | <span class='neutral'>interface IERC165 {</span>
 16 |     | <span class='neutral'>    /**</span>
 17 |     | <span class='neutral'>     * @dev Returns true if this contract implements the interface defined by</span>
 18 |     | <span class='neutral'>     * `interfaceId`. See the corresponding</span>
 19 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[EIP section]</span>
 20 |     | <span class='neutral'>     * to learn more about how these ids are created.</span>
 21 |     | <span class='neutral'>     *</span>
 22 |     | <span class='neutral'>     * This function call must use less than 30 000 gas.</span>
 23 |     | <span class='neutral'>     */</span>
 24 |     | <span class='neutral'>    function supportsInterface(bytes4 interfaceId) external view returns (bool);</span>
 25 |     | <span class='neutral'>}</span>
 26 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/math/Math.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/math/Math.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>/**</span>
   7 |     | <span class='neutral'> * @dev Standard math utilities missing in the Solidity language.</span>
   8 |     | <span class='neutral'> */</span>
   9 |     | <span class='unexecuted'>library Math {</span>
  10 |     | <span class='neutral'>    enum Rounding {</span>
  11 |     | <span class='neutral'>        Down, // Toward negative infinity</span>
  12 |     | <span class='neutral'>        Up, // Toward infinity</span>
  13 |     | <span class='neutral'>        Zero // Toward zero</span>
  14 |     | <span class='neutral'>    }</span>
  15 |     | <span class='neutral'></span>
  16 |     | <span class='neutral'>    /**</span>
  17 |     | <span class='neutral'>     * @dev Returns the largest of two numbers.</span>
  18 |     | <span class='neutral'>     */</span>
  19 |     | <span class='neutral'>    function max(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  20 |     | <span class='neutral'>        return a &gt; b ? a : b;</span>
  21 |     | <span class='neutral'>    }</span>
  22 |     | <span class='neutral'></span>
  23 |     | <span class='neutral'>    /**</span>
  24 |     | <span class='neutral'>     * @dev Returns the smallest of two numbers.</span>
  25 |     | <span class='neutral'>     */</span>
  26 |     | <span class='neutral'>    function min(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  27 |     | <span class='neutral'>        return a &lt; b ? a : b;</span>
  28 |     | <span class='neutral'>    }</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    /**</span>
  31 |     | <span class='neutral'>     * @dev Returns the average of two numbers. The result is rounded towards</span>
  32 |     | <span class='neutral'>     * zero.</span>
  33 |     | <span class='neutral'>     */</span>
  34 |     | <span class='neutral'>    function average(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  35 |     | <span class='neutral'>        // (a + b) / 2 can overflow.</span>
  36 |     | <span class='neutral'>        return (a &amp; b) + (a ^ b) / 2;</span>
  37 |     | <span class='neutral'>    }</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>    /**</span>
  40 |     | <span class='neutral'>     * @dev Returns the ceiling of the division of two numbers.</span>
  41 |     | <span class='neutral'>     *</span>
  42 |     | <span class='neutral'>     * This differs from standard division with `/` in that it rounds up instead</span>
  43 |     | <span class='neutral'>     * of rounding down.</span>
  44 |     | <span class='neutral'>     */</span>
  45 |     | <span class='neutral'>    function ceilDiv(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  46 |     | <span class='neutral'>        // (a + b - 1) / b can overflow on addition, so we distribute.</span>
  47 |     | <span class='neutral'>        return a == 0 ? 0 : (a - 1) / b + 1;</span>
  48 |     | <span class='neutral'>    }</span>
  49 |     | <span class='neutral'></span>
  50 |     | <span class='neutral'>    /**</span>
  51 |     | <span class='neutral'>     * @notice Calculates floor(x * y / denominator) with full precision. Throws if result overflows a uint256 or denominator == 0</span>
  52 |     | <span class='neutral'>     * @dev Original credit to Remco Bloemen under MIT license (https://xn--2-umb.com/21/muldiv)</span>
  53 |     | <span class='neutral'>     * with further edits by Uniswap Labs also under MIT license.</span>
  54 |     | <span class='neutral'>     */</span>
  55 |     | <span class='neutral'>    function mulDiv(uint256 x, uint256 y, uint256 denominator) internal pure returns (uint256 result) {</span>
  56 |     | <span class='neutral'>        unchecked {</span>
  57 |     | <span class='neutral'>            // 512-bit multiply [prod1 prod0] = x * y. Compute the product mod 2^256 and mod 2^256 - 1, then use</span>
  58 |     | <span class='neutral'>            // use the Chinese Remainder Theorem to reconstruct the 512 bit result. The result is stored in two 256</span>
  59 |     | <span class='neutral'>            // variables such that product = prod1 * 2^256 + prod0.</span>
  60 |     | <span class='neutral'>            uint256 prod0; // Least significant 256 bits of the product</span>
  61 |     | <span class='neutral'>            uint256 prod1; // Most significant 256 bits of the product</span>
  62 |     | <span class='neutral'>            assembly {</span>
  63 |     | <span class='neutral'>                let mm := mulmod(x, y, not(0))</span>
  64 |     | <span class='neutral'>                prod0 := mul(x, y)</span>
  65 |     | <span class='neutral'>                prod1 := sub(sub(mm, prod0), lt(mm, prod0))</span>
  66 |     | <span class='neutral'>            }</span>
  67 |     | <span class='neutral'></span>
  68 |     | <span class='neutral'>            // Handle non-overflow cases, 256 by 256 division.</span>
  69 |     | <span class='neutral'>            if (prod1 == 0) {</span>
  70 |     | <span class='neutral'>                // Solidity will revert if denominator == 0, unlike the div opcode on its own.</span>
  71 |     | <span class='neutral'>                // The surrounding unchecked block does not change this fact.</span>
  72 |     | <span class='neutral'>                // See https://docs.soliditylang.org/en/latest/control-structures.html#checked-or-unchecked-arithmetic.</span>
  73 |     | <span class='neutral'>                return prod0 / denominator;</span>
  74 |     | <span class='neutral'>            }</span>
  75 |     | <span class='neutral'></span>
  76 |     | <span class='neutral'>            // Make sure the result is less than 2^256. Also prevents denominator == 0.</span>
  77 |     | <span class='neutral'>            require(denominator &gt; prod1, &quot;Math: mulDiv overflow&quot;);</span>
  78 |     | <span class='neutral'></span>
  79 |     | <span class='neutral'>            ///////////////////////////////////////////////</span>
  80 |     | <span class='neutral'>            // 512 by 256 division.</span>
  81 |     | <span class='neutral'>            ///////////////////////////////////////////////</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>            // Make division exact by subtracting the remainder from [prod1 prod0].</span>
  84 |     | <span class='neutral'>            uint256 remainder;</span>
  85 |     | <span class='neutral'>            assembly {</span>
  86 |     | <span class='neutral'>                // Compute remainder using mulmod.</span>
  87 |     | <span class='neutral'>                remainder := mulmod(x, y, denominator)</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>                // Subtract 256 bit number from 512 bit number.</span>
  90 |     | <span class='neutral'>                prod1 := sub(prod1, gt(remainder, prod0))</span>
  91 |     | <span class='neutral'>                prod0 := sub(prod0, remainder)</span>
  92 |     | <span class='neutral'>            }</span>
  93 |     | <span class='neutral'></span>
  94 |     | <span class='neutral'>            // Factor powers of two out of denominator and compute largest power of two divisor of denominator. Always &gt;= 1.</span>
  95 |     | <span class='neutral'>            // See https://cs.stackexchange.com/q/138556/92363.</span>
  96 |     | <span class='neutral'></span>
  97 |     | <span class='neutral'>            // Does not overflow because the denominator cannot be zero at this stage in the function.</span>
  98 |     | <span class='neutral'>            uint256 twos = denominator &amp; (~denominator + 1);</span>
  99 |     | <span class='neutral'>            assembly {</span>
 100 |     | <span class='neutral'>                // Divide denominator by twos.</span>
 101 |     | <span class='neutral'>                denominator := div(denominator, twos)</span>
 102 |     | <span class='neutral'></span>
 103 |     | <span class='neutral'>                // Divide [prod1 prod0] by twos.</span>
 104 |     | <span class='neutral'>                prod0 := div(prod0, twos)</span>
 105 |     | <span class='neutral'></span>
 106 |     | <span class='neutral'>                // Flip twos such that it is 2^256 / twos. If twos is zero, then it becomes one.</span>
 107 |     | <span class='neutral'>                twos := add(div(sub(0, twos), twos), 1)</span>
 108 |     | <span class='neutral'>            }</span>
 109 |     | <span class='neutral'></span>
 110 |     | <span class='neutral'>            // Shift in bits from prod1 into prod0.</span>
 111 |     | <span class='neutral'>            prod0 |= prod1 * twos;</span>
 112 |     | <span class='neutral'></span>
 113 |     | <span class='neutral'>            // Invert denominator mod 2^256. Now that denominator is an odd number, it has an inverse modulo 2^256 such</span>
 114 |     | <span class='neutral'>            // that denominator * inv = 1 mod 2^256. Compute the inverse by starting with a seed that is correct for</span>
 115 |     | <span class='neutral'>            // four bits. That is, denominator * inv = 1 mod 2^4.</span>
 116 |     | <span class='neutral'>            uint256 inverse = (3 * denominator) ^ 2;</span>
 117 |     | <span class='neutral'></span>
 118 |     | <span class='neutral'>            // Use the Newton-Raphson iteration to improve the precision. Thanks to Hensel&#39;s lifting lemma, this also works</span>
 119 |     | <span class='neutral'>            // in modular arithmetic, doubling the correct bits in each step.</span>
 120 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^8</span>
 121 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^16</span>
 122 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^32</span>
 123 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^64</span>
 124 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^128</span>
 125 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^256</span>
 126 |     | <span class='neutral'></span>
 127 |     | <span class='neutral'>            // Because the division is now exact we can divide by multiplying with the modular inverse of denominator.</span>
 128 |     | <span class='neutral'>            // This will give us the correct result modulo 2^256. Since the preconditions guarantee that the outcome is</span>
 129 |     | <span class='neutral'>            // less than 2^256, this is the final result. We don&#39;t need to compute the high bits of the result and prod1</span>
 130 |     | <span class='neutral'>            // is no longer required.</span>
 131 |     | <span class='neutral'>            result = prod0 * inverse;</span>
 132 |     | <span class='neutral'>            return result;</span>
 133 |     | <span class='neutral'>        }</span>
 134 |     | <span class='neutral'>    }</span>
 135 |     | <span class='neutral'></span>
 136 |     | <span class='neutral'>    /**</span>
 137 |     | <span class='neutral'>     * @notice Calculates x * y / denominator with full precision, following the selected rounding direction.</span>
 138 |     | <span class='neutral'>     */</span>
 139 |     | <span class='neutral'>    function mulDiv(uint256 x, uint256 y, uint256 denominator, Rounding rounding) internal pure returns (uint256) {</span>
 140 |     | <span class='neutral'>        uint256 result = mulDiv(x, y, denominator);</span>
 141 |     | <span class='neutral'>        if (rounding == Rounding.Up &amp;&amp; mulmod(x, y, denominator) &gt; 0) {</span>
 142 |     | <span class='neutral'>            result += 1;</span>
 143 |     | <span class='neutral'>        }</span>
 144 |     | <span class='neutral'>        return result;</span>
 145 |     | <span class='neutral'>    }</span>
 146 |     | <span class='neutral'></span>
 147 |     | <span class='neutral'>    /**</span>
 148 |     | <span class='neutral'>     * @dev Returns the square root of a number. If the number is not a perfect square, the value is rounded down.</span>
 149 |     | <span class='neutral'>     *</span>
 150 |     | <span class='neutral'>     * Inspired by Henry S. Warren, Jr.&#39;s &quot;Hacker&#39;s Delight&quot; (Chapter 11).</span>
 151 |     | <span class='neutral'>     */</span>
 152 |     | <span class='neutral'>    function sqrt(uint256 a) internal pure returns (uint256) {</span>
 153 |     | <span class='neutral'>        if (a == 0) {</span>
 154 |     | <span class='neutral'>            return 0;</span>
 155 |     | <span class='neutral'>        }</span>
 156 |     | <span class='neutral'></span>
 157 |     | <span class='neutral'>        // For our first guess, we get the biggest power of 2 which is smaller than the square root of the target.</span>
 158 |     | <span class='neutral'>        //</span>
 159 |     | <span class='neutral'>        // We know that the &quot;msb&quot; (most significant bit) of our target number `a` is a power of 2 such that we have</span>
 160 |     | <span class='neutral'>        // `msb(a) &lt;= a &lt; 2*msb(a)`. This value can be written `msb(a)=2**k` with `k=log2(a)`.</span>
 161 |     | <span class='neutral'>        //</span>
 162 |     | <span class='neutral'>        // This can be rewritten `2**log2(a) &lt;= a &lt; 2**(log2(a) + 1)`</span>
 163 |     | <span class='neutral'>        //  `sqrt(2**k) &lt;= sqrt(a) &lt; sqrt(2**(k+1))`</span>
 164 |     | <span class='neutral'>        //  `2**(k/2) &lt;= sqrt(a) &lt; 2**((k+1)/2) &lt;= 2**(k/2 + 1)`</span>
 165 |     | <span class='neutral'>        //</span>
 166 |     | <span class='neutral'>        // Consequently, `2**(log2(a) / 2)` is a good first approximation of `sqrt(a)` with at least 1 correct bit.</span>
 167 |     | <span class='neutral'>        uint256 result = 1 &lt;&lt; (log2(a) &gt;&gt; 1);</span>
 168 |     | <span class='neutral'></span>
 169 |     | <span class='neutral'>        // At this point `result` is an estimation with one bit of precision. We know the true value is a uint128,</span>
 170 |     | <span class='neutral'>        // since it is the square root of a uint256. Newton&#39;s method converges quadratically (precision doubles at</span>
 171 |     | <span class='neutral'>        // every iteration). We thus need at most 7 iteration to turn our partial result with one bit of precision</span>
 172 |     | <span class='neutral'>        // into the expected uint128 result.</span>
 173 |     | <span class='neutral'>        unchecked {</span>
 174 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 175 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 176 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 177 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 178 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 179 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 180 |     | <span class='neutral'>            result = (result + a / result) &gt;&gt; 1;</span>
 181 |     | <span class='neutral'>            return min(result, a / result);</span>
 182 |     | <span class='neutral'>        }</span>
 183 |     | <span class='neutral'>    }</span>
 184 |     | <span class='neutral'></span>
 185 |     | <span class='neutral'>    /**</span>
 186 |     | <span class='neutral'>     * @notice Calculates sqrt(a), following the selected rounding direction.</span>
 187 |     | <span class='neutral'>     */</span>
 188 |     | <span class='neutral'>    function sqrt(uint256 a, Rounding rounding) internal pure returns (uint256) {</span>
 189 |     | <span class='neutral'>        unchecked {</span>
 190 |     | <span class='neutral'>            uint256 result = sqrt(a);</span>
 191 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; result * result &lt; a ? 1 : 0);</span>
 192 |     | <span class='neutral'>        }</span>
 193 |     | <span class='neutral'>    }</span>
 194 |     | <span class='neutral'></span>
 195 |     | <span class='neutral'>    /**</span>
 196 |     | <span class='neutral'>     * @dev Return the log in base 2, rounded down, of a positive value.</span>
 197 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 198 |     | <span class='neutral'>     */</span>
 199 |     | <span class='neutral'>    function log2(uint256 value) internal pure returns (uint256) {</span>
 200 |     | <span class='neutral'>        uint256 result = 0;</span>
 201 |     | <span class='neutral'>        unchecked {</span>
 202 |     | <span class='neutral'>            if (value &gt;&gt; 128 &gt; 0) {</span>
 203 |     | <span class='neutral'>                value &gt;&gt;= 128;</span>
 204 |     | <span class='neutral'>                result += 128;</span>
 205 |     | <span class='neutral'>            }</span>
 206 |     | <span class='neutral'>            if (value &gt;&gt; 64 &gt; 0) {</span>
 207 |     | <span class='neutral'>                value &gt;&gt;= 64;</span>
 208 |     | <span class='neutral'>                result += 64;</span>
 209 |     | <span class='neutral'>            }</span>
 210 |     | <span class='neutral'>            if (value &gt;&gt; 32 &gt; 0) {</span>
 211 |     | <span class='neutral'>                value &gt;&gt;= 32;</span>
 212 |     | <span class='neutral'>                result += 32;</span>
 213 |     | <span class='neutral'>            }</span>
 214 |     | <span class='neutral'>            if (value &gt;&gt; 16 &gt; 0) {</span>
 215 |     | <span class='neutral'>                value &gt;&gt;= 16;</span>
 216 |     | <span class='neutral'>                result += 16;</span>
 217 |     | <span class='neutral'>            }</span>
 218 |     | <span class='neutral'>            if (value &gt;&gt; 8 &gt; 0) {</span>
 219 |     | <span class='neutral'>                value &gt;&gt;= 8;</span>
 220 |     | <span class='neutral'>                result += 8;</span>
 221 |     | <span class='neutral'>            }</span>
 222 |     | <span class='neutral'>            if (value &gt;&gt; 4 &gt; 0) {</span>
 223 |     | <span class='neutral'>                value &gt;&gt;= 4;</span>
 224 |     | <span class='neutral'>                result += 4;</span>
 225 |     | <span class='neutral'>            }</span>
 226 |     | <span class='neutral'>            if (value &gt;&gt; 2 &gt; 0) {</span>
 227 |     | <span class='neutral'>                value &gt;&gt;= 2;</span>
 228 |     | <span class='neutral'>                result += 2;</span>
 229 |     | <span class='neutral'>            }</span>
 230 |     | <span class='neutral'>            if (value &gt;&gt; 1 &gt; 0) {</span>
 231 |     | <span class='neutral'>                result += 1;</span>
 232 |     | <span class='neutral'>            }</span>
 233 |     | <span class='neutral'>        }</span>
 234 |     | <span class='neutral'>        return result;</span>
 235 |     | <span class='neutral'>    }</span>
 236 |     | <span class='neutral'></span>
 237 |     | <span class='neutral'>    /**</span>
 238 |     | <span class='neutral'>     * @dev Return the log in base 2, following the selected rounding direction, of a positive value.</span>
 239 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 240 |     | <span class='neutral'>     */</span>
 241 |     | <span class='neutral'>    function log2(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 242 |     | <span class='neutral'>        unchecked {</span>
 243 |     | <span class='neutral'>            uint256 result = log2(value);</span>
 244 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; 1 &lt;&lt; result &lt; value ? 1 : 0);</span>
 245 |     | <span class='neutral'>        }</span>
 246 |     | <span class='neutral'>    }</span>
 247 |     | <span class='neutral'></span>
 248 |     | <span class='neutral'>    /**</span>
 249 |     | <span class='neutral'>     * @dev Return the log in base 10, rounded down, of a positive value.</span>
 250 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 251 |     | <span class='neutral'>     */</span>
 252 |     | <span class='unexecuted'>    function log10(uint256 value) internal pure returns (uint256) {</span>
 253 |     | <span class='neutral'>        uint256 result = 0;</span>
 254 |     | <span class='neutral'>        unchecked {</span>
 255 |     | <span class='unexecuted'>            if (value &gt;= 10 ** 64) {</span>
 256 |     | <span class='unexecuted'>                value /= 10 ** 64;</span>
 257 |     | <span class='unexecuted'>                result += 64;</span>
 258 |     | <span class='neutral'>            }</span>
 259 |     | <span class='unexecuted'>            if (value &gt;= 10 ** 32) {</span>
 260 |     | <span class='unexecuted'>                value /= 10 ** 32;</span>
 261 |     | <span class='unexecuted'>                result += 32;</span>
 262 |     | <span class='neutral'>            }</span>
 263 |     | <span class='unexecuted'>            if (value &gt;= 10 ** 16) {</span>
 264 |     | <span class='unexecuted'>                value /= 10 ** 16;</span>
 265 |     | <span class='unexecuted'>                result += 16;</span>
 266 |     | <span class='neutral'>            }</span>
 267 |     | <span class='unexecuted'>            if (value &gt;= 10 ** 8) {</span>
 268 |     | <span class='unexecuted'>                value /= 10 ** 8;</span>
 269 |     | <span class='unexecuted'>                result += 8;</span>
 270 |     | <span class='neutral'>            }</span>
 271 |     | <span class='unexecuted'>            if (value &gt;= 10 ** 4) {</span>
 272 |     | <span class='unexecuted'>                value /= 10 ** 4;</span>
 273 |     | <span class='unexecuted'>                result += 4;</span>
 274 |     | <span class='neutral'>            }</span>
 275 |     | <span class='unexecuted'>            if (value &gt;= 10 ** 2) {</span>
 276 |     | <span class='unexecuted'>                value /= 10 ** 2;</span>
 277 |     | <span class='unexecuted'>                result += 2;</span>
 278 |     | <span class='neutral'>            }</span>
 279 |     | <span class='unexecuted'>            if (value &gt;= 10 ** 1) {</span>
 280 |     | <span class='unexecuted'>                result += 1;</span>
 281 |     | <span class='neutral'>            }</span>
 282 |     | <span class='neutral'>        }</span>
 283 |     | <span class='unexecuted'>        return result;</span>
 284 |     | <span class='neutral'>    }</span>
 285 |     | <span class='neutral'></span>
 286 |     | <span class='neutral'>    /**</span>
 287 |     | <span class='neutral'>     * @dev Return the log in base 10, following the selected rounding direction, of a positive value.</span>
 288 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 289 |     | <span class='neutral'>     */</span>
 290 |     | <span class='neutral'>    function log10(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 291 |     | <span class='neutral'>        unchecked {</span>
 292 |     | <span class='neutral'>            uint256 result = log10(value);</span>
 293 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; 10 ** result &lt; value ? 1 : 0);</span>
 294 |     | <span class='neutral'>        }</span>
 295 |     | <span class='neutral'>    }</span>
 296 |     | <span class='neutral'></span>
 297 |     | <span class='neutral'>    /**</span>
 298 |     | <span class='neutral'>     * @dev Return the log in base 256, rounded down, of a positive value.</span>
 299 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 300 |     | <span class='neutral'>     *</span>
 301 |     | <span class='neutral'>     * Adding one to the result gives the number of pairs of hex symbols needed to represent `value` as a hex string.</span>
 302 |     | <span class='neutral'>     */</span>
 303 |     | <span class='neutral'>    function log256(uint256 value) internal pure returns (uint256) {</span>
 304 |     | <span class='neutral'>        uint256 result = 0;</span>
 305 |     | <span class='neutral'>        unchecked {</span>
 306 |     | <span class='neutral'>            if (value &gt;&gt; 128 &gt; 0) {</span>
 307 |     | <span class='neutral'>                value &gt;&gt;= 128;</span>
 308 |     | <span class='neutral'>                result += 16;</span>
 309 |     | <span class='neutral'>            }</span>
 310 |     | <span class='neutral'>            if (value &gt;&gt; 64 &gt; 0) {</span>
 311 |     | <span class='neutral'>                value &gt;&gt;= 64;</span>
 312 |     | <span class='neutral'>                result += 8;</span>
 313 |     | <span class='neutral'>            }</span>
 314 |     | <span class='neutral'>            if (value &gt;&gt; 32 &gt; 0) {</span>
 315 |     | <span class='neutral'>                value &gt;&gt;= 32;</span>
 316 |     | <span class='neutral'>                result += 4;</span>
 317 |     | <span class='neutral'>            }</span>
 318 |     | <span class='neutral'>            if (value &gt;&gt; 16 &gt; 0) {</span>
 319 |     | <span class='neutral'>                value &gt;&gt;= 16;</span>
 320 |     | <span class='neutral'>                result += 2;</span>
 321 |     | <span class='neutral'>            }</span>
 322 |     | <span class='neutral'>            if (value &gt;&gt; 8 &gt; 0) {</span>
 323 |     | <span class='neutral'>                result += 1;</span>
 324 |     | <span class='neutral'>            }</span>
 325 |     | <span class='neutral'>        }</span>
 326 |     | <span class='neutral'>        return result;</span>
 327 |     | <span class='neutral'>    }</span>
 328 |     | <span class='neutral'></span>
 329 |     | <span class='neutral'>    /**</span>
 330 |     | <span class='neutral'>     * @dev Return the log in base 256, following the selected rounding direction, of a positive value.</span>
 331 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 332 |     | <span class='neutral'>     */</span>
 333 |     | <span class='neutral'>    function log256(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 334 |     | <span class='neutral'>        unchecked {</span>
 335 |     | <span class='neutral'>            uint256 result = log256(value);</span>
 336 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; 1 &lt;&lt; (result &lt;&lt; 3) &lt; value ? 1 : 0);</span>
 337 |     | <span class='neutral'>        }</span>
 338 |     | <span class='neutral'>    }</span>
 339 |     | <span class='neutral'>}</span>
 340 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/lib/openzeppelin-contracts/contracts/utils/math/SignedMath.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/math/SignedMath.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Standard signed math utilities missing in the Solidity language.</span>
  8 |     | <span class='neutral'> */</span>
  9 |     | <span class='unexecuted'>library SignedMath {</span>
 10 |     | <span class='neutral'>    /**</span>
 11 |     | <span class='neutral'>     * @dev Returns the largest of two signed numbers.</span>
 12 |     | <span class='neutral'>     */</span>
 13 |     | <span class='neutral'>    function max(int256 a, int256 b) internal pure returns (int256) {</span>
 14 |     | <span class='neutral'>        return a &gt; b ? a : b;</span>
 15 |     | <span class='neutral'>    }</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    /**</span>
 18 |     | <span class='neutral'>     * @dev Returns the smallest of two signed numbers.</span>
 19 |     | <span class='neutral'>     */</span>
 20 |     | <span class='neutral'>    function min(int256 a, int256 b) internal pure returns (int256) {</span>
 21 |     | <span class='neutral'>        return a &lt; b ? a : b;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the average of two signed numbers without overflow.</span>
 26 |     | <span class='neutral'>     * The result is rounded towards zero.</span>
 27 |     | <span class='neutral'>     */</span>
 28 |     | <span class='neutral'>    function average(int256 a, int256 b) internal pure returns (int256) {</span>
 29 |     | <span class='neutral'>        // Formula from the book &quot;Hacker&#39;s Delight&quot;</span>
 30 |     | <span class='neutral'>        int256 x = (a &amp; b) + ((a ^ b) &gt;&gt; 1);</span>
 31 |     | <span class='neutral'>        return x + (int256(uint256(x) &gt;&gt; 255) &amp; (a ^ b));</span>
 32 |     | <span class='neutral'>    }</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    /**</span>
 35 |     | <span class='neutral'>     * @dev Returns the absolute unsigned value of a signed value.</span>
 36 |     | <span class='neutral'>     */</span>
 37 |     | <span class='neutral'>    function abs(int256 n) internal pure returns (uint256) {</span>
 38 |     | <span class='neutral'>        unchecked {</span>
 39 |     | <span class='neutral'>            // must be unchecked in order to support `n = type(int256).min`</span>
 40 |     | <span class='neutral'>            return uint256(n &gt;= 0 ? n : -n);</span>
 41 |     | <span class='neutral'>        }</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'>}</span>
 44 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/Echidna/Account.sol</b>
<code>
 1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
 2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
 3 |     | <span class='neutral'></span>
 4 |     | <span class='unexecuted'>contract Account {}</span>
 5 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/Echidna/Debugger.sol</b>
<code>
  1 |     | <span class='neutral'>/*</span>
  2 |     | <span class='neutral'>Original from https://github.com/perimetersec/drips-fuzzing/blob/main/src/echidna/tools/Debugger.sol</span>
  3 |     | <span class='neutral'>*/</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  6 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='unexecuted'>library Debugger {</span>
  9 |     | <span class='neutral'>    event Debug(string debugString);</span>
 10 |     | <span class='neutral'>    event Debug(string description, string data);</span>
 11 |     | <span class='neutral'>    event Debug(string prefix, string description, string data);</span>
 12 |     | <span class='neutral'>    event Debug(string description, bytes32 data);</span>
 13 |     | <span class='neutral'>    event Debug(string prefix, string description, bytes32 data);</span>
 14 |     | <span class='neutral'>    event Debug(string description, uint256 data);</span>
 15 |     | <span class='neutral'>    event Debug(string prefix, string description, uint256 data);</span>
 16 |     | <span class='neutral'>    event Debug(string description, int256 data);</span>
 17 |     | <span class='neutral'>    event Debug(string prefix, string description, int256 data);</span>
 18 |     | <span class='neutral'>    event Debug(string description, address data);</span>
 19 |     | <span class='neutral'>    event Debug(string prefix, string description, address data);</span>
 20 |     | <span class='neutral'>    event Debug(string description, bool data);</span>
 21 |     | <span class='neutral'>    event Debug(string prefix, string description, bool data);</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>    function log(string memory debugString) internal {</span>
 24 |     | <span class='neutral'>        emit Debug(debugString);</span>
 25 |     | <span class='neutral'>    }</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='neutral'>    function log(string memory description, string memory data) internal {</span>
 28 |     | <span class='neutral'>        emit Debug(description, data);</span>
 29 |     | <span class='neutral'>    }</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>    function log(</span>
 32 |     | <span class='neutral'>        string memory prefix,</span>
 33 |     | <span class='neutral'>        string memory description,</span>
 34 |     | <span class='neutral'>        string memory data</span>
 35 |     | <span class='neutral'>    ) internal {</span>
 36 |     | <span class='neutral'>        emit Debug(prefix, description, data);</span>
 37 |     | <span class='neutral'>    }</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='neutral'>    function log(string memory description, bytes32 data) internal {</span>
 40 |     | <span class='neutral'>        emit Debug(description, data);</span>
 41 |     | <span class='neutral'>    }</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='neutral'>    function log(</span>
 44 |     | <span class='neutral'>        string memory prefix,</span>
 45 |     | <span class='neutral'>        string memory description,</span>
 46 |     | <span class='neutral'>        bytes32 data</span>
 47 |     | <span class='neutral'>    ) internal {</span>
 48 |     | <span class='neutral'>        emit Debug(prefix, description, data);</span>
 49 |     | <span class='neutral'>    }</span>
 50 |     | <span class='neutral'></span>
 51 |     | <span class='neutral'>    function log(string memory description, uint256 data) internal {</span>
 52 |     | <span class='neutral'>        emit Debug(description, data);</span>
 53 |     | <span class='neutral'>    }</span>
 54 |     | <span class='neutral'></span>
 55 |     | <span class='neutral'>    function log(</span>
 56 |     | <span class='neutral'>        string memory prefix,</span>
 57 |     | <span class='neutral'>        string memory description,</span>
 58 |     | <span class='neutral'>        uint256 data</span>
 59 |     | <span class='neutral'>    ) internal {</span>
 60 |     | <span class='neutral'>        emit Debug(prefix, description, data);</span>
 61 |     | <span class='neutral'>    }</span>
 62 |     | <span class='neutral'></span>
 63 |     | <span class='neutral'>    function log(string memory description, int256 data) internal {</span>
 64 |     | <span class='neutral'>        emit Debug(description, data);</span>
 65 |     | <span class='neutral'>    }</span>
 66 |     | <span class='neutral'></span>
 67 |     | <span class='neutral'>    function log(</span>
 68 |     | <span class='neutral'>        string memory prefix,</span>
 69 |     | <span class='neutral'>        string memory description,</span>
 70 |     | <span class='neutral'>        int256 data</span>
 71 |     | <span class='neutral'>    ) internal {</span>
 72 |     | <span class='neutral'>        emit Debug(prefix, description, data);</span>
 73 |     | <span class='neutral'>    }</span>
 74 |     | <span class='neutral'></span>
 75 |     | <span class='neutral'>    function log(string memory description, address data) internal {</span>
 76 |     | <span class='neutral'>        emit Debug(description, data);</span>
 77 |     | <span class='neutral'>    }</span>
 78 |     | <span class='neutral'></span>
 79 |     | <span class='neutral'>    function log(</span>
 80 |     | <span class='neutral'>        string memory prefix,</span>
 81 |     | <span class='neutral'>        string memory description,</span>
 82 |     | <span class='neutral'>        address data</span>
 83 |     | <span class='neutral'>    ) internal {</span>
 84 |     | <span class='neutral'>        emit Debug(prefix, description, data);</span>
 85 |     | <span class='neutral'>    }</span>
 86 |     | <span class='neutral'></span>
 87 |     | <span class='neutral'>    function log(string memory description, bool data) internal {</span>
 88 |     | <span class='neutral'>        emit Debug(description, data);</span>
 89 |     | <span class='neutral'>    }</span>
 90 |     | <span class='neutral'></span>
 91 |     | <span class='neutral'>    function log(</span>
 92 |     | <span class='neutral'>        string memory prefix,</span>
 93 |     | <span class='neutral'>        string memory description,</span>
 94 |     | <span class='neutral'>        bool data</span>
 95 |     | <span class='neutral'>    ) internal {</span>
 96 |     | <span class='neutral'>        emit Debug(prefix, description, data);</span>
 97 |     | <span class='neutral'>    }</span>
 98 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/Echidna/Echidna2PortalV2.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
   2 |     | <span class='neutral'>pragma solidity ^0.8.19;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import &quot;../PortalV2MultiAsset.sol&quot;;</span>
   5 |     | <span class='neutral'>import &quot;../MintBurnToken.sol&quot;;</span>
   6 |     | <span class='neutral'>import {VirtualLP} from &quot;src/V2MultiAsset/VirtualLP.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;./EchidnaConfig.sol&quot;;</span>
   8 |     | <span class='neutral'></span>
   9 | *r  | <span class='executed'>contract Echidna2PortalV2 is EchidnaConfig {</span>
  10 | *   | <span class='executed'>    MintBurnToken public psmToken;</span>
  11 | *   | <span class='executed'>    VirtualLP public virtualLP;</span>
  12 |     | <span class='neutral'></span>
  13 |     | <span class='neutral'>    // External token addresses</span>
  14 |     | <span class='unexecuted'>    address constant WETH_ADDRESS = 0x82aF49447D8a07e3bd95BD0d56f35241523fBab1;</span>
  15 | *   | <span class='executed'>    address public constant PSM_ADDRESS =</span>
  16 | *   | <span class='executed'>        0x17A8541B82BF67e10B0874284b4Ae66858cb1fd5;</span>
  17 |     | <span class='neutral'>    address constant esVKA = 0x95b3F9797077DDCa971aB8524b439553a220EB2A;</span>
  18 |     | <span class='neutral'></span>
  19 |     | <span class='neutral'>    address private constant _PRINCIPAL_TOKEN_ADDRESS_USDC =</span>
  20 |     | <span class='unexecuted'>        0xaf88d065e77c8cC2239327C5EDb3A432268e5831;</span>
  21 |     | <span class='unexecuted'>    address private constant _PRINCIPAL_TOKEN_ADDRESS_ETH = address(0);</span>
  22 |     | <span class='neutral'></span>
  23 |     | <span class='neutral'>    // General constants</span>
  24 |     | <span class='neutral'>    uint256 constant _TERMINAL_MAX_LOCK_DURATION = 157680000;</span>
  25 |     | <span class='unexecuted'>    uint256 private constant SECONDS_PER_YEAR = 31536000; // seconds in a 365 day year</span>
  26 | *   | <span class='executed'>    uint256 public maxLockDuration = 7776000; // 7776000 starting value for maximum allowed lock duration of users balance in seconds (90 days)</span>
  27 |     | <span class='unexecuted'>    uint256 private constant OWNER_DURATION = 31536000; // 1 Year</span>
  28 |     | <span class='neutral'></span>
  29 |     | <span class='neutral'>    // Portal Constructor values</span>
  30 |     | <span class='unexecuted'>    uint256 constant _TARGET_CONSTANT_USDC = 440528634361 * 1e36;</span>
  31 |     | <span class='unexecuted'>    uint256 constant _TARGET_CONSTANT_WETH = 125714213 * 1e36;</span>
  32 |     | <span class='neutral'></span>
  33 |     | <span class='unexecuted'>    uint256 constant _FUNDING_PHASE_DURATION = 604800; // 7 days</span>
  34 |     | <span class='neutral'>    uint256 constant _FUNDING_MIN_AMOUNT = 1e25; // 10M PSM</span>
  35 |     | <span class='neutral'></span>
  36 |     | <span class='unexecuted'>    uint256 constant _DECIMALS = 18;</span>
  37 |     | <span class='unexecuted'>    uint256 constant _DECIMALS_USDC = 6;</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='unexecuted'>    uint256 constant _AMOUNT_TO_CONVERT = 100000 * 1e18;</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='unexecuted'>    string _META_DATA_URI = &quot;abcd&quot;;</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>    // time</span>
  44 |     | <span class='neutral'>    uint256 timestamp;</span>
  45 |     | <span class='neutral'>    uint256 fundingPhase;</span>
  46 |     | <span class='neutral'>    uint256 ownerExpiry;</span>
  47 |     | <span class='neutral'>    uint256 hundredYearsLater;</span>
  48 |     | <span class='neutral'></span>
  49 |     | <span class='neutral'>    // Token Instances</span>
  50 |     | <span class='unexecuted'>    IERC20 psm = IERC20(PSM_ADDRESS);</span>
  51 |     | <span class='unexecuted'>    IERC20 usdc = IERC20(_PRINCIPAL_TOKEN_ADDRESS_USDC);</span>
  52 |     | <span class='unexecuted'>    IERC20 weth = IERC20(WETH_ADDRESS);</span>
  53 |     | <span class='neutral'></span>
  54 |     | <span class='neutral'>    // Portals &amp; LP</span>
  55 | *   | <span class='executed'>    PortalV2MultiAsset public portal_USDC;</span>
  56 | *   | <span class='executed'>    PortalV2MultiAsset public portal_ETH;</span>
  57 |     | <span class='neutral'></span>
  58 |     | <span class='neutral'>    // Simulated USDC distributor</span>
  59 |     | <span class='unexecuted'>    address usdcSender = 0xF977814e90dA44bFA03b6295A0616a897441aceC;</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    // PSM Treasury</span>
  62 |     | <span class='unexecuted'>    address psmSender = 0xAb845D09933f52af5642FC87Dd8FBbf553fd7B33;</span>
  63 |     | <span class='neutral'></span>
  64 |     | <span class='neutral'>    // starting token amounts</span>
  65 |     | <span class='unexecuted'>    uint256 usdcAmount = 1e12; // 1M USDC</span>
  66 |     | <span class='unexecuted'>    uint256 psmAmount = 1e25; // 10M PSM</span>
  67 |     | <span class='unexecuted'>    uint256 usdcSendAmount = 1e9; // 1k USDC</span>
  68 |     | <span class='neutral'></span>
  69 |     | <span class='unexecuted'>    constructor() payable {</span>
  70 |     | <span class='neutral'>        // hevm.roll(195078119); // sets the correct block number</span>
  71 |     | <span class='neutral'>        // hevm.warp(1711625676); // sets the expected timestamp for the block number</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='neutral'>        // Create Virtual LP instance</span>
  74 |     | <span class='unexecuted'>        virtualLP = new VirtualLP(</span>
  75 |     | <span class='neutral'>            psmSender,</span>
  76 |     | <span class='neutral'>            _AMOUNT_TO_CONVERT,</span>
  77 |     | <span class='neutral'>            _FUNDING_PHASE_DURATION,</span>
  78 |     | <span class='neutral'>            _FUNDING_MIN_AMOUNT</span>
  79 |     | <span class='neutral'>        );</span>
  80 |     | <span class='neutral'>        address _VIRTUAL_LP = address(virtualLP);</span>
  81 |     | <span class='neutral'></span>
  82 |     | <span class='neutral'>        // Create Portal instances</span>
  83 |     | <span class='unexecuted'>        portal_USDC = new PortalV2MultiAsset(</span>
  84 |     | <span class='neutral'>            _VIRTUAL_LP,</span>
  85 |     | <span class='neutral'>            _TARGET_CONSTANT_USDC,</span>
  86 |     | <span class='neutral'>            _PRINCIPAL_TOKEN_ADDRESS_USDC,</span>
  87 |     | <span class='neutral'>            _DECIMALS_USDC,</span>
  88 |     | <span class='neutral'>            &quot;USD Coin&quot;,</span>
  89 |     | <span class='neutral'>            &quot;USDC&quot;,</span>
  90 |     | <span class='unexecuted'>            _META_DATA_URI</span>
  91 |     | <span class='neutral'>        );</span>
  92 |     | <span class='unexecuted'>        portal_ETH = new PortalV2MultiAsset(</span>
  93 |     | <span class='unexecuted'>            _VIRTUAL_LP,</span>
  94 |     | <span class='neutral'>            _TARGET_CONSTANT_WETH,</span>
  95 |     | <span class='neutral'>            _PRINCIPAL_TOKEN_ADDRESS_ETH,</span>
  96 |     | <span class='neutral'>            _DECIMALS,</span>
  97 |     | <span class='neutral'>            &quot;ETHER&quot;,</span>
  98 |     | <span class='neutral'>            &quot;ETH&quot;,</span>
  99 |     | <span class='unexecuted'>            _META_DATA_URI</span>
 100 |     | <span class='neutral'>        );</span>
 101 |     | <span class='neutral'></span>
 102 |     | <span class='neutral'>         // creation time</span>
 103 |     | <span class='unexecuted'>        timestamp = block.timestamp;</span>
 104 |     | <span class='unexecuted'>        fundingPhase = timestamp + _FUNDING_PHASE_DURATION;</span>
 105 |     | <span class='unexecuted'>        ownerExpiry = timestamp + OWNER_DURATION;</span>
 106 |     | <span class='unexecuted'>        hundredYearsLater = timestamp + 100 * SECONDS_PER_YEAR;</span>
 107 |     | <span class='neutral'></span>
 108 |     | <span class='neutral'>        // Deal tokens to addresses</span>
 109 |     | <span class='neutral'>        // hevm.deal(USER1, 1 ether);</span>
 110 |     | <span class='unexecuted'>        hevm.prank(psmSender);</span>
 111 |     | <span class='unexecuted'>        psm.transfer(USER1, psmAmount);</span>
 112 |     | <span class='unexecuted'>        hevm.prank(usdcSender);</span>
 113 |     | <span class='unexecuted'>        usdc.transfer(USER1, usdcAmount);</span>
 114 |     | <span class='neutral'></span>
 115 |     | <span class='neutral'>        // hevm.deal(USER2, 1 ether);</span>
 116 |     | <span class='unexecuted'>        hevm.prank(psmSender);</span>
 117 |     | <span class='unexecuted'>        psm.transfer(USER2, psmAmount);</span>
 118 |     | <span class='unexecuted'>        hevm.prank(usdcSender);</span>
 119 |     | <span class='unexecuted'>        usdc.transfer(USER2, usdcAmount);</span>
 120 |     | <span class='neutral'></span>
 121 |     | <span class='neutral'>        // hevm.deal(USER3, 1 ether);</span>
 122 |     | <span class='unexecuted'>        hevm.prank(psmSender);</span>
 123 |     | <span class='unexecuted'>        psm.transfer(USER3, psmAmount);</span>
 124 |     | <span class='unexecuted'>        hevm.prank(usdcSender);</span>
 125 |     | <span class='unexecuted'>        usdc.transfer(USER3, usdcAmount);</span>
 126 |     | <span class='neutral'>    }</span>
 127 |     | <span class='neutral'></span>
 128 |     | <span class='neutral'>    // Echidna test for staking and unstaking invariant</span>
 129 |     | <span class='unexecuted'>    function echidna_test_stake_unstake_invariant() public {</span>
 130 |     | <span class='unexecuted'>        uint256 stakeAmount = 1000e18; // Simplified stake amount</span>
 131 |     | <span class='unexecuted'>        hevm.prank(USER1);</span>
 132 |     | <span class='unexecuted'>        portal_ETH.stake(stakeAmount);</span>
 133 |     | <span class='unexecuted'>        hevm.prank(USER1);</span>
 134 |     | <span class='unexecuted'>        portal_ETH.unstake(stakeAmount);</span>
 135 |     | <span class='neutral'></span>
 136 |     | <span class='neutral'>        // Assertion to ensure total staked balance is correct</span>
 137 |     | <span class='unexecuted'>        assert(portal_ETH.totalPrincipalStaked() == 0);</span>
 138 |     | <span class='neutral'>    }</span>
 139 |     | <span class='neutral'></span>
 140 |     | <span class='neutral'>    // Echidna test for portal energy token minting and burning consistency</span>
 141 |     | <span class='unexecuted'>    function echidna_test_portal_energy_token_mint_burn() public {</span>
 142 |     | <span class='unexecuted'>        uint256 mintAmount = 500e18; // Simplified mint amount</span>
 143 |     | <span class='unexecuted'>        hevm.prank(USER2);</span>
 144 |     | <span class='unexecuted'>        portal_ETH.mintPortalEnergyToken(USER2, mintAmount); // Assuming this function exists and works directly for simplicity</span>
 145 |     | <span class='unexecuted'>        hevm.prank(USER2);</span>
 146 |     | <span class='unexecuted'>        portal_ETH.burnPortalEnergyToken(USER2, mintAmount); // Assuming direct burn for simplicity</span>
 147 |     | <span class='neutral'></span>
 148 |     | <span class='neutral'>        // Assertion to check portal energy balance consistency</span>
 149 |     | <span class='neutral'>        // This is a placeholder for the actual logic you might want to assert</span>
 150 |     | <span class='neutral'>        // E.g., asserting that the user&#39;s portal energy is back to the initial state</span>
 151 |     | <span class='neutral'>        // This might require adjustments based on the actual implementation details</span>
 152 |     | <span class='unexecuted'>        assert(true); // Placeholder assertion</span>
 153 |     | <span class='neutral'>    }</span>
 154 |     | <span class='neutral'>}</span>
 155 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/Echidna/EchidnaConfig.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./IHevm.sol&quot;;</span>
  5 |     | <span class='neutral'>import &quot;./Debugger.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='unexecuted'>contract EchidnaConfig {</span>
  8 |     | <span class='unexecuted'>    IHevm hevm = IHevm(0x7109709ECfa91a80626fF3989D68f67F5b1DD12D);</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'>    // Constant echidna addresses</span>
 11 |     | <span class='unexecuted'>    address internal constant USER1 = address(0x10000);</span>
 12 |     | <span class='unexecuted'>    address internal constant USER2 = address(0x20000);</span>
 13 |     | <span class='unexecuted'>    address internal constant USER3 = address(0x30000);</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'>    address payable internal ADDRESS_ACCOUNT0;</span>
 16 |     | <span class='neutral'>    address payable internal ADDRESS_ACCOUNT1;</span>
 17 |     | <span class='neutral'>    address payable internal ADDRESS_ACCOUNT2;</span>
 18 |     | <span class='neutral'>        </span>
 19 |     | <span class='neutral'>    uint256 internal constant STARTING_TOKEN_BALANCE = 1_000_000_000e6;</span>
 20 |     | <span class='neutral'>    uint256 internal constant STARTING_ETH_BALANCE = 1000 ether;</span>
 21 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/Echidna/EchidnaPortalV2MultiAsset.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
   2 |     | <span class='neutral'>pragma solidity ^0.8.19;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import &quot;../PortalV2MultiAsset.sol&quot;;</span>
   5 |     | <span class='neutral'>import &quot;../MintBurnToken.sol&quot;;</span>
   6 |     | <span class='neutral'>import {VirtualLP} from &quot;src/V2MultiAsset/VirtualLP.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;./EchidnaConfig.sol&quot;;</span>
   8 |     | <span class='neutral'></span>
   9 | *r  | <span class='executed'>contract EchidnaPortalV2MultiAsset is EchidnaConfig {</span>
  10 | *   | <span class='executed'>    MintBurnToken public psmToken;</span>
  11 | *   | <span class='executed'>    VirtualLP public virtualLP;</span>
  12 |     | <span class='neutral'></span>
  13 |     | <span class='neutral'>    // External token addresses</span>
  14 |     | <span class='unexecuted'>    address constant WETH_ADDRESS = 0x82aF49447D8a07e3bd95BD0d56f35241523fBab1;</span>
  15 | *   | <span class='executed'>    address public constant PSM_ADDRESS =</span>
  16 | *   | <span class='executed'>        0x17A8541B82BF67e10B0874284b4Ae66858cb1fd5;</span>
  17 |     | <span class='neutral'>    address constant esVKA = 0x95b3F9797077DDCa971aB8524b439553a220EB2A;</span>
  18 |     | <span class='neutral'></span>
  19 |     | <span class='neutral'>    // Vaultka staking contracts</span>
  20 |     | <span class='neutral'>    address constant SINGLE_STAKING =</span>
  21 |     | <span class='neutral'>        0x314223E2fA375F972E159002Eb72A96301E99e22;</span>
  22 |     | <span class='neutral'>    address constant DUAL_STAKING = 0x31Fa38A6381e9d1f4770C73AB14a0ced1528A65E;</span>
  23 |     | <span class='neutral'></span>
  24 |     | <span class='neutral'>    uint256 constant _POOL_ID_USDC = 5;</span>
  25 |     | <span class='neutral'>    uint256 constant _POOL_ID_WETH = 10;</span>
  26 |     | <span class='neutral'></span>
  27 |     | <span class='neutral'>    address private constant USDC_WATER =</span>
  28 |     | <span class='neutral'>        0x9045ae36f963b7184861BDce205ea8B08913B48c;</span>
  29 |     | <span class='neutral'>    address private constant WETH_WATER =</span>
  30 |     | <span class='neutral'>        0x8A98929750e6709Af765F976c6bddb5BfFE6C06c;</span>
  31 |     | <span class='neutral'></span>
  32 |     | <span class='neutral'>    address private constant _PRINCIPAL_TOKEN_ADDRESS_USDC =</span>
  33 |     | <span class='unexecuted'>        0xaf88d065e77c8cC2239327C5EDb3A432268e5831;</span>
  34 |     | <span class='unexecuted'>    address private constant _PRINCIPAL_TOKEN_ADDRESS_ETH = address(0);</span>
  35 |     | <span class='neutral'></span>
  36 |     | <span class='neutral'>    // General constants</span>
  37 |     | <span class='neutral'>    uint256 constant _TERMINAL_MAX_LOCK_DURATION = 157680000;</span>
  38 |     | <span class='unexecuted'>    uint256 private constant SECONDS_PER_YEAR = 31536000; // seconds in a 365 day year</span>
  39 | *   | <span class='executed'>    uint256 public maxLockDuration = 7776000; // 7776000 starting value for maximum allowed lock duration of users balance in seconds (90 days)</span>
  40 |     | <span class='unexecuted'>    uint256 private constant OWNER_DURATION = 31536000; // 1 Year</span>
  41 |     | <span class='neutral'></span>
  42 |     | <span class='neutral'>    // Portal Constructor values</span>
  43 |     | <span class='unexecuted'>    uint256 constant _TARGET_CONSTANT_USDC = 440528634361 * 1e36;</span>
  44 |     | <span class='unexecuted'>    uint256 constant _TARGET_CONSTANT_WETH = 125714213 * 1e36;</span>
  45 |     | <span class='neutral'></span>
  46 |     | <span class='unexecuted'>    uint256 constant _FUNDING_PHASE_DURATION = 604800; // 7 days</span>
  47 |     | <span class='unexecuted'>    uint256 constant _FUNDING_MIN_AMOUNT = 1e25; // 10M PSM</span>
  48 |     | <span class='neutral'></span>
  49 |     | <span class='unexecuted'>    uint256 constant _DECIMALS = 18;</span>
  50 |     | <span class='unexecuted'>    uint256 constant _DECIMALS_USDC = 6;</span>
  51 |     | <span class='neutral'></span>
  52 |     | <span class='unexecuted'>    uint256 constant _AMOUNT_TO_CONVERT = 100000 * 1e18;</span>
  53 |     | <span class='neutral'></span>
  54 |     | <span class='unexecuted'>    string _META_DATA_URI = &quot;abcd&quot;;</span>
  55 |     | <span class='neutral'></span>
  56 |     | <span class='neutral'>    // time</span>
  57 |     | <span class='neutral'>    uint256 timestamp;</span>
  58 |     | <span class='neutral'>    uint256 fundingPhase;</span>
  59 |     | <span class='neutral'>    uint256 ownerExpiry;</span>
  60 |     | <span class='neutral'>    uint256 hundredYearsLater;</span>
  61 |     | <span class='neutral'></span>
  62 |     | <span class='neutral'>    // Token Instances</span>
  63 |     | <span class='unexecuted'>    IERC20 psm = IERC20(PSM_ADDRESS);</span>
  64 |     | <span class='unexecuted'>    IERC20 usdc = IERC20(_PRINCIPAL_TOKEN_ADDRESS_USDC);</span>
  65 |     | <span class='unexecuted'>    IERC20 weth = IERC20(WETH_ADDRESS);</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='neutral'>    // Portals &amp; LP</span>
  68 | *   | <span class='executed'>    PortalV2MultiAsset public portal_USDC;</span>
  69 | *   | <span class='executed'>    PortalV2MultiAsset public portal_ETH;</span>
  70 |     | <span class='neutral'></span>
  71 |     | <span class='neutral'>    // Simulated USDC distributor</span>
  72 |     | <span class='unexecuted'>    address usdcSender = 0xF977814e90dA44bFA03b6295A0616a897441aceC;</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='neutral'>    // PSM Treasury</span>
  75 |     | <span class='unexecuted'>    address psmSender = 0xAb845D09933f52af5642FC87Dd8FBbf553fd7B33;</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>    // starting token amounts</span>
  78 |     | <span class='unexecuted'>    uint256 usdcAmount = 1e12; // 1M USDC</span>
  79 |     | <span class='unexecuted'>    uint256 psmAmount = 1e25; // 10M PSM</span>
  80 |     | <span class='unexecuted'>    uint256 usdcSendAmount = 1e9; // 1k USDC</span>
  81 |     | <span class='neutral'></span>
  82 |     | <span class='unexecuted'>    constructor() {</span>
  83 |     | <span class='unexecuted'>        hevm.roll(195078119); // sets the correct block number</span>
  84 |     | <span class='neutral'>        // hevm.warp(); // sets the expected timestamp for the block number</span>
  85 |     | <span class='neutral'></span>
  86 |     | <span class='neutral'>        // Create Virtual LP instance</span>
  87 |     | <span class='unexecuted'>        virtualLP = new VirtualLP(</span>
  88 |     | <span class='unexecuted'>            psmSender,</span>
  89 |     | <span class='neutral'>            _AMOUNT_TO_CONVERT,</span>
  90 |     | <span class='neutral'>            _FUNDING_PHASE_DURATION,</span>
  91 |     | <span class='neutral'>            _FUNDING_MIN_AMOUNT</span>
  92 |     | <span class='neutral'>        );</span>
  93 |     | <span class='neutral'>        address _VIRTUAL_LP = address(virtualLP);</span>
  94 |     | <span class='neutral'></span>
  95 |     | <span class='neutral'>        // Create Portal instances</span>
  96 |     | <span class='unexecuted'>        portal_USDC = new PortalV2MultiAsset(</span>
  97 |     | <span class='neutral'>            _VIRTUAL_LP,</span>
  98 |     | <span class='neutral'>            _TARGET_CONSTANT_USDC,</span>
  99 |     | <span class='neutral'>            _PRINCIPAL_TOKEN_ADDRESS_USDC,</span>
 100 |     | <span class='neutral'>            _DECIMALS_USDC,</span>
 101 |     | <span class='neutral'>            &quot;USD Coin&quot;,</span>
 102 |     | <span class='neutral'>            &quot;USDC&quot;,</span>
 103 |     | <span class='unexecuted'>            _META_DATA_URI</span>
 104 |     | <span class='neutral'>        );</span>
 105 |     | <span class='unexecuted'>        portal_ETH = new PortalV2MultiAsset(</span>
 106 |     | <span class='unexecuted'>            _VIRTUAL_LP,</span>
 107 |     | <span class='neutral'>            _TARGET_CONSTANT_WETH,</span>
 108 |     | <span class='neutral'>            _PRINCIPAL_TOKEN_ADDRESS_ETH,</span>
 109 |     | <span class='neutral'>            _DECIMALS,</span>
 110 |     | <span class='neutral'>            &quot;ETHER&quot;,</span>
 111 |     | <span class='neutral'>            &quot;ETH&quot;,</span>
 112 |     | <span class='unexecuted'>            _META_DATA_URI</span>
 113 |     | <span class='neutral'>        );</span>
 114 |     | <span class='neutral'></span>
 115 |     | <span class='neutral'>         // creation time</span>
 116 |     | <span class='unexecuted'>        timestamp = block.timestamp;</span>
 117 |     | <span class='unexecuted'>        fundingPhase = timestamp + _FUNDING_PHASE_DURATION;</span>
 118 |     | <span class='unexecuted'>        ownerExpiry = timestamp + OWNER_DURATION;</span>
 119 |     | <span class='unexecuted'>        hundredYearsLater = timestamp + 100 * SECONDS_PER_YEAR;</span>
 120 |     | <span class='neutral'></span>
 121 |     | <span class='neutral'>        // Deal tokens to addresses</span>
 122 |     | <span class='unexecuted'>        hevm.deal(USER1, 1 ether);</span>
 123 |     | <span class='unexecuted'>        hevm.prank(psmSender);</span>
 124 |     | <span class='unexecuted'>        psm.transfer(USER1, psmAmount);</span>
 125 |     | <span class='unexecuted'>        hevm.prank(usdcSender);</span>
 126 |     | <span class='unexecuted'>        usdc.transfer(USER1, usdcAmount);</span>
 127 |     | <span class='neutral'></span>
 128 |     | <span class='neutral'>        // hevm.deal(USER2, 1 ether);</span>
 129 |     | <span class='unexecuted'>        hevm.prank(psmSender);</span>
 130 |     | <span class='unexecuted'>        psm.transfer(USER2, psmAmount);</span>
 131 |     | <span class='unexecuted'>        hevm.prank(usdcSender);</span>
 132 |     | <span class='unexecuted'>        usdc.transfer(USER2, usdcAmount);</span>
 133 |     | <span class='neutral'></span>
 134 |     | <span class='neutral'>        // hevm.deal(USER3, 1 ether);</span>
 135 |     | <span class='unexecuted'>        hevm.prank(psmSender);</span>
 136 |     | <span class='unexecuted'>        psm.transfer(USER3, psmAmount);</span>
 137 |     | <span class='unexecuted'>        hevm.prank(usdcSender);</span>
 138 |     | <span class='unexecuted'>        usdc.transfer(USER3, usdcAmount);</span>
 139 |     | <span class='neutral'>    }</span>
 140 |     | <span class='neutral'></span>
 141 |     | <span class='neutral'>    // Echidna test for staking and unstaking invariant</span>
 142 |     | <span class='unexecuted'>    function echidna_test_stake_unstake_invariant() public {</span>
 143 |     | <span class='unexecuted'>        uint256 stakeAmount = 1000e18; // Simplified stake amount</span>
 144 |     | <span class='unexecuted'>        hevm.prank(USER1);</span>
 145 |     | <span class='unexecuted'>        portal_ETH.stake(stakeAmount);</span>
 146 |     | <span class='unexecuted'>        hevm.prank(USER1);</span>
 147 |     | <span class='unexecuted'>        portal_ETH.unstake(stakeAmount);</span>
 148 |     | <span class='neutral'></span>
 149 |     | <span class='neutral'>        // Assertion to ensure total staked balance is correct</span>
 150 |     | <span class='unexecuted'>        assert(portal_ETH.totalPrincipalStaked() == 0);</span>
 151 |     | <span class='neutral'>    }</span>
 152 |     | <span class='neutral'></span>
 153 |     | <span class='neutral'>    // Echidna test for portal energy token minting and burning consistency</span>
 154 |     | <span class='unexecuted'>    function echidna_test_portal_energy_token_mint_burn() public {</span>
 155 |     | <span class='unexecuted'>        uint256 mintAmount = 500e18; // Simplified mint amount</span>
 156 |     | <span class='unexecuted'>        hevm.prank(USER2);</span>
 157 |     | <span class='unexecuted'>        portal_ETH.mintPortalEnergyToken(USER2, mintAmount); // Assuming this function exists and works directly for simplicity</span>
 158 |     | <span class='unexecuted'>        hevm.prank(USER2);</span>
 159 |     | <span class='unexecuted'>        portal_ETH.burnPortalEnergyToken(USER2, mintAmount); // Assuming direct burn for simplicity</span>
 160 |     | <span class='neutral'></span>
 161 |     | <span class='neutral'>        // Assertion to check portal energy balance consistency</span>
 162 |     | <span class='neutral'>        // This is a placeholder for the actual logic you might want to assert</span>
 163 |     | <span class='neutral'>        // E.g., asserting that the user&#39;s portal energy is back to the initial state</span>
 164 |     | <span class='neutral'>        // This might require adjustments based on the actual implementation details</span>
 165 |     | <span class='unexecuted'>        assert(true); // Placeholder assertion</span>
 166 |     | <span class='neutral'>    }</span>
 167 |     | <span class='neutral'>}</span>
 168 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/Echidna/EchidnaSetup.sol</b>
<code>
  1 |     | <span class='neutral'>// // SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>// import &quot;./IHevm.sol&quot;;</span>
  4 |     | <span class='neutral'>// import &quot;./EchidnaConfig.sol&quot;;</span>
  5 |     | <span class='neutral'>// import &quot;./Debugger.sol&quot;;</span>
  6 |     | <span class='neutral'>// import &quot;./Account.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>// import &quot;../interfaces/IUSDC.sol&quot;;</span>
  9 |     | <span class='neutral'>// import &quot;../interfaces/IcEther.sol&quot;;</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>// contract EchidnaSetup is EchidnaConfig {</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>//     Account account0 = new Account(0);</span>
 14 |     | <span class='neutral'>//     Account account1 = new Account(2);</span>
 15 |     | <span class='neutral'>//     Account account2 = new Account(128);</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>//     IUSDC usdc = IUSDC(0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48);</span>
 18 |     | <span class='neutral'>//     IcEther fEth = IcEther(payable(0x26267e41CeCa7C8E0f143554Af707336f27Fa051));</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>//     constructor() {</span>
 21 |     | <span class='neutral'>//         // not sure if still necessary, but just in case</span>
 22 |     | <span class='neutral'>//         hevm.roll(195078119);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>//         hevm.prank(usdc.masterMinter());</span>
 25 |     | <span class='neutral'>//         usdc.configureMinter(address(this), type(uint256).max);</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='neutral'>//         ADDRESS_ACCOUNT0 = payable(address(account0));</span>
 28 |     | <span class='neutral'>//         ADDRESS_ACCOUNT0 = payable(address(account1));</span>
 29 |     | <span class='neutral'>//         ADDRESS_ACCOUNT2 = payable(address(account2));</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>//         ADDRESS_ACCOUNT0.transfer(STARTING_ETH_BALANCE);</span>
 32 |     | <span class='neutral'>//         ADDRESS_ACCOUNT1.transfer(STARTING_ETH_BALANCE);</span>
 33 |     | <span class='neutral'>//         ADDRESS_ACCOUNT2.transfer(STARTING_ETH_BALANCE);</span>
 34 |     | <span class='neutral'></span>
 35 |     | <span class='neutral'>//         usdc.mint(ADDRESS_ACCOUNT0, STARTING_TOKEN_BALANCE);</span>
 36 |     | <span class='neutral'>//         usdc.mint(ADDRESS_ACCOUNT1, STARTING_TOKEN_BALANCE);</span>
 37 |     | <span class='neutral'>//         usdc.mint(ADDRESS_ACCOUNT2, STARTING_TOKEN_BALANCE);</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='neutral'>//         hevm.prank(ADDRESS_ACCOUNT0);</span>
 40 |     | <span class='neutral'>//         usdc.approve(address(fUsdc), type(uint256).max);</span>
 41 |     | <span class='neutral'>//         hevm.prank(ADDRESS_ACCOUNT1);</span>
 42 |     | <span class='neutral'>//         usdc.approve(address(fUsdc), type(uint256).max);</span>
 43 |     | <span class='neutral'>//         hevm.prank(ADDRESS_ACCOUNT2);</span>
 44 |     | <span class='neutral'>//         usdc.approve(address(fUsdc), type(uint256).max);</span>
 45 |     | <span class='neutral'>//     }</span>
 46 |     | <span class='neutral'>// }</span>
 47 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/Echidna/IHevm.sol</b>
<code>
  1 |     | <span class='neutral'>/*</span>
  2 |     | <span class='neutral'>https://github.com/ethereum/hevm/blob/main/doc/src/controlling-the-unit-testing-environment.md#cheat-codes</span>
  3 |     | <span class='neutral'>*/</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  6 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>interface IHevm {</span>
  9 |     | <span class='neutral'>    function warp(uint256 x) external;</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    function roll(uint256 x) external;</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    function store(</span>
 14 |     | <span class='neutral'>        address c,</span>
 15 |     | <span class='neutral'>        bytes32 loc,</span>
 16 |     | <span class='neutral'>        bytes32 val</span>
 17 |     | <span class='neutral'>    ) external;</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    function load(address c, bytes32 loc) external returns (bytes32 val);</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    function sign(uint256 sk, bytes32 digest)</span>
 22 |     | <span class='neutral'>        external</span>
 23 |     | <span class='neutral'>        returns (</span>
 24 |     | <span class='neutral'>            uint8 v,</span>
 25 |     | <span class='neutral'>            bytes32 r,</span>
 26 |     | <span class='neutral'>            bytes32 s</span>
 27 |     | <span class='neutral'>        );</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    function addr(uint256 sk) external returns (address addr);</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>    function ffi(string[] calldata) external returns (bytes memory);</span>
 32 |     | <span class='neutral'></span>
 33 |     | <span class='neutral'>    function prank(address sender) external;</span>
 34 |     | <span class='neutral'></span>
 35 |     | <span class='neutral'>    function deal(address usr, uint256 amt) external;</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>    function assume(bool b) external;</span>
 38 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/MintBurnToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-2.0-only</span>
  2 |     | <span class='neutral'>pragma solidity =0.8.19;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {ERC20} from &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  5 |     | <span class='neutral'>import {ERC20Burnable} from &quot;@openzeppelin/contracts/token/ERC20/extensions/ERC20Burnable.sol&quot;;</span>
  6 |     | <span class='neutral'>import {ERC20Permit} from &quot;@openzeppelin/contracts/token/ERC20/extensions/ERC20Permit.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>error NotOwner();</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='unexecuted'>contract MintBurnToken is ERC20, ERC20Burnable, ERC20Permit {</span>
 11 |     | <span class='unexecuted'>    address public immutable OWNER;</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='unexecuted'>    constructor(</span>
 14 |     | <span class='neutral'>        string memory name,</span>
 15 |     | <span class='neutral'>        string memory symbol</span>
 16 |     | <span class='unexecuted'>    ) ERC20(name, symbol) ERC20Permit(name) {</span>
 17 |     | <span class='unexecuted'>        OWNER = msg.sender;</span>
 18 |     | <span class='neutral'>    }</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    modifier onlyOwner() {</span>
 21 |     | <span class='unexecuted'>        if (msg.sender != OWNER) {</span>
 22 |     | <span class='unexecuted'>            revert NotOwner();</span>
 23 |     | <span class='neutral'>        }</span>
 24 |     | <span class='neutral'>        _;</span>
 25 |     | <span class='neutral'>    }</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='unexecuted'>    function mint(address to, uint256 amount) external onlyOwner {</span>
 28 |     | <span class='unexecuted'>        _mint(to, amount);</span>
 29 |     | <span class='neutral'>    }</span>
 30 |     | <span class='neutral'>}</span>
 31 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/PortalNFT.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-2.0-only</span>
   2 |     | <span class='neutral'>pragma solidity =0.8.19;</span>
   3 |     | <span class='neutral'>import {ERC721} from &quot;@openzeppelin/contracts/token/ERC721/ERC721.sol&quot;;</span>
   4 |     | <span class='neutral'>import {ERC721URIStorage} from &quot;@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol&quot;;</span>
   5 |     | <span class='neutral'>import {IPortalV2MultiAsset} from &quot;./interfaces/IPortalV2MultiAsset.sol&quot;;</span>
   6 |     | <span class='neutral'></span>
   7 |     | <span class='neutral'>error NotOwner();</span>
   8 |     | <span class='neutral'>error NotOwnerOfNFT();</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/// @notice This NFT contract can mint and redeem stakes in the deploying Portal</span>
  11 |     | <span class='neutral'>/// @dev Must be deployed by the Portal which becomes the owner with mint and burn privileges</span>
  12 |     | <span class='unexecuted'>contract PortalNFT is ERC721URIStorage {</span>
  13 |     | <span class='unexecuted'>    constructor(</span>
  14 |     | <span class='neutral'>        uint256 _decimalsAdjustment,</span>
  15 |     | <span class='neutral'>        string memory _name,</span>
  16 |     | <span class='neutral'>        string memory _symbol,</span>
  17 |     | <span class='neutral'>        string memory _metadataURI</span>
  18 |     | <span class='unexecuted'>    ) ERC721(_name, _symbol) {</span>
  19 |     | <span class='unexecuted'>        OWNER = msg.sender;</span>
  20 |     | <span class='unexecuted'>        DECIMALS_ADJUSTMENT = _decimalsAdjustment;</span>
  21 |     | <span class='unexecuted'>        metadataURI = _metadataURI;</span>
  22 |     | <span class='unexecuted'>        portal = IPortalV2MultiAsset(msg.sender);</span>
  23 |     | <span class='neutral'>    }</span>
  24 |     | <span class='neutral'></span>
  25 |     | <span class='neutral'>    // ========================</span>
  26 |     | <span class='neutral'>    //    VARIABLES &amp; MODIFIER</span>
  27 |     | <span class='neutral'>    // ========================</span>
  28 |     | <span class='unexecuted'>    IPortalV2MultiAsset public portal;</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    address private immutable OWNER;</span>
  31 |     | <span class='neutral'></span>
  32 |     | <span class='neutral'>    struct AccountNFT {</span>
  33 |     | <span class='neutral'>        uint256 mintTime;</span>
  34 |     | <span class='neutral'>        uint256 lastMaxLockDuration;</span>
  35 |     | <span class='neutral'>        uint256 stakedBalance;</span>
  36 |     | <span class='neutral'>        uint256 portalEnergy;</span>
  37 |     | <span class='neutral'>    }</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='unexecuted'>    mapping(uint256 tokenID =&gt; AccountNFT) public accounts;</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='unexecuted'>    uint256 public totalSupply;</span>
  42 |     | <span class='unexecuted'>    uint256 private constant SECONDS_PER_YEAR = 31536000;</span>
  43 |     | <span class='neutral'>    uint256 private immutable DECIMALS_ADJUSTMENT;</span>
  44 |     | <span class='neutral'>    string private metadataURI; // Metadata URI for all NFTs of this Portal</span>
  45 |     | <span class='neutral'></span>
  46 |     | <span class='neutral'>    modifier onlyOwner() {</span>
  47 |     | <span class='unexecuted'>        if (msg.sender != OWNER) {</span>
  48 |     | <span class='unexecuted'>            revert NotOwner();</span>
  49 |     | <span class='neutral'>        }</span>
  50 |     | <span class='neutral'>        _;</span>
  51 |     | <span class='neutral'>    }</span>
  52 |     | <span class='neutral'></span>
  53 |     | <span class='neutral'>    // ========================</span>
  54 |     | <span class='neutral'>    //    FUNCTIONS</span>
  55 |     | <span class='neutral'>    // ========================</span>
  56 |     | <span class='neutral'>    /// @dev Get the current values for stakedBalance and portalEnergy of a particular NFT</span>
  57 |     | <span class='unexecuted'>    function getAccount(</span>
  58 |     | <span class='neutral'>        uint256 _tokenId</span>
  59 |     | <span class='unexecuted'>    ) public view returns (uint256 stakedBalance, uint256 portalEnergy) {</span>
  60 |     | <span class='unexecuted'>        _requireMinted(_tokenId);</span>
  61 |     | <span class='neutral'></span>
  62 |     | <span class='unexecuted'>        AccountNFT memory account = accounts[_tokenId];</span>
  63 |     | <span class='neutral'>        /// @dev Calculate the Portal Energy earned since minting</span>
  64 |     | <span class='unexecuted'>        uint256 portalEnergyEarned = (account.stakedBalance *</span>
  65 |     | <span class='unexecuted'>            (block.timestamp - account.mintTime) *</span>
  66 |     | <span class='unexecuted'>            1e18);</span>
  67 |     | <span class='neutral'></span>
  68 |     | <span class='neutral'>        /// @dev Calculate the gain of Portal Energy from maxLockDuration increase</span>
  69 |     | <span class='unexecuted'>        uint256 portalEnergyIncrease = (account.stakedBalance *</span>
  70 |     | <span class='unexecuted'>            (portal.maxLockDuration() - account.lastMaxLockDuration) *</span>
  71 |     | <span class='unexecuted'>            1e18);</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='neutral'>        /// @dev Summarize changes in Portal Energy and divide by common denominator</span>
  74 |     | <span class='unexecuted'>        account.portalEnergy +=</span>
  75 |     | <span class='unexecuted'>            (portalEnergyEarned + portalEnergyIncrease) /</span>
  76 |     | <span class='unexecuted'>            (SECONDS_PER_YEAR * DECIMALS_ADJUSTMENT);</span>
  77 |     | <span class='neutral'></span>
  78 |     | <span class='neutral'>        /// @dev Return the values</span>
  79 |     | <span class='unexecuted'>        stakedBalance = account.stakedBalance;</span>
  80 |     | <span class='unexecuted'>        portalEnergy = account.portalEnergy;</span>
  81 |     | <span class='neutral'>    }</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    /// @dev Mint new NFT, can only be called by owner (Portal)</span>
  84 |     | <span class='unexecuted'>    function mint(</span>
  85 |     | <span class='neutral'>        address _recipient,</span>
  86 |     | <span class='neutral'>        uint256 _lastMaxLockDuration,</span>
  87 |     | <span class='neutral'>        uint256 _stakedBalance,</span>
  88 |     | <span class='neutral'>        uint256 _portalEnergy</span>
  89 |     | <span class='unexecuted'>    ) external onlyOwner returns (uint256 nftID) {</span>
  90 |     | <span class='unexecuted'>        totalSupply++;</span>
  91 |     | <span class='unexecuted'>        _safeMint(_recipient, totalSupply);</span>
  92 |     | <span class='unexecuted'>        _setTokenURI(totalSupply, metadataURI);</span>
  93 |     | <span class='neutral'></span>
  94 |     | <span class='unexecuted'>        AccountNFT memory account;</span>
  95 |     | <span class='unexecuted'>        account.mintTime = block.timestamp;</span>
  96 |     | <span class='unexecuted'>        account.lastMaxLockDuration = _lastMaxLockDuration;</span>
  97 |     | <span class='unexecuted'>        account.stakedBalance = _stakedBalance;</span>
  98 |     | <span class='unexecuted'>        account.portalEnergy = _portalEnergy;</span>
  99 |     | <span class='neutral'></span>
 100 |     | <span class='unexecuted'>        accounts[totalSupply] = account;</span>
 101 |     | <span class='neutral'></span>
 102 |     | <span class='unexecuted'>        nftID = totalSupply;</span>
 103 |     | <span class='neutral'>    }</span>
 104 |     | <span class='neutral'></span>
 105 |     | <span class='neutral'>    /// @dev Redeem Position NFT to receive internal Account in Portal</span>
 106 |     | <span class='neutral'>    /// @dev Can only be called by the owner (Portal)</span>
 107 |     | <span class='unexecuted'>    function redeem(</span>
 108 |     | <span class='neutral'>        address ownerOfNFT,</span>
 109 |     | <span class='neutral'>        uint256 _tokenId</span>
 110 |     | <span class='unexecuted'>    ) external onlyOwner returns (uint256 stakedBalance, uint256 portalEnergy) {</span>
 111 |     | <span class='unexecuted'>        if (ownerOfNFT != _ownerOf(_tokenId)) {</span>
 112 |     | <span class='unexecuted'>            revert NotOwnerOfNFT();</span>
 113 |     | <span class='neutral'>        }</span>
 114 |     | <span class='neutral'></span>
 115 |     | <span class='neutral'>        /// @dev return the relevant values</span>
 116 |     | <span class='unexecuted'>        (stakedBalance, portalEnergy) = getAccount(_tokenId);</span>
 117 |     | <span class='neutral'></span>
 118 |     | <span class='neutral'>        /// @dev Burn the NFT and delete the associated account in the NFT contract</span>
 119 |     | <span class='unexecuted'>        _burn(_tokenId);</span>
 120 |     | <span class='unexecuted'>        delete accounts[_tokenId];</span>
 121 |     | <span class='neutral'>    }</span>
 122 |     | <span class='neutral'>}</span>
 123 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/PortalV2MultiAsset.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-2.0-only</span>
   2 |     | <span class='neutral'>pragma solidity =0.8.19;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import {MintBurnToken} from &quot;./MintBurnToken.sol&quot;;</span>
   5 |     | <span class='neutral'>import {PortalNFT} from &quot;./PortalNFT.sol&quot;;</span>
   6 |     | <span class='neutral'>import {IVirtualLP} from &quot;./interfaces/IVirtualLP.sol&quot;;</span>
   7 |     | <span class='neutral'>import {IERC20} from &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
   8 |     | <span class='neutral'>import {ERC20} from &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
   9 |     | <span class='neutral'>import {SafeERC20} from &quot;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&quot;;</span>
  10 |     | <span class='neutral'>import {ReentrancyGuard} from &quot;@openzeppelin/contracts/security/ReentrancyGuard.sol&quot;;</span>
  11 |     | <span class='neutral'></span>
  12 |     | <span class='neutral'>interface IWETH {</span>
  13 |     | <span class='neutral'>    function deposit() external payable;</span>
  14 |     | <span class='neutral'>}</span>
  15 |     | <span class='neutral'></span>
  16 |     | <span class='neutral'>// ============================================</span>
  17 |     | <span class='neutral'>// ==              CUSTOM ERRORS             ==</span>
  18 |     | <span class='neutral'>// ============================================</span>
  19 |     | <span class='neutral'>error DeadlineExpired();</span>
  20 |     | <span class='neutral'>error DurationLocked();</span>
  21 |     | <span class='neutral'>error DurationTooLow();</span>
  22 |     | <span class='neutral'>error EmptyAccount();</span>
  23 |     | <span class='neutral'>error InactiveLP();</span>
  24 |     | <span class='neutral'>error InsufficientBalance();</span>
  25 |     | <span class='neutral'>error InsufficientReceived();</span>
  26 |     | <span class='neutral'>error InsufficientStakeBalance();</span>
  27 |     | <span class='neutral'>error InvalidAddress();</span>
  28 |     | <span class='neutral'>error InvalidAmount();</span>
  29 |     | <span class='neutral'>error InvalidConstructor();</span>
  30 |     | <span class='neutral'>error NativeTokenNotAllowed();</span>
  31 |     | <span class='neutral'>error TokenExists();</span>
  32 |     | <span class='neutral'></span>
  33 |     | <span class='neutral'>/// @title Portal Contract V2 with shared Virtual LP</span>
  34 |     | <span class='neutral'>/// @author Possum Labs</span>
  35 |     | <span class='neutral'>/** @notice This contract accepts user deposits and withdrawals of a specific token</span>
  36 |     | <span class='neutral'> * The deposits are redirected to an external protocol to generate yield</span>
  37 |     | <span class='neutral'> * Yield is claimed and collected with this contract</span>
  38 |     | <span class='neutral'> * Users accrue portalEnergy points over time while staking their tokens</span>
  39 |     | <span class='neutral'> * portalEnergy can be exchanged against the PSM token using the internal Liquidity Pool or minted as ERC20</span>
  40 |     | <span class='neutral'> * PortalEnergy Tokens can be burned to increase a recipient internal portalEnergy balance</span>
  41 |     | <span class='neutral'> * Users can buy more portalEnergy via the internal LP by spending PSM</span>
  42 |     | <span class='neutral'> * The contract can receive PSM tokens during the funding phase and issues bTokens as receipt</span>
  43 |     | <span class='neutral'> * bTokens received during the funding phase are used to initialize the internal LP</span>
  44 |     | <span class='neutral'> * bTokens can be redeemed against the fundingRewardPool which consists of PSM tokens</span>
  45 |     | <span class='neutral'> * The fundingRewardPool is filled over time by taking a 10% cut from the Converter</span>
  46 |     | <span class='neutral'> * The Converter is an arbitrage mechanism that allows anyone to sweep the contract balance of a token</span>
  47 |     | <span class='neutral'> * When triggering the Converter, the caller (arbitrager) must send a fixed amount of PSM tokens to the contract</span>
  48 |     | <span class='neutral'> */</span>
  49 |     | <span class='unexecuted'>contract PortalV2MultiAsset is ReentrancyGuard {</span>
  50 |     | <span class='unexecuted'>    constructor(</span>
  51 |     | <span class='neutral'>        address _VIRTUAL_LP,</span>
  52 |     | <span class='neutral'>        uint256 _CONSTANT_PRODUCT,</span>
  53 |     | <span class='neutral'>        address _PRINCIPAL_TOKEN_ADDRESS,</span>
  54 |     | <span class='neutral'>        uint256 _DECIMALS,</span>
  55 |     | <span class='neutral'>        string memory _PRINCIPAL_NAME,</span>
  56 |     | <span class='neutral'>        string memory _PRINCIPAL_SYMBOL,</span>
  57 |     | <span class='neutral'>        string memory _META_DATA_URI</span>
  58 |     | <span class='neutral'>    ) {</span>
  59 |     | <span class='unexecuted'>        if (_VIRTUAL_LP == address(0)) {</span>
  60 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  61 |     | <span class='neutral'>        }</span>
  62 |     | <span class='unexecuted'>        if (_CONSTANT_PRODUCT &lt; 1e25) {</span>
  63 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  64 |     | <span class='neutral'>        }</span>
  65 |     | <span class='unexecuted'>        if (_DECIMALS == 0) {</span>
  66 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  67 |     | <span class='neutral'>        }</span>
  68 |     | <span class='unexecuted'>        if (keccak256(bytes(_PRINCIPAL_NAME)) == keccak256(bytes(&quot;&quot;))) {</span>
  69 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  70 |     | <span class='neutral'>        }</span>
  71 |     | <span class='unexecuted'>        if (keccak256(bytes(_PRINCIPAL_SYMBOL)) == keccak256(bytes(&quot;&quot;))) {</span>
  72 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  73 |     | <span class='neutral'>        }</span>
  74 |     | <span class='unexecuted'>        if (keccak256(bytes(_META_DATA_URI)) == keccak256(bytes(&quot;&quot;))) {</span>
  75 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  76 |     | <span class='neutral'>        }</span>
  77 |     | <span class='neutral'></span>
  78 |     | <span class='unexecuted'>        VIRTUAL_LP = _VIRTUAL_LP;</span>
  79 |     | <span class='unexecuted'>        CONSTANT_PRODUCT = _CONSTANT_PRODUCT;</span>
  80 |     | <span class='unexecuted'>        PRINCIPAL_TOKEN_ADDRESS = _PRINCIPAL_TOKEN_ADDRESS;</span>
  81 |     | <span class='unexecuted'>        DECIMALS_ADJUSTMENT = 10 ** _DECIMALS;</span>
  82 |     | <span class='unexecuted'>        NFT_META_DATA = _META_DATA_URI;</span>
  83 |     | <span class='unexecuted'>        PRINCIPAL_NAME = _PRINCIPAL_NAME;</span>
  84 |     | <span class='unexecuted'>        PRINCIPAL_SYMBOL = _PRINCIPAL_SYMBOL;</span>
  85 |     | <span class='unexecuted'>        CREATION_TIME = block.timestamp;</span>
  86 |     | <span class='unexecuted'>        virtualLP = IVirtualLP(VIRTUAL_LP);</span>
  87 |     | <span class='unexecuted'>        DENOMINATOR = SECONDS_PER_YEAR * DECIMALS_ADJUSTMENT;</span>
  88 |     | <span class='neutral'>    }</span>
  89 |     | <span class='neutral'></span>
  90 |     | <span class='neutral'>    // ============================================</span>
  91 |     | <span class='neutral'>    // ==            GLOBAL VARIABLES            ==</span>
  92 |     | <span class='neutral'>    // ============================================</span>
  93 |     | <span class='neutral'>    using SafeERC20 for IERC20;</span>
  94 |     | <span class='neutral'></span>
  95 |     | <span class='neutral'>    // general</span>
  96 |     | <span class='unexecuted'>    address constant WETH_ADDRESS = 0x82aF49447D8a07e3bd95BD0d56f35241523fBab1;</span>
  97 |     | <span class='unexecuted'>    address constant PSM_ADDRESS = 0x17A8541B82BF67e10B0874284b4Ae66858cb1fd5; // address of PSM token</span>
  98 |     | <span class='unexecuted'>    uint256 constant TERMINAL_MAX_LOCK_DURATION = 157680000; // terminal maximum lock duration of a user stake in seconds (5y)</span>
  99 |     | <span class='unexecuted'>    uint256 constant SECONDS_PER_YEAR = 31536000; // seconds in a 365 day year</span>
 100 |     | <span class='neutral'>    string PRINCIPAL_NAME; // Name of the staking token</span>
 101 |     | <span class='neutral'>    string PRINCIPAL_SYMBOL; // Symbol of the staking token</span>
 102 |     | <span class='neutral'></span>
 103 |     | <span class='unexecuted'>    uint256 public immutable CREATION_TIME; // time stamp of deployment</span>
 104 |     | <span class='unexecuted'>    uint256 public immutable DECIMALS_ADJUSTMENT; // scaling factor to account for the decimals of the principal token</span>
 105 |     | <span class='neutral'>    uint256 private immutable DENOMINATOR;</span>
 106 |     | <span class='neutral'></span>
 107 |     | <span class='unexecuted'>    MintBurnToken public portalEnergyToken; // the ERC20 representation of portalEnergy</span>
 108 |     | <span class='unexecuted'>    PortalNFT public portalNFT; // The NFT contract deployed by the Portal that can store accounts</span>
 109 |     | <span class='unexecuted'>    bool public portalEnergyTokenCreated; // flag for PE token deployment</span>
 110 |     | <span class='unexecuted'>    bool public portalNFTcreated; // flag for Portal NFT contract deployment</span>
 111 |     | <span class='neutral'></span>
 112 |     | <span class='unexecuted'>    address public immutable PRINCIPAL_TOKEN_ADDRESS; // address of the token accepted by the strategy as deposit</span>
 113 |     | <span class='unexecuted'>    string public NFT_META_DATA; // IPFS uri for Portal Position NFTs metadata</span>
 114 |     | <span class='unexecuted'>    uint256 public maxLockDuration = 7776000; // starting value for maximum allowed lock duration of user balance in seconds (90 days)</span>
 115 |     | <span class='unexecuted'>    uint256 public totalPrincipalStaked; // returns how much principal is staked by all users combined</span>
 116 |     | <span class='unexecuted'>    bool public lockDurationUpdateable = true; // flag to signal if the lock duration can still be updated</span>
 117 |     | <span class='neutral'></span>
 118 |     | <span class='neutral'>    // exchange related</span>
 119 |     | <span class='neutral'>    IVirtualLP private virtualLP;</span>
 120 |     | <span class='unexecuted'>    uint256 public immutable CONSTANT_PRODUCT; // The constantProduct with which the Portal will be activated</span>
 121 |     | <span class='unexecuted'>    address public immutable VIRTUAL_LP; // Address of the collective, virtual LP</span>
 122 |     | <span class='unexecuted'>    uint256 public constant LP_PROTECTION_HURDLE = 1; // percent reduction of output amount when minting or buying PE</span>
 123 |     | <span class='neutral'></span>
 124 |     | <span class='neutral'>    // staking related</span>
 125 |     | <span class='neutral'>    struct Account {</span>
 126 |     | <span class='neutral'>        uint256 lastUpdateTime;</span>
 127 |     | <span class='neutral'>        uint256 lastMaxLockDuration;</span>
 128 |     | <span class='neutral'>        uint256 stakedBalance;</span>
 129 |     | <span class='neutral'>        uint256 maxStakeDebt;</span>
 130 |     | <span class='neutral'>        uint256 portalEnergy;</span>
 131 |     | <span class='neutral'>    }</span>
 132 |     | <span class='unexecuted'>    mapping(address =&gt; Account) public accounts; // Associate users with their stake position</span>
 133 |     | <span class='neutral'></span>
 134 |     | <span class='neutral'>    // ============================================</span>
 135 |     | <span class='neutral'>    // ==                EVENTS                  ==</span>
 136 |     | <span class='neutral'>    // ============================================</span>
 137 |     | <span class='neutral'>    // --- Events related to internal exchange PSM vs. portalEnergy ---</span>
 138 |     | <span class='neutral'>    event PortalEnergyBuyExecuted(</span>
 139 |     | <span class='neutral'>        address indexed caller,</span>
 140 |     | <span class='neutral'>        address indexed recipient,</span>
 141 |     | <span class='neutral'>        uint256 amount</span>
 142 |     | <span class='neutral'>    );</span>
 143 |     | <span class='neutral'>    event PortalEnergySellExecuted(</span>
 144 |     | <span class='neutral'>        address indexed caller,</span>
 145 |     | <span class='neutral'>        address indexed recipient,</span>
 146 |     | <span class='neutral'>        uint256 amount</span>
 147 |     | <span class='neutral'>    );</span>
 148 |     | <span class='neutral'></span>
 149 |     | <span class='neutral'>    // --- Events related to minting and burning portalEnergyToken &amp; NFTs ---</span>
 150 |     | <span class='neutral'>    event PortalEnergyMinted(</span>
 151 |     | <span class='neutral'>        address indexed caller,</span>
 152 |     | <span class='neutral'>        address indexed recipient,</span>
 153 |     | <span class='neutral'>        uint256 amount</span>
 154 |     | <span class='neutral'>    );</span>
 155 |     | <span class='neutral'>    event PortalEnergyBurned(</span>
 156 |     | <span class='neutral'>        address indexed caller,</span>
 157 |     | <span class='neutral'>        address indexed recipient,</span>
 158 |     | <span class='neutral'>        uint256 amount</span>
 159 |     | <span class='neutral'>    );</span>
 160 |     | <span class='neutral'></span>
 161 |     | <span class='neutral'>    event PortalNFTminted(</span>
 162 |     | <span class='neutral'>        address indexed caller,</span>
 163 |     | <span class='neutral'>        address indexed recipient,</span>
 164 |     | <span class='neutral'>        uint256 nftID</span>
 165 |     | <span class='neutral'>    );</span>
 166 |     | <span class='neutral'></span>
 167 |     | <span class='neutral'>    event PortalNFTredeemed(</span>
 168 |     | <span class='neutral'>        address indexed caller,</span>
 169 |     | <span class='neutral'>        address indexed recipient,</span>
 170 |     | <span class='neutral'>        uint256 nftID</span>
 171 |     | <span class='neutral'>    );</span>
 172 |     | <span class='neutral'></span>
 173 |     | <span class='neutral'>    // --- Events related to staking &amp; unstaking ---</span>
 174 |     | <span class='neutral'>    event PrincipalStaked(address indexed user, uint256 amountStaked);</span>
 175 |     | <span class='neutral'>    event PrincipalUnstaked(address indexed user, uint256 amountUnstaked);</span>
 176 |     | <span class='neutral'></span>
 177 |     | <span class='neutral'>    event StakePositionUpdated(</span>
 178 |     | <span class='neutral'>        address indexed user,</span>
 179 |     | <span class='neutral'>        uint256 lastUpdateTime,</span>
 180 |     | <span class='neutral'>        uint256 lastMaxLockDuration,</span>
 181 |     | <span class='neutral'>        uint256 stakedBalance,</span>
 182 |     | <span class='neutral'>        uint256 maxStakeDebt,</span>
 183 |     | <span class='neutral'>        uint256 portalEnergy</span>
 184 |     | <span class='neutral'>    );</span>
 185 |     | <span class='neutral'></span>
 186 |     | <span class='neutral'>    // ============================================</span>
 187 |     | <span class='neutral'>    // ==               MODIFIERS                ==</span>
 188 |     | <span class='neutral'>    // ============================================</span>
 189 |     | <span class='neutral'>    modifier activeLP() {</span>
 190 |     | <span class='unexecuted'>        if (!virtualLP.isActiveLP()) {</span>
 191 |     | <span class='unexecuted'>            revert InactiveLP();</span>
 192 |     | <span class='neutral'>        }</span>
 193 |     | <span class='neutral'>        _;</span>
 194 |     | <span class='neutral'>    }</span>
 195 |     | <span class='neutral'></span>
 196 |     | <span class='neutral'>    // ============================================</span>
 197 |     | <span class='neutral'>    // ==           STAKING &amp; UNSTAKING          ==</span>
 198 |     | <span class='neutral'>    // ============================================</span>
 199 |     | <span class='neutral'>    /// @notice Simulate updating a user stake position and return the values without updating the struct</span>
 200 |     | <span class='neutral'>    /// @dev Returns the simulated up-to-date user stake information</span>
 201 |     | <span class='neutral'>    /// @dev Considers changes from staking or unstaking including burning amount of PE tokens</span>
 202 |     | <span class='neutral'>    /// @param _user The user whose stake position is to be updated</span>
 203 |     | <span class='neutral'>    /// @param _amount The amount to add or subtract from the user&#39;s stake position</span>
 204 |     | <span class='neutral'>    /// @param _isPositiveAmount True for staking (add), false for unstaking (subtract)</span>
 205 |     | <span class='unexecuted'>    function getUpdateAccount(</span>
 206 |     | <span class='neutral'>        address _user,</span>
 207 |     | <span class='neutral'>        uint256 _amount,</span>
 208 |     | <span class='neutral'>        bool _isPositiveAmount</span>
 209 |     | <span class='neutral'>    )</span>
 210 |     | <span class='neutral'>        public</span>
 211 |     | <span class='neutral'>        view</span>
 212 |     | <span class='neutral'>        returns (</span>
 213 |     | <span class='unexecuted'>            uint256 lastUpdateTime,</span>
 214 |     | <span class='neutral'>            uint256 lastMaxLockDuration,</span>
 215 |     | <span class='neutral'>            uint256 stakedBalance,</span>
 216 |     | <span class='neutral'>            uint256 maxStakeDebt,</span>
 217 |     | <span class='neutral'>            uint256 portalEnergy,</span>
 218 |     | <span class='neutral'>            uint256 availableToWithdraw,</span>
 219 |     | <span class='neutral'>            uint256 portalEnergyTokensRequired</span>
 220 |     | <span class='neutral'>        )</span>
 221 |     | <span class='unexecuted'>    {</span>
 222 |     | <span class='neutral'>        /// @dev Load user account into memory</span>
 223 |     | <span class='unexecuted'>        Account memory account = accounts[_user];</span>
 224 |     | <span class='neutral'></span>
 225 |     | <span class='neutral'>        /// @dev initialize helper variables</span>
 226 |     | <span class='unexecuted'>        uint256 amount = _amount; // to avoid stack too deep issue</span>
 227 |     | <span class='unexecuted'>        bool isPositive = _isPositiveAmount; // to avoid stack too deep issue</span>
 228 |     | <span class='neutral'>        uint256 portalEnergyNetChange;</span>
 229 |     | <span class='unexecuted'>        uint256 timePassed = block.timestamp - account.lastUpdateTime;</span>
 230 |     | <span class='unexecuted'>        uint256 maxLockDifference = maxLockDuration -</span>
 231 |     | <span class='unexecuted'>            account.lastMaxLockDuration;</span>
 232 |     | <span class='unexecuted'>        uint256 adjustedPE = amount * maxLockDuration * 1e18;</span>
 233 |     | <span class='unexecuted'>        stakedBalance = account.stakedBalance;</span>
 234 |     | <span class='neutral'></span>
 235 |     | <span class='neutral'>        /// @dev Check that the Stake Balance is sufficient for unstaking the amount</span>
 236 |     | <span class='unexecuted'>        if (!isPositive &amp;&amp; amount &gt; stakedBalance) {</span>
 237 |     | <span class='unexecuted'>            revert InsufficientStakeBalance();</span>
 238 |     | <span class='neutral'>        }</span>
 239 |     | <span class='neutral'></span>
 240 |     | <span class='neutral'>        /// @dev Check the user account state based on lastUpdateTime</span>
 241 |     | <span class='neutral'>        /// @dev If this variable is 0, the user never staked and could not earn PE</span>
 242 |     | <span class='unexecuted'>        if (account.lastUpdateTime &gt; 0) {</span>
 243 |     | <span class='neutral'>            /// @dev Calculate the Portal Energy earned since the last update</span>
 244 |     | <span class='unexecuted'>            uint256 portalEnergyEarned = stakedBalance * timePassed;</span>
 245 |     | <span class='neutral'></span>
 246 |     | <span class='neutral'>            /// @dev Calculate the gain of Portal Energy from maxLockDuration increase</span>
 247 |     | <span class='unexecuted'>            uint256 portalEnergyIncrease = stakedBalance * maxLockDifference;</span>
 248 |     | <span class='neutral'></span>
 249 |     | <span class='neutral'>            /// @dev Summarize Portal Energy changes and divide by common denominator</span>
 250 |     | <span class='unexecuted'>            portalEnergyNetChange =</span>
 251 |     | <span class='unexecuted'>                ((portalEnergyEarned + portalEnergyIncrease) * 1e18) /</span>
 252 |     | <span class='unexecuted'>                DENOMINATOR;</span>
 253 |     | <span class='neutral'>        }</span>
 254 |     | <span class='neutral'></span>
 255 |     | <span class='neutral'>        /// @dev Calculate the adjustment of Portal Energy from balance change</span>
 256 |     | <span class='unexecuted'>        uint256 portalEnergyAdjustment = adjustedPE / DENOMINATOR;</span>
 257 |     | <span class='neutral'></span>
 258 |     | <span class='neutral'>        /// @dev Calculate the amount of Portal Energy Tokens to be burned for unstaking the amount</span>
 259 |     | <span class='unexecuted'>        portalEnergyTokensRequired = !isPositive &amp;&amp;</span>
 260 |     | <span class='unexecuted'>            portalEnergyAdjustment &gt;</span>
 261 |     | <span class='unexecuted'>            (account.portalEnergy + portalEnergyNetChange)</span>
 262 |     | <span class='unexecuted'>            ? portalEnergyAdjustment -</span>
 263 |     | <span class='unexecuted'>                (account.portalEnergy + portalEnergyNetChange)</span>
 264 |     | <span class='unexecuted'>            : 0;</span>
 265 |     | <span class='neutral'></span>
 266 |     | <span class='neutral'>        /// @dev Set the last update time to the current timestamp</span>
 267 |     | <span class='unexecuted'>        lastUpdateTime = block.timestamp;</span>
 268 |     | <span class='neutral'></span>
 269 |     | <span class='neutral'>        /// @dev Update the last maxLockDuration</span>
 270 |     | <span class='unexecuted'>        lastMaxLockDuration = maxLockDuration;</span>
 271 |     | <span class='neutral'></span>
 272 |     | <span class='neutral'>        /// @dev Update the user&#39;s staked balance and consider stake or unstake</span>
 273 |     | <span class='unexecuted'>        stakedBalance = isPositive</span>
 274 |     | <span class='unexecuted'>            ? stakedBalance + amount</span>
 275 |     | <span class='unexecuted'>            : stakedBalance - amount;</span>
 276 |     | <span class='neutral'></span>
 277 |     | <span class='neutral'>        /// @dev Update the user&#39;s max stake debt</span>
 278 |     | <span class='unexecuted'>        maxStakeDebt = (stakedBalance * maxLockDuration * 1e18) / DENOMINATOR;</span>
 279 |     | <span class='neutral'></span>
 280 |     | <span class='neutral'>        /// @dev Update the user&#39;s portalEnergy and account for stake or unstake</span>
 281 |     | <span class='neutral'>        /// @dev This will be 0 if Portal Energy Tokens must be burned</span>
 282 |     | <span class='unexecuted'>        portalEnergy = isPositive</span>
 283 |     | <span class='unexecuted'>            ? account.portalEnergy +</span>
 284 |     | <span class='unexecuted'>                portalEnergyNetChange +</span>
 285 |     | <span class='unexecuted'>                portalEnergyAdjustment</span>
 286 |     | <span class='unexecuted'>            : account.portalEnergy +</span>
 287 |     | <span class='unexecuted'>                portalEnergyTokensRequired +</span>
 288 |     | <span class='unexecuted'>                portalEnergyNetChange -</span>
 289 |     | <span class='unexecuted'>                portalEnergyAdjustment;</span>
 290 |     | <span class='neutral'></span>
 291 |     | <span class='neutral'>        /// @dev Update amount available to withdraw</span>
 292 |     | <span class='unexecuted'>        availableToWithdraw = portalEnergy &gt;= maxStakeDebt</span>
 293 |     | <span class='unexecuted'>            ? stakedBalance</span>
 294 |     | <span class='unexecuted'>            : (stakedBalance * portalEnergy) / maxStakeDebt;</span>
 295 |     | <span class='neutral'>    }</span>
 296 |     | <span class='neutral'></span>
 297 |     | <span class='neutral'>    /// @notice Update user data to the current state</span>
 298 |     | <span class='neutral'>    /// @dev This function updates the user data to the current state</span>
 299 |     | <span class='neutral'>    /// @dev It takes memory inputs and stores them into the user account struct</span>
 300 |     | <span class='neutral'>    /// @param _user The user whose data is to be updated</span>
 301 |     | <span class='neutral'>    /// @param _stakedBalance The current Staked Balance of the user</span>
 302 |     | <span class='neutral'>    /// @param _maxStakeDebt The current maximum Stake Debt of the user</span>
 303 |     | <span class='neutral'>    /// @param _portalEnergy The current Portal Energy of the user</span>
 304 |     | <span class='unexecuted'>    function _updateAccount(</span>
 305 |     | <span class='neutral'>        address _user,</span>
 306 |     | <span class='neutral'>        uint256 _stakedBalance,</span>
 307 |     | <span class='neutral'>        uint256 _maxStakeDebt,</span>
 308 |     | <span class='neutral'>        uint256 _portalEnergy</span>
 309 |     | <span class='unexecuted'>    ) private {</span>
 310 |     | <span class='neutral'>        /// @dev Update the user account data</span>
 311 |     | <span class='unexecuted'>        Account storage account = accounts[_user];</span>
 312 |     | <span class='unexecuted'>        account.lastUpdateTime = block.timestamp;</span>
 313 |     | <span class='unexecuted'>        account.lastMaxLockDuration = maxLockDuration;</span>
 314 |     | <span class='unexecuted'>        account.stakedBalance = _stakedBalance;</span>
 315 |     | <span class='unexecuted'>        account.maxStakeDebt = _maxStakeDebt;</span>
 316 |     | <span class='unexecuted'>        account.portalEnergy = _portalEnergy;</span>
 317 |     | <span class='neutral'></span>
 318 |     | <span class='neutral'>        /// @dev Emit an event with the updated stake information</span>
 319 |     | <span class='unexecuted'>        emit StakePositionUpdated(</span>
 320 |     | <span class='neutral'>            _user,</span>
 321 |     | <span class='neutral'>            account.lastUpdateTime,</span>
 322 |     | <span class='neutral'>            account.lastMaxLockDuration,</span>
 323 |     | <span class='neutral'>            account.stakedBalance,</span>
 324 |     | <span class='neutral'>            account.maxStakeDebt,</span>
 325 |     | <span class='neutral'>            account.portalEnergy</span>
 326 |     | <span class='neutral'>        );</span>
 327 |     | <span class='neutral'>    }</span>
 328 |     | <span class='neutral'></span>
 329 |     | <span class='neutral'>    /// @notice Stake the principal token into the Portal &amp; redirect principal to yield source</span>
 330 |     | <span class='neutral'>    /// @dev This function allows users to stake their principal tokens into the Portal</span>
 331 |     | <span class='neutral'>    /// @dev Can only be called if LP is active</span>
 332 |     | <span class='neutral'>    /// @dev Does not follow CEI pattern for optimisation reasons. The handled tokens are trusted.</span>
 333 |     | <span class='neutral'>    /// @dev Update the user account</span>
 334 |     | <span class='neutral'>    /// @dev Update the global tracker of staked principal</span>
 335 |     | <span class='neutral'>    /// @dev Deposit the principal into the yield source (external protocol)</span>
 336 |     | <span class='neutral'>    /// @param _amount The amount of tokens to stake</span>
 337 |     | <span class='unexecuted'>    function stake(uint256 _amount) external payable activeLP nonReentrant {</span>
 338 |     | <span class='neutral'>        /// @dev Convert native ETH to WETH for contract, then send to LP</span>
 339 |     | <span class='neutral'>        /// @dev This section must sit before using _amount elsewhere to guarantee consistency</span>
 340 |     | <span class='neutral'>        /// @dev This knowingly deviates from the CEI pattern</span>
 341 |     | <span class='unexecuted'>        if (PRINCIPAL_TOKEN_ADDRESS == address(0)) {</span>
 342 |     | <span class='neutral'>            /// @dev Wrap ETH into WETH received by the contract</span>
 343 |     | <span class='unexecuted'>            _amount = msg.value;</span>
 344 |     | <span class='unexecuted'>            IWETH(WETH_ADDRESS).deposit{value: _amount}();</span>
 345 |     | <span class='neutral'></span>
 346 |     | <span class='neutral'>            /// @dev Send WETH to virtual LP</span>
 347 |     | <span class='unexecuted'>            IERC20(WETH_ADDRESS).transfer(VIRTUAL_LP, _amount);</span>
 348 |     | <span class='neutral'>        } else {</span>
 349 |     | <span class='neutral'>            /// @dev If not native ETH, transfer principal token to contract</span>
 350 |     | <span class='neutral'>            /// @dev Prevent contract from receiving ETH when principal is ERC20</span>
 351 |     | <span class='unexecuted'>            if (msg.value &gt; 0) {</span>
 352 |     | <span class='unexecuted'>                revert NativeTokenNotAllowed();</span>
 353 |     | <span class='neutral'>            }</span>
 354 |     | <span class='neutral'></span>
 355 |     | <span class='neutral'>            /// @dev Transfer token from user to virtual LP</span>
 356 |     | <span class='unexecuted'>            IERC20(PRINCIPAL_TOKEN_ADDRESS).safeTransferFrom(</span>
 357 |     | <span class='unexecuted'>                msg.sender,</span>
 358 |     | <span class='unexecuted'>                VIRTUAL_LP,</span>
 359 |     | <span class='unexecuted'>                _amount</span>
 360 |     | <span class='neutral'>            );</span>
 361 |     | <span class='neutral'>        }</span>
 362 |     | <span class='neutral'></span>
 363 |     | <span class='neutral'>        /// @dev Revert if the staked amount is zero</span>
 364 |     | <span class='unexecuted'>        if (_amount == 0) {</span>
 365 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 366 |     | <span class='neutral'>        }</span>
 367 |     | <span class='neutral'></span>
 368 |     | <span class='neutral'>        /// @dev Get the current state of the user stake</span>
 369 |     | <span class='unexecuted'>        (</span>
 370 |     | <span class='neutral'>            ,</span>
 371 |     | <span class='neutral'>            ,</span>
 372 |     | <span class='unexecuted'>            uint256 stakedBalance,</span>
 373 |     | <span class='unexecuted'>            uint256 maxStakeDebt,</span>
 374 |     | <span class='unexecuted'>            uint256 portalEnergy,</span>
 375 |     | <span class='neutral'>            ,</span>
 376 |     | <span class='neutral'></span>
 377 |     | <span class='unexecuted'>        ) = getUpdateAccount(msg.sender, _amount, true);</span>
 378 |     | <span class='neutral'></span>
 379 |     | <span class='neutral'>        /// @dev Update the user stake struct</span>
 380 |     | <span class='unexecuted'>        _updateAccount(msg.sender, stakedBalance, maxStakeDebt, portalEnergy);</span>
 381 |     | <span class='neutral'></span>
 382 |     | <span class='neutral'>        /// @dev Update the total stake balance</span>
 383 |     | <span class='unexecuted'>        totalPrincipalStaked += _amount;</span>
 384 |     | <span class='neutral'></span>
 385 |     | <span class='neutral'>        /// @dev Deposit the principal into the yield source (external protocol)</span>
 386 |     | <span class='unexecuted'>        virtualLP.depositToYieldSource(PRINCIPAL_TOKEN_ADDRESS, _amount);</span>
 387 |     | <span class='neutral'></span>
 388 |     | <span class='neutral'>        /// @dev Emit event that the stake was successful</span>
 389 |     | <span class='unexecuted'>        emit PrincipalStaked(msg.sender, _amount);</span>
 390 |     | <span class='neutral'>    }</span>
 391 |     | <span class='neutral'></span>
 392 |     | <span class='neutral'>    /// @notice Serve unstaking requests &amp; withdraw principal from yield source</span>
 393 |     | <span class='neutral'>    /// @dev This function allows users to unstake their tokens</span>
 394 |     | <span class='neutral'>    /// @dev Update the user account</span>
 395 |     | <span class='neutral'>    /// @dev Update the global tracker of staked principal</span>
 396 |     | <span class='neutral'>    /// @dev Burn Portal Energy Tokens from caller to top up account balance if required</span>
 397 |     | <span class='neutral'>    /// @dev Withdraw the matching amount of principal from the yield source (external protocol)</span>
 398 |     | <span class='neutral'>    /// @dev Send the principal tokens to the user</span>
 399 |     | <span class='neutral'>    /// @param _amount The amount of tokens to unstake</span>
 400 |     | <span class='unexecuted'>    function unstake(uint256 _amount) external nonReentrant {</span>
 401 |     | <span class='neutral'>        /// @dev Check that the unstaked amount is greater than zero</span>
 402 |     | <span class='unexecuted'>        if (_amount == 0) {</span>
 403 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 404 |     | <span class='neutral'>        }</span>
 405 |     | <span class='neutral'></span>
 406 |     | <span class='neutral'>        /// @dev Get the current state of the user stake</span>
 407 |     | <span class='neutral'>        /// @dev Throws if caller tries to unstake more than stake balance</span>
 408 |     | <span class='neutral'>        /// @dev Will burn Portal Energy tokens if account has insufficient Portal Energy</span>
 409 |     | <span class='unexecuted'>        (</span>
 410 |     | <span class='neutral'>            ,</span>
 411 |     | <span class='neutral'>            ,</span>
 412 |     | <span class='unexecuted'>            uint256 stakedBalance,</span>
 413 |     | <span class='unexecuted'>            uint256 maxStakeDebt,</span>
 414 |     | <span class='unexecuted'>            uint256 portalEnergy,</span>
 415 |     | <span class='neutral'>            ,</span>
 416 |     | <span class='unexecuted'>            uint256 portalEnergyTokensRequired</span>
 417 |     | <span class='unexecuted'>        ) = getUpdateAccount(msg.sender, _amount, false);</span>
 418 |     | <span class='neutral'></span>
 419 |     | <span class='neutral'>        /// @dev Update the user stake struct</span>
 420 |     | <span class='unexecuted'>        _updateAccount(msg.sender, stakedBalance, maxStakeDebt, portalEnergy);</span>
 421 |     | <span class='neutral'></span>
 422 |     | <span class='neutral'>        /// @dev Update the global tracker of staked principal</span>
 423 |     | <span class='unexecuted'>        totalPrincipalStaked -= _amount;</span>
 424 |     | <span class='neutral'></span>
 425 |     | <span class='neutral'>        /// @dev Burn portalEnergyToken from the caller&#39;s wallet, throws if insufficient balance</span>
 426 |     | <span class='unexecuted'>        if (portalEnergyTokensRequired &gt; 0) {</span>
 427 |     | <span class='unexecuted'>            portalEnergyToken.burnFrom(msg.sender, portalEnergyTokensRequired);</span>
 428 |     | <span class='neutral'>        }</span>
 429 |     | <span class='neutral'></span>
 430 |     | <span class='neutral'>        /// @dev Withdraw the assets from external Protocol and send to user</span>
 431 |     | <span class='unexecuted'>        virtualLP.withdrawFromYieldSource(</span>
 432 |     | <span class='unexecuted'>            PRINCIPAL_TOKEN_ADDRESS,</span>
 433 |     | <span class='unexecuted'>            msg.sender,</span>
 434 |     | <span class='neutral'>            _amount</span>
 435 |     | <span class='neutral'>        );</span>
 436 |     | <span class='neutral'></span>
 437 |     | <span class='neutral'>        /// @dev Emit event that tokens have been unstaked</span>
 438 |     | <span class='unexecuted'>        emit PrincipalUnstaked(msg.sender, _amount);</span>
 439 |     | <span class='neutral'>    }</span>
 440 |     | <span class='neutral'></span>
 441 |     | <span class='neutral'>    // ============================================</span>
 442 |     | <span class='neutral'>    // ==         NFT Position Management        ==</span>
 443 |     | <span class='neutral'>    // ============================================</span>
 444 |     | <span class='neutral'>    /// @notice This function deploys the NFT contract unique to this Portal</span>
 445 |     | <span class='neutral'>    /// @dev Deploy an NFT contract with name and symbol related to the principal token</span>
 446 |     | <span class='neutral'>    /// @dev Can only be called once</span>
 447 |     | <span class='unexecuted'>    function create_portalNFT() external {</span>
 448 |     | <span class='neutral'>        // Check if the NFT contract is already deployed</span>
 449 |     | <span class='unexecuted'>        if (portalNFTcreated) {</span>
 450 |     | <span class='unexecuted'>            revert TokenExists();</span>
 451 |     | <span class='neutral'>        }</span>
 452 |     | <span class='neutral'></span>
 453 |     | <span class='neutral'>        /// @dev Update the token creation flag to prevent future calls</span>
 454 |     | <span class='unexecuted'>        portalNFTcreated = true;</span>
 455 |     | <span class='neutral'></span>
 456 |     | <span class='neutral'>        /// @dev Build the NFT contract with name and symbol based on the principal token of this Portal</span>
 457 |     | <span class='unexecuted'>        string memory name = concatenate(&quot;Portal-Position-&quot;, PRINCIPAL_NAME);</span>
 458 |     | <span class='neutral'></span>
 459 |     | <span class='unexecuted'>        string memory symbol = concatenate(&quot;P-&quot;, PRINCIPAL_SYMBOL);</span>
 460 |     | <span class='neutral'></span>
 461 |     | <span class='neutral'>        /// @dev Deploy the token and update the related storage variable so that other functions can work</span>
 462 |     | <span class='unexecuted'>        portalNFT = new PortalNFT(</span>
 463 |     | <span class='unexecuted'>            DECIMALS_ADJUSTMENT,</span>
 464 |     | <span class='unexecuted'>            name,</span>
 465 |     | <span class='unexecuted'>            symbol,</span>
 466 |     | <span class='unexecuted'>            NFT_META_DATA</span>
 467 |     | <span class='neutral'>        );</span>
 468 |     | <span class='neutral'>    }</span>
 469 |     | <span class='neutral'></span>
 470 |     | <span class='neutral'>    /// @notice This function allows users to store their Account in a transferrable NFT</span>
 471 |     | <span class='neutral'>    /// @dev Mint a Portal NFT with the vital information of caller account to a recipient</span>
 472 |     | <span class='neutral'>    /// @dev Delete the caller account</span>
 473 |     | <span class='unexecuted'>    function mintNFTposition(address _recipient) external {</span>
 474 |     | <span class='neutral'>        /// @dev Check that the recipient is a valid address</span>
 475 |     | <span class='unexecuted'>        if (_recipient == address(0)) {</span>
 476 |     | <span class='unexecuted'>            revert InvalidAddress();</span>
 477 |     | <span class='neutral'>        }</span>
 478 |     | <span class='neutral'></span>
 479 |     | <span class='neutral'>        /// @dev Get the current state of the user stake</span>
 480 |     | <span class='unexecuted'>        (</span>
 481 |     | <span class='neutral'>            ,</span>
 482 |     | <span class='unexecuted'>            uint256 lastMaxLockDuration,</span>
 483 |     | <span class='unexecuted'>            uint256 stakedBalance,</span>
 484 |     | <span class='neutral'>            ,</span>
 485 |     | <span class='unexecuted'>            uint256 portalEnergy,</span>
 486 |     | <span class='neutral'>            ,</span>
 487 |     | <span class='neutral'></span>
 488 |     | <span class='unexecuted'>        ) = getUpdateAccount(msg.sender, 0, true);</span>
 489 |     | <span class='neutral'></span>
 490 |     | <span class='neutral'>        // check that caller has an account with PE or staked balance &gt; 0</span>
 491 |     | <span class='unexecuted'>        if (portalEnergy == 0 &amp;&amp; stakedBalance == 0) {</span>
 492 |     | <span class='unexecuted'>            revert EmptyAccount();</span>
 493 |     | <span class='neutral'>        }</span>
 494 |     | <span class='neutral'>        /// @dev delete the caller account</span>
 495 |     | <span class='unexecuted'>        delete accounts[msg.sender];</span>
 496 |     | <span class='neutral'></span>
 497 |     | <span class='neutral'>        /// @dev mint NFT to recipient containing the account information, get the returned ID</span>
 498 |     | <span class='unexecuted'>        uint256 nftID = portalNFT.mint(</span>
 499 |     | <span class='neutral'>            _recipient,</span>
 500 |     | <span class='neutral'>            lastMaxLockDuration,</span>
 501 |     | <span class='neutral'>            stakedBalance,</span>
 502 |     | <span class='neutral'>            portalEnergy</span>
 503 |     | <span class='neutral'>        );</span>
 504 |     | <span class='neutral'></span>
 505 |     | <span class='neutral'>        /// @dev Emit event that the NFT was minted</span>
 506 |     | <span class='unexecuted'>        emit PortalNFTminted(msg.sender, _recipient, nftID);</span>
 507 |     | <span class='neutral'>    }</span>
 508 |     | <span class='neutral'></span>
 509 |     | <span class='neutral'>    /// @notice This function allows users to redeem (burn) their PortalNFT for its content</span>
 510 |     | <span class='neutral'>    /// @dev Update the user account to current state. Required because stake balance can change which impacts PE earning</span>
 511 |     | <span class='neutral'>    /// @dev Burn the NFT and retrieve its balances (stake balance &amp; portalEnergy)</span>
 512 |     | <span class='neutral'>    /// @dev Add the NFT values to the account of the user</span>
 513 |     | <span class='unexecuted'>    function redeemNFTposition(uint256 _tokenId) external {</span>
 514 |     | <span class='neutral'>        /// @dev Get the current state of the user Account</span>
 515 |     | <span class='unexecuted'>        (</span>
 516 |     | <span class='neutral'>            ,</span>
 517 |     | <span class='neutral'>            ,</span>
 518 |     | <span class='unexecuted'>            uint256 stakedBalance,</span>
 519 |     | <span class='unexecuted'>            uint256 maxStakeDebt,</span>
 520 |     | <span class='unexecuted'>            uint256 portalEnergy,</span>
 521 |     | <span class='neutral'>            ,</span>
 522 |     | <span class='neutral'></span>
 523 |     | <span class='unexecuted'>        ) = getUpdateAccount(msg.sender, 0, true);</span>
 524 |     | <span class='neutral'></span>
 525 |     | <span class='neutral'>        /// @dev Redeem the NFT and get the returned paramters</span>
 526 |     | <span class='unexecuted'>        (uint256 stakedBalanceNFT, uint256 portalEnergyNFT) = portalNFT.redeem(</span>
 527 |     | <span class='unexecuted'>            msg.sender,</span>
 528 |     | <span class='neutral'>            _tokenId</span>
 529 |     | <span class='neutral'>        );</span>
 530 |     | <span class='neutral'></span>
 531 |     | <span class='neutral'>        /// @dev Update user Account</span>
 532 |     | <span class='unexecuted'>        stakedBalance += stakedBalanceNFT;</span>
 533 |     | <span class='unexecuted'>        portalEnergy += portalEnergyNFT;</span>
 534 |     | <span class='unexecuted'>        maxStakeDebt = (stakedBalance * maxLockDuration * 1e18) / DENOMINATOR;</span>
 535 |     | <span class='unexecuted'>        _updateAccount(msg.sender, stakedBalance, maxStakeDebt, portalEnergy);</span>
 536 |     | <span class='neutral'></span>
 537 |     | <span class='neutral'>        /// @dev Emit event that the Portal NFT was redeemed</span>
 538 |     | <span class='unexecuted'>        emit PortalNFTredeemed(msg.sender, msg.sender, _tokenId);</span>
 539 |     | <span class='neutral'>    }</span>
 540 |     | <span class='neutral'></span>
 541 |     | <span class='neutral'>    // ============================================</span>
 542 |     | <span class='neutral'>    // ==               VIRTUAL LP               ==</span>
 543 |     | <span class='neutral'>    // ============================================</span>
 544 |     | <span class='neutral'>    /// @notice Users sell PSM into the Portal to top up portalEnergy balance of a recipient</span>
 545 |     | <span class='neutral'>    /// @dev This function allows users to sell PSM tokens to the contract to increase a recipient portalEnergy</span>
 546 |     | <span class='neutral'>    /// @dev Get the correct price from the quote function</span>
 547 |     | <span class='neutral'>    /// @dev Increase the portalEnergy of the recipient by the amount of portalEnergy received</span>
 548 |     | <span class='neutral'>    /// @dev Transfer the PSM tokens from the caller to the contract</span>
 549 |     | <span class='neutral'>    /// @param _recipient The recipient of the Portal Energy credit</span>
 550 |     | <span class='neutral'>    /// @param _amountInputPSM The amount of PSM tokens to sell</span>
 551 |     | <span class='neutral'>    /// @param _minReceived The minimum amount of portalEnergy to receive</span>
 552 |     | <span class='neutral'>    /// @param _deadline The unix timestamp that marks the deadline for order execution</span>
 553 |     | <span class='unexecuted'>    function buyPortalEnergy(</span>
 554 |     | <span class='neutral'>        address _recipient,</span>
 555 |     | <span class='neutral'>        uint256 _amountInputPSM,</span>
 556 |     | <span class='neutral'>        uint256 _minReceived,</span>
 557 |     | <span class='neutral'>        uint256 _deadline</span>
 558 |     | <span class='unexecuted'>    ) external nonReentrant {</span>
 559 |     | <span class='neutral'>        /// @dev Check that the input amount &amp; minimum received is greater than zero</span>
 560 |     | <span class='unexecuted'>        if (_amountInputPSM == 0 || _minReceived == 0) {</span>
 561 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 562 |     | <span class='neutral'>        }</span>
 563 |     | <span class='neutral'></span>
 564 |     | <span class='neutral'>        /// @dev Check that the recipient is a valid address</span>
 565 |     | <span class='unexecuted'>        if (_recipient == address(0)) {</span>
 566 |     | <span class='unexecuted'>            revert InvalidAddress();</span>
 567 |     | <span class='neutral'>        }</span>
 568 |     | <span class='neutral'></span>
 569 |     | <span class='neutral'>        /// @dev Check that the deadline has not expired</span>
 570 |     | <span class='unexecuted'>        if (_deadline &lt; block.timestamp) {</span>
 571 |     | <span class='unexecuted'>            revert DeadlineExpired();</span>
 572 |     | <span class='neutral'>        }</span>
 573 |     | <span class='neutral'></span>
 574 |     | <span class='neutral'>        /// @dev Get the amount of portalEnergy received based on the amount of PSM tokens sold</span>
 575 |     | <span class='unexecuted'>        uint256 amountReceived = quoteBuyPortalEnergy(_amountInputPSM);</span>
 576 |     | <span class='neutral'></span>
 577 |     | <span class='neutral'>        /// @dev Check that the amount of portalEnergy received is greater than or equal to the minimum expected output</span>
 578 |     | <span class='unexecuted'>        if (amountReceived &lt; _minReceived) {</span>
 579 |     | <span class='unexecuted'>            revert InsufficientReceived();</span>
 580 |     | <span class='neutral'>        }</span>
 581 |     | <span class='neutral'></span>
 582 |     | <span class='neutral'>        /// @dev Increase the portalEnergy of the recipient by the amount of portalEnergy received</span>
 583 |     | <span class='unexecuted'>        accounts[_recipient].portalEnergy += amountReceived;</span>
 584 |     | <span class='neutral'></span>
 585 |     | <span class='neutral'>        /// @dev Transfer the PSM tokens from the caller to the Virtual LP</span>
 586 |     | <span class='unexecuted'>        IERC20(PSM_ADDRESS).transferFrom(</span>
 587 |     | <span class='unexecuted'>            msg.sender,</span>
 588 |     | <span class='unexecuted'>            VIRTUAL_LP,</span>
 589 |     | <span class='neutral'>            _amountInputPSM</span>
 590 |     | <span class='neutral'>        );</span>
 591 |     | <span class='neutral'></span>
 592 |     | <span class='neutral'>        /// @dev Emit the portalEnergyBuyExecuted event</span>
 593 |     | <span class='unexecuted'>        emit PortalEnergyBuyExecuted(msg.sender, _recipient, amountReceived);</span>
 594 |     | <span class='neutral'>    }</span>
 595 |     | <span class='neutral'></span>
 596 |     | <span class='neutral'>    /// @notice Users sell portalEnergy into the Portal to receive PSM to a recipient address</span>
 597 |     | <span class='neutral'>    /// @dev This function allows users to sell portalEnergy to the contract to increase a recipient PSM</span>
 598 |     | <span class='neutral'>    /// @dev Get the output amount from the quote function</span>
 599 |     | <span class='neutral'>    /// @dev Reduce the portalEnergy balance of the caller by the amount of portalEnergy sold</span>
 600 |     | <span class='neutral'>    /// @dev Send PSM to the recipient</span>
 601 |     | <span class='neutral'>    /// @param _recipient The recipient of the PSM tokens</span>
 602 |     | <span class='neutral'>    /// @param _amountInputPE The amount of Portal Energy to sell</span>
 603 |     | <span class='neutral'>    /// @param _minReceived The minimum amount of PSM to receive</span>
 604 |     | <span class='neutral'>    /// @param _deadline The unix timestamp that marks the deadline for order execution</span>
 605 |     | <span class='unexecuted'>    function sellPortalEnergy(</span>
 606 |     | <span class='neutral'>        address _recipient,</span>
 607 |     | <span class='neutral'>        uint256 _amountInputPE,</span>
 608 |     | <span class='neutral'>        uint256 _minReceived,</span>
 609 |     | <span class='neutral'>        uint256 _deadline</span>
 610 |     | <span class='unexecuted'>    ) external nonReentrant {</span>
 611 |     | <span class='neutral'>        /// @dev Check that the input amount &amp; minimum received is greater than zero</span>
 612 |     | <span class='unexecuted'>        if (_amountInputPE == 0 || _minReceived == 0) {</span>
 613 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 614 |     | <span class='neutral'>        }</span>
 615 |     | <span class='neutral'></span>
 616 |     | <span class='neutral'>        /// @dev Check that the recipient is a valid address</span>
 617 |     | <span class='unexecuted'>        if (_recipient == address(0)) {</span>
 618 |     | <span class='unexecuted'>            revert InvalidAddress();</span>
 619 |     | <span class='neutral'>        }</span>
 620 |     | <span class='neutral'></span>
 621 |     | <span class='neutral'>        /// @dev Check that the deadline has not expired</span>
 622 |     | <span class='unexecuted'>        if (_deadline &lt; block.timestamp) {</span>
 623 |     | <span class='unexecuted'>            revert DeadlineExpired();</span>
 624 |     | <span class='neutral'>        }</span>
 625 |     | <span class='neutral'></span>
 626 |     | <span class='neutral'>        /// @dev Get the current state of user stake</span>
 627 |     | <span class='unexecuted'>        (</span>
 628 |     | <span class='neutral'>            ,</span>
 629 |     | <span class='neutral'>            ,</span>
 630 |     | <span class='unexecuted'>            uint256 stakedBalance,</span>
 631 |     | <span class='unexecuted'>            uint256 maxStakeDebt,</span>
 632 |     | <span class='unexecuted'>            uint256 portalEnergy,</span>
 633 |     | <span class='neutral'>            ,</span>
 634 |     | <span class='neutral'></span>
 635 |     | <span class='unexecuted'>        ) = getUpdateAccount(msg.sender, 0, true);</span>
 636 |     | <span class='neutral'></span>
 637 |     | <span class='neutral'>        /// @dev Require that the user has enough portalEnergy to sell</span>
 638 |     | <span class='unexecuted'>        if (portalEnergy &lt; _amountInputPE) {</span>
 639 |     | <span class='unexecuted'>            revert InsufficientBalance();</span>
 640 |     | <span class='neutral'>        }</span>
 641 |     | <span class='neutral'></span>
 642 |     | <span class='neutral'>        /// @dev Calculate the amount of output token received based on the amount of portalEnergy sold</span>
 643 |     | <span class='unexecuted'>        uint256 amountReceived = quoteSellPortalEnergy(_amountInputPE);</span>
 644 |     | <span class='neutral'></span>
 645 |     | <span class='neutral'>        /// @dev Check that the amount of output token received is greater than or equal to the minimum expected output</span>
 646 |     | <span class='unexecuted'>        if (amountReceived &lt; _minReceived) {</span>
 647 |     | <span class='unexecuted'>            revert InsufficientReceived();</span>
 648 |     | <span class='neutral'>        }</span>
 649 |     | <span class='neutral'></span>
 650 |     | <span class='neutral'>        /// @dev Calculate the user post-trade Portal Energy balance</span>
 651 |     | <span class='unexecuted'>        portalEnergy -= _amountInputPE;</span>
 652 |     | <span class='neutral'></span>
 653 |     | <span class='neutral'>        /// @dev Update the user stake struct</span>
 654 |     | <span class='unexecuted'>        _updateAccount(msg.sender, stakedBalance, maxStakeDebt, portalEnergy);</span>
 655 |     | <span class='neutral'></span>
 656 |     | <span class='neutral'>        /// @dev Instruct the Virtual LP to send PSM directly to the recipient</span>
 657 |     | <span class='unexecuted'>        virtualLP.PSM_sendToPortalUser(_recipient, amountReceived);</span>
 658 |     | <span class='neutral'></span>
 659 |     | <span class='neutral'>        /// @dev Emit the portalEnergySellExecuted event</span>
 660 |     | <span class='unexecuted'>        emit PortalEnergySellExecuted(msg.sender, _recipient, _amountInputPE);</span>
 661 |     | <span class='neutral'>    }</span>
 662 |     | <span class='neutral'></span>
 663 |     | <span class='neutral'>    /// @notice Simulate buying portalEnergy (output) with PSM tokens (input) and return amount received (output)</span>
 664 |     | <span class='neutral'>    /// @dev This function allows the caller to simulate a portalEnergy buy order of any size</span>
 665 |     | <span class='neutral'>    /// @dev Can only be called when the LP is active to avoid bad output and to prevent exchange</span>
 666 |     | <span class='neutral'>    /// @dev Update the token reserves to get the exchange price</span>
 667 |     | <span class='neutral'>    /// @param _amountInputPSM The amount of PSM tokens sold</span>
 668 |     | <span class='neutral'>    /// @return amountReceived The amount of portalEnergy received by the recipient</span>
 669 |     | <span class='unexecuted'>    function quoteBuyPortalEnergy(</span>
 670 |     | <span class='neutral'>        uint256 _amountInputPSM</span>
 671 |     | <span class='unexecuted'>    ) public view activeLP returns (uint256 amountReceived) {</span>
 672 |     | <span class='neutral'>        /// @dev Calculate the PSM token reserve (input)</span>
 673 |     | <span class='unexecuted'>        uint256 reserve0 = IERC20(PSM_ADDRESS).balanceOf(VIRTUAL_LP) -</span>
 674 |     | <span class='unexecuted'>            virtualLP.fundingRewardPool();</span>
 675 |     | <span class='neutral'></span>
 676 |     | <span class='neutral'>        /// @dev Calculate the reserve of portalEnergy (output)</span>
 677 |     | <span class='unexecuted'>        uint256 reserve1 = CONSTANT_PRODUCT / reserve0;</span>
 678 |     | <span class='neutral'></span>
 679 |     | <span class='neutral'>        /// @dev Reduce amount by the LP Protection Hurdle to prevent sandwich attacks</span>
 680 |     | <span class='unexecuted'>        _amountInputPSM =</span>
 681 |     | <span class='unexecuted'>            (_amountInputPSM * (100 - LP_PROTECTION_HURDLE)) /</span>
 682 |     | <span class='unexecuted'>            100;</span>
 683 |     | <span class='neutral'></span>
 684 |     | <span class='neutral'>        /// @dev Calculate the amount of portalEnergy received based on the amount of PSM tokens sold</span>
 685 |     | <span class='neutral'>        amountReceived =</span>
 686 |     | <span class='unexecuted'>            (_amountInputPSM * reserve1) /</span>
 687 |     | <span class='unexecuted'>            (_amountInputPSM + reserve0);</span>
 688 |     | <span class='neutral'>    }</span>
 689 |     | <span class='neutral'></span>
 690 |     | <span class='neutral'>    /// @notice Simulate selling portalEnergy (input) against PSM tokens (output) and return amount received (output)</span>
 691 |     | <span class='neutral'>    /// @dev This function allows the caller to simulate a portalEnergy sell order of any size</span>
 692 |     | <span class='neutral'>    /// @dev Can only be called when the LP is active to avoid bad output and to prevent exchange</span>
 693 |     | <span class='neutral'>    /// @dev Update the token reserves to get the exchange price</span>
 694 |     | <span class='neutral'>    /// @param _amountInputPE The amount of Portal Energy sold</span>
 695 |     | <span class='neutral'>    /// @return amountReceived The amount of PSM tokens received by the recipient</span>
 696 |     | <span class='unexecuted'>    function quoteSellPortalEnergy(</span>
 697 |     | <span class='neutral'>        uint256 _amountInputPE</span>
 698 |     | <span class='unexecuted'>    ) public view activeLP returns (uint256 amountReceived) {</span>
 699 |     | <span class='neutral'>        /// @dev Calculate the PSM token reserve (output)</span>
 700 |     | <span class='unexecuted'>        uint256 reserve0 = IERC20(PSM_ADDRESS).balanceOf(VIRTUAL_LP) -</span>
 701 |     | <span class='unexecuted'>            virtualLP.fundingRewardPool();</span>
 702 |     | <span class='neutral'></span>
 703 |     | <span class='neutral'>        /// @dev Calculate the reserve of portalEnergy (input)</span>
 704 |     | <span class='neutral'>        /// @dev Avoid zero value to prevent theoretical drainer attack by donating PSM before selling 1 PE</span>
 705 |     | <span class='unexecuted'>        uint256 reserve1 = (reserve0 &gt; CONSTANT_PRODUCT)</span>
 706 |     | <span class='unexecuted'>            ? 1</span>
 707 |     | <span class='unexecuted'>            : CONSTANT_PRODUCT / reserve0;</span>
 708 |     | <span class='neutral'></span>
 709 |     | <span class='neutral'>        /// @dev Calculate the amount of PSM tokens received based on the amount of portalEnergy sold</span>
 710 |     | <span class='unexecuted'>        amountReceived =</span>
 711 |     | <span class='unexecuted'>            (_amountInputPE * reserve0) /</span>
 712 |     | <span class='unexecuted'>            (_amountInputPE + reserve1);</span>
 713 |     | <span class='neutral'>    }</span>
 714 |     | <span class='neutral'></span>
 715 |     | <span class='neutral'>    // ============================================</span>
 716 |     | <span class='neutral'>    // ==           GENERAL FUNCTIONS            ==</span>
 717 |     | <span class='neutral'>    // ============================================</span>
 718 |     | <span class='neutral'>    /// @notice Concatenates two strings and returns the result string</span>
 719 |     | <span class='neutral'>    /// @dev This is a helper function to concatenate two strings into one</span>
 720 |     | <span class='neutral'>    /// @dev Used for automatic token naming</span>
 721 |     | <span class='unexecuted'>    function concatenate(</span>
 722 |     | <span class='neutral'>        string memory a,</span>
 723 |     | <span class='neutral'>        string memory b</span>
 724 |     | <span class='unexecuted'>    ) internal pure returns (string memory) {</span>
 725 |     | <span class='unexecuted'>        return string(abi.encodePacked(a, b));</span>
 726 |     | <span class='neutral'>    }</span>
 727 |     | <span class='neutral'></span>
 728 |     | <span class='neutral'>    /// @notice Deploy the Portal Energy Token of this Portal</span>
 729 |     | <span class='neutral'>    /// @dev This function deploys the PortalEnergyToken of this Portal with the Portal as owner</span>
 730 |     | <span class='neutral'>    /// @dev Can only be called once</span>
 731 |     | <span class='unexecuted'>    function create_portalEnergyToken() external {</span>
 732 |     | <span class='unexecuted'>        if (portalEnergyTokenCreated) {</span>
 733 |     | <span class='unexecuted'>            revert TokenExists();</span>
 734 |     | <span class='neutral'>        }</span>
 735 |     | <span class='neutral'></span>
 736 |     | <span class='neutral'>        /// @dev Update the token creation flag to prevent future calls.</span>
 737 |     | <span class='unexecuted'>        portalEnergyTokenCreated = true;</span>
 738 |     | <span class='neutral'></span>
 739 |     | <span class='neutral'>        /// @dev Build the token name and symbol based on the principal token of this Portal.</span>
 740 |     | <span class='unexecuted'>        string memory name = concatenate(&quot;PE-&quot;, PRINCIPAL_NAME);</span>
 741 |     | <span class='neutral'></span>
 742 |     | <span class='unexecuted'>        string memory symbol = concatenate(&quot;PE-&quot;, PRINCIPAL_SYMBOL);</span>
 743 |     | <span class='neutral'></span>
 744 |     | <span class='neutral'>        /// @dev Deploy the token and update the related storage variable so that other functions can work.</span>
 745 |     | <span class='unexecuted'>        portalEnergyToken = new MintBurnToken(name, symbol);</span>
 746 |     | <span class='neutral'>    }</span>
 747 |     | <span class='neutral'></span>
 748 |     | <span class='neutral'>    /// @notice Users can burn their PortalEnergyTokens to increase portalEnergy of a recipient</span>
 749 |     | <span class='neutral'>    /// @dev This function allows users to burn PortalEnergyTokens for internal portalEnergy</span>
 750 |     | <span class='neutral'>    /// @dev Burn PortalEnergyTokens of caller and increase portalEnergy of the recipient</span>
 751 |     | <span class='neutral'>    /// @param _recipient The recipient of the portalEnergy increase</span>
 752 |     | <span class='neutral'>    /// @param _amount The amount of portalEnergyToken to burn</span>
 753 |     | <span class='unexecuted'>    function burnPortalEnergyToken(</span>
 754 |     | <span class='neutral'>        address _recipient,</span>
 755 |     | <span class='neutral'>        uint256 _amount</span>
 756 |     | <span class='neutral'>    ) external {</span>
 757 |     | <span class='neutral'>        /// @dev Check for zero value inputs</span>
 758 |     | <span class='unexecuted'>        if (_amount == 0) {</span>
 759 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 760 |     | <span class='neutral'>        }</span>
 761 |     | <span class='unexecuted'>        if (_recipient == address(0)) {</span>
 762 |     | <span class='unexecuted'>            revert InvalidAddress();</span>
 763 |     | <span class='neutral'>        }</span>
 764 |     | <span class='neutral'></span>
 765 |     | <span class='neutral'>        /// @dev Increase the portalEnergy of the recipient by the amount of portalEnergyToken burned</span>
 766 |     | <span class='unexecuted'>        accounts[_recipient].portalEnergy += _amount;</span>
 767 |     | <span class='neutral'></span>
 768 |     | <span class='neutral'>        /// @dev Burn portalEnergyToken from the caller&#39;s wallet</span>
 769 |     | <span class='unexecuted'>        portalEnergyToken.burnFrom(msg.sender, _amount);</span>
 770 |     | <span class='neutral'></span>
 771 |     | <span class='neutral'>        /// @dev Emit the event that the ERC20 representation has been burned and value accrued to recipient</span>
 772 |     | <span class='unexecuted'>        emit PortalEnergyBurned(msg.sender, _recipient, _amount);</span>
 773 |     | <span class='neutral'>    }</span>
 774 |     | <span class='neutral'></span>
 775 |     | <span class='neutral'>    /// @notice Users can mint portalEnergyToken to a recipient address using their internal balance</span>
 776 |     | <span class='neutral'>    /// @dev This function controls the minting of PortalEnergyToken</span>
 777 |     | <span class='neutral'>    /// @dev Decrease portalEnergy of caller and mint PortalEnergyTokens to the recipient</span>
 778 |     | <span class='neutral'>    /// @dev Contract must be owner of the PortalEnergyToken</span>
 779 |     | <span class='neutral'>    /// @param _recipient The recipient of the portalEnergyToken</span>
 780 |     | <span class='neutral'>    /// @param _amount The amount of portalEnergyToken to mint</span>
 781 |     | <span class='unexecuted'>    function mintPortalEnergyToken(</span>
 782 |     | <span class='neutral'>        address _recipient,</span>
 783 |     | <span class='neutral'>        uint256 _amount</span>
 784 |     | <span class='neutral'>    ) external {</span>
 785 |     | <span class='neutral'>        /// @dev Check for zero value inputs</span>
 786 |     | <span class='unexecuted'>        if (_amount == 0) {</span>
 787 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 788 |     | <span class='neutral'>        }</span>
 789 |     | <span class='unexecuted'>        if (_recipient == address(0)) {</span>
 790 |     | <span class='unexecuted'>            revert InvalidAddress();</span>
 791 |     | <span class='neutral'>        }</span>
 792 |     | <span class='neutral'></span>
 793 |     | <span class='neutral'>        /// @dev Get the current state of the user stake</span>
 794 |     | <span class='unexecuted'>        (</span>
 795 |     | <span class='neutral'>            ,</span>
 796 |     | <span class='neutral'>            ,</span>
 797 |     | <span class='unexecuted'>            uint256 stakedBalance,</span>
 798 |     | <span class='unexecuted'>            uint256 maxStakeDebt,</span>
 799 |     | <span class='unexecuted'>            uint256 portalEnergy,</span>
 800 |     | <span class='neutral'>            ,</span>
 801 |     | <span class='neutral'></span>
 802 |     | <span class='unexecuted'>        ) = getUpdateAccount(msg.sender, 0, true);</span>
 803 |     | <span class='neutral'></span>
 804 |     | <span class='neutral'>        /// @dev Check that the caller has sufficient portalEnergy to mint the amount of portalEnergyToken</span>
 805 |     | <span class='unexecuted'>        if (portalEnergy &lt; _amount) {</span>
 806 |     | <span class='unexecuted'>            revert InsufficientBalance();</span>
 807 |     | <span class='neutral'>        }</span>
 808 |     | <span class='neutral'></span>
 809 |     | <span class='neutral'>        /// @dev Reduce the portalEnergy of the caller by the amount of minted tokens</span>
 810 |     | <span class='unexecuted'>        portalEnergy -= _amount;</span>
 811 |     | <span class='neutral'></span>
 812 |     | <span class='neutral'>        /// @dev Update the user stake struct</span>
 813 |     | <span class='unexecuted'>        _updateAccount(msg.sender, stakedBalance, maxStakeDebt, portalEnergy);</span>
 814 |     | <span class='neutral'></span>
 815 |     | <span class='neutral'>        /// @dev Mint portal energy tokens to the recipient&#39;s wallet</span>
 816 |     | <span class='unexecuted'>        portalEnergyToken.mint(_recipient, _amount);</span>
 817 |     | <span class='neutral'></span>
 818 |     | <span class='neutral'>        /// @dev Emit the event that the ERC20 representation has been minted to recipient</span>
 819 |     | <span class='unexecuted'>        emit PortalEnergyMinted(msg.sender, _recipient, _amount);</span>
 820 |     | <span class='neutral'>    }</span>
 821 |     | <span class='neutral'></span>
 822 |     | <span class='neutral'>    /// @notice Update the maximum lock duration up to the terminal value</span>
 823 |     | <span class='neutral'>    /// @dev Update the maximum lock duration up to the terminal value</span>
 824 |     | <span class='unexecuted'>    function updateMaxLockDuration() external {</span>
 825 |     | <span class='neutral'>        /// @dev Require that the lock duration can be updated</span>
 826 |     | <span class='unexecuted'>        if (lockDurationUpdateable == false) {</span>
 827 |     | <span class='unexecuted'>            revert DurationLocked();</span>
 828 |     | <span class='neutral'>        }</span>
 829 |     | <span class='neutral'></span>
 830 |     | <span class='neutral'>        /// @dev Calculate new lock duration</span>
 831 |     | <span class='unexecuted'>        uint256 newValue = 2 * (block.timestamp - CREATION_TIME);</span>
 832 |     | <span class='neutral'></span>
 833 |     | <span class='neutral'>        /// @dev Require that the new value will be larger than the existing value</span>
 834 |     | <span class='unexecuted'>        if (newValue &lt;= maxLockDuration) {</span>
 835 |     | <span class='unexecuted'>            revert DurationTooLow();</span>
 836 |     | <span class='neutral'>        }</span>
 837 |     | <span class='neutral'></span>
 838 |     | <span class='unexecuted'>        if (newValue &gt;= TERMINAL_MAX_LOCK_DURATION) {</span>
 839 |     | <span class='unexecuted'>            maxLockDuration = TERMINAL_MAX_LOCK_DURATION;</span>
 840 |     | <span class='unexecuted'>            lockDurationUpdateable = false;</span>
 841 |     | <span class='unexecuted'>        } else if (newValue &gt; maxLockDuration) {</span>
 842 |     | <span class='unexecuted'>            maxLockDuration = newValue;</span>
 843 |     | <span class='neutral'>        }</span>
 844 |     | <span class='neutral'>    }</span>
 845 |     | <span class='neutral'>}</span>
 846 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/VirtualLP.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-2.0-only</span>
   2 |     | <span class='neutral'>pragma solidity =0.8.19;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import {MintBurnToken} from &quot;./MintBurnToken.sol&quot;;</span>
   5 |     | <span class='neutral'>import {IWater} from &quot;./interfaces/IWater.sol&quot;;</span>
   6 |     | <span class='neutral'>import {ISingleStaking} from &quot;./interfaces/ISingleStaking.sol&quot;;</span>
   7 |     | <span class='neutral'>import {IDualStaking} from &quot;./interfaces/IDualStaking.sol&quot;;</span>
   8 |     | <span class='neutral'>import {IPortalV2MultiAsset} from &quot;./interfaces/IPortalV2MultiAsset.sol&quot;;</span>
   9 |     | <span class='neutral'>import {IERC20} from &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  10 |     | <span class='neutral'>import {ERC20} from &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  11 |     | <span class='neutral'>import {SafeERC20} from &quot;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&quot;;</span>
  12 |     | <span class='neutral'>import {ReentrancyGuard} from &quot;@openzeppelin/contracts/security/ReentrancyGuard.sol&quot;;</span>
  13 |     | <span class='neutral'></span>
  14 |     | <span class='neutral'>interface IWETH {</span>
  15 |     | <span class='neutral'>    function withdrawTo(address _account, uint256 _amount) external;</span>
  16 |     | <span class='neutral'>}</span>
  17 |     | <span class='neutral'></span>
  18 |     | <span class='neutral'>// ============================================</span>
  19 |     | <span class='neutral'>// ==              CUSTOM ERRORS             ==</span>
  20 |     | <span class='neutral'>// ============================================</span>
  21 |     | <span class='neutral'>error InactiveLP();</span>
  22 |     | <span class='neutral'>error ActiveLP();</span>
  23 |     | <span class='neutral'>error NotOwner();</span>
  24 |     | <span class='neutral'>error PortalNotRegistered();</span>
  25 |     | <span class='neutral'>error OwnerNotExpired();</span>
  26 |     | <span class='neutral'>error InsufficientReceived();</span>
  27 |     | <span class='neutral'>error InvalidConstructor();</span>
  28 |     | <span class='neutral'>error InvalidAddress();</span>
  29 |     | <span class='neutral'>error InvalidAmount();</span>
  30 |     | <span class='neutral'>error DeadlineExpired();</span>
  31 |     | <span class='neutral'>error FailedToSendNativeToken();</span>
  32 |     | <span class='neutral'>error FundingPhaseOngoing();</span>
  33 |     | <span class='neutral'>error FundingInsufficient();</span>
  34 |     | <span class='neutral'>error TokenExists();</span>
  35 |     | <span class='neutral'>error TimeLockActive();</span>
  36 |     | <span class='neutral'>error NoProfit();</span>
  37 |     | <span class='neutral'>error OwnerRevoked();</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>/// @title Portal V2 Virtual LP</span>
  40 |     | <span class='neutral'>/// @author Possum Labs</span>
  41 |     | <span class='neutral'>/** @notice This contract serves as the shared, virtual LP for multiple Portals</span>
  42 |     | <span class='neutral'> * Each Portal must be registered by the owner</span>
  43 |     | <span class='neutral'> * The contract is owned for a predetermined duration to enable registering more Portals</span>
  44 |     | <span class='neutral'> * Registering more Portals must be permissioned because it can be malicious</span>
  45 |     | <span class='neutral'> * Portals cannot be removed from the registry to guarantee Portal integrity</span>
  46 |     | <span class='neutral'> * The full amount of PSM inside the LP is available to provide upfront yield for each Portal</span>
  47 |     | <span class='neutral'> * Capital staked through the connected Portals is redirected and staked in an external yield source</span>
  48 |     | <span class='neutral'> * The LP is refilled by convert() calls which exchanges ERC20 balances for PSM</span>
  49 |     | <span class='neutral'> */</span>
  50 |     | <span class='neutral'>/// @dev Setup Process: 1. Deploy VirtualLP, 2. Deploy Portals, 3. Register Portals in VirtualLP 4. Activate LP</span>
  51 |     | <span class='unexecuted'>contract VirtualLP is ReentrancyGuard {</span>
  52 |     | <span class='unexecuted'>    constructor(</span>
  53 |     | <span class='neutral'>        address _owner,</span>
  54 |     | <span class='neutral'>        uint256 _AMOUNT_TO_CONVERT,</span>
  55 |     | <span class='neutral'>        uint256 _FUNDING_PHASE_DURATION,</span>
  56 |     | <span class='neutral'>        uint256 _FUNDING_MIN_AMOUNT</span>
  57 |     | <span class='neutral'>    ) {</span>
  58 |     | <span class='unexecuted'>        if (_owner == address(0)) {</span>
  59 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  60 |     | <span class='neutral'>        }</span>
  61 |     | <span class='unexecuted'>        if (_AMOUNT_TO_CONVERT == 0) {</span>
  62 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  63 |     | <span class='neutral'>        }</span>
  64 |     | <span class='unexecuted'>        if (</span>
  65 |     | <span class='unexecuted'>            _FUNDING_PHASE_DURATION &lt; 259200 ||</span>
  66 |     | <span class='unexecuted'>            _FUNDING_PHASE_DURATION &gt; 2592000</span>
  67 |     | <span class='neutral'>        ) {</span>
  68 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  69 |     | <span class='neutral'>        }</span>
  70 |     | <span class='unexecuted'>        if (_FUNDING_MIN_AMOUNT == 0) {</span>
  71 |     | <span class='unexecuted'>            revert InvalidConstructor();</span>
  72 |     | <span class='neutral'>        }</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='unexecuted'>        AMOUNT_TO_CONVERT = _AMOUNT_TO_CONVERT;</span>
  75 |     | <span class='unexecuted'>        FUNDING_PHASE_DURATION = _FUNDING_PHASE_DURATION;</span>
  76 |     | <span class='unexecuted'>        FUNDING_MIN_AMOUNT = _FUNDING_MIN_AMOUNT;</span>
  77 |     | <span class='neutral'></span>
  78 |     | <span class='unexecuted'>        owner = _owner;</span>
  79 |     | <span class='unexecuted'>        OWNER_EXPIRY_TIME = OWNER_DURATION + block.timestamp;</span>
  80 |     | <span class='neutral'></span>
  81 |     | <span class='unexecuted'>        CREATION_TIME = block.timestamp;</span>
  82 |     | <span class='neutral'>    }</span>
  83 |     | <span class='neutral'></span>
  84 |     | <span class='neutral'>    // ============================================</span>
  85 |     | <span class='neutral'>    // ==            GLOBAL VARIABLES            ==</span>
  86 |     | <span class='neutral'>    // ============================================</span>
  87 |     | <span class='neutral'>    using SafeERC20 for IERC20;</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='unexecuted'>    MintBurnToken public bToken; // the receipt token for funding the LP</span>
  90 |     | <span class='unexecuted'>    address public bTokenAddress; // the address of the receipt token</span>
  91 |     | <span class='neutral'></span>
  92 |     | <span class='unexecuted'>    uint256 constant SECONDS_PER_YEAR = 31536000; // seconds in a 365 day year</span>
  93 |     | <span class='neutral'>    uint256 constant MAX_UINT =</span>
  94 |     | <span class='neutral'>        115792089237316195423570985008687907853269984665640564039457584007913129639935;</span>
  95 |     | <span class='neutral'></span>
  96 |     | <span class='unexecuted'>    address public owner;</span>
  97 |     | <span class='unexecuted'>    uint256 private constant OWNER_DURATION = 31536000; // 1 Year</span>
  98 |     | <span class='unexecuted'>    uint256 public immutable OWNER_EXPIRY_TIME; // Time required to pass before owner can be revoked</span>
  99 |     | <span class='unexecuted'>    uint256 public immutable AMOUNT_TO_CONVERT; // fixed amount of PSM tokens required to withdraw yield in the contract</span>
 100 |     | <span class='unexecuted'>    uint256 public immutable FUNDING_PHASE_DURATION; // seconds after deployment before Portal can be activated</span>
 101 |     | <span class='unexecuted'>    uint256 public immutable FUNDING_MIN_AMOUNT; // minimum funding required before Portal can be activated</span>
 102 |     | <span class='unexecuted'>    uint256 public immutable CREATION_TIME; // time stamp of deployment</span>
 103 |     | <span class='neutral'></span>
 104 |     | <span class='unexecuted'>    uint256 public constant FUNDING_APR = 36; // annual redemption value increase (APR) of bTokens</span>
 105 |     | <span class='unexecuted'>    uint256 public constant FUNDING_MAX_RETURN_PERCENT = 1000; // maximum redemption value percent of bTokens (must be &gt;100)</span>
 106 |     | <span class='unexecuted'>    uint256 public constant FUNDING_REWARD_SHARE = 10; // 10% of yield goes to the funding pool until investors are paid back</span>
 107 |     | <span class='neutral'></span>
 108 |     | <span class='unexecuted'>    address constant WETH_ADDRESS = 0x82aF49447D8a07e3bd95BD0d56f35241523fBab1;</span>
 109 |     | <span class='unexecuted'>    address constant PSM_ADDRESS = 0x17A8541B82BF67e10B0874284b4Ae66858cb1fd5; // address of PSM token</span>
 110 |     | <span class='neutral'></span>
 111 |     | <span class='unexecuted'>    address public constant SINGLE_STAKING =</span>
 112 |     | <span class='unexecuted'>        0x314223E2fA375F972E159002Eb72A96301E99e22;</span>
 113 |     | <span class='unexecuted'>    address public constant DUAL_STAKING =</span>
 114 |     | <span class='unexecuted'>        0x31Fa38A6381e9d1f4770C73AB14a0ced1528A65E;</span>
 115 |     | <span class='unexecuted'>    address public constant esVKA = 0x95b3F9797077DDCa971aB8524b439553a220EB2A;</span>
 116 |     | <span class='neutral'></span>
 117 |     | <span class='unexecuted'>    bool public isActiveLP; // Will be set to true when funding phase ends</span>
 118 |     | <span class='unexecuted'>    bool public bTokenCreated; // flag for bToken deployment</span>
 119 |     | <span class='unexecuted'>    uint256 public fundingBalance; // sum of all PSM funding contributions</span>
 120 |     | <span class='unexecuted'>    uint256 public fundingRewardPool; // amount of PSM available for redemption against bTokens</span>
 121 |     | <span class='neutral'></span>
 122 |     | <span class='unexecuted'>    mapping(address portal =&gt; bool isRegistered) public registeredPortals;</span>
 123 |     | <span class='unexecuted'>    mapping(address portal =&gt; mapping(address asset =&gt; address vault))</span>
 124 |     | <span class='neutral'>        public vaults;</span>
 125 |     | <span class='unexecuted'>    mapping(address portal =&gt; mapping(address asset =&gt; uint256 pid))</span>
 126 |     | <span class='neutral'>        public poolID;</span>
 127 |     | <span class='neutral'></span>
 128 |     | <span class='neutral'>    // ============================================</span>
 129 |     | <span class='neutral'>    // ==                EVENTS                  ==</span>
 130 |     | <span class='neutral'>    // ============================================</span>
 131 |     | <span class='neutral'>    event LP_Activated(address indexed, uint256 fundingBalance);</span>
 132 |     | <span class='neutral'>    event ConvertExecuted(</span>
 133 |     | <span class='neutral'>        address indexed token,</span>
 134 |     | <span class='neutral'>        address indexed caller,</span>
 135 |     | <span class='neutral'>        address indexed recipient,</span>
 136 |     | <span class='neutral'>        uint256 amount</span>
 137 |     | <span class='neutral'>    );</span>
 138 |     | <span class='neutral'></span>
 139 |     | <span class='neutral'>    event FundingReceived(address indexed, uint256 amount);</span>
 140 |     | <span class='neutral'>    event FundingWithdrawn(address indexed, uint256 amount);</span>
 141 |     | <span class='neutral'>    event RewardsRedeemed(</span>
 142 |     | <span class='neutral'>        address indexed,</span>
 143 |     | <span class='neutral'>        uint256 amountBurned,</span>
 144 |     | <span class='neutral'>        uint256 amountReceived</span>
 145 |     | <span class='neutral'>    );</span>
 146 |     | <span class='neutral'></span>
 147 |     | <span class='neutral'>    event RewardsClaimed(address indexed portal, uint256 timeStamp);</span>
 148 |     | <span class='neutral'></span>
 149 |     | <span class='neutral'>    // ============================================</span>
 150 |     | <span class='neutral'>    // ==               MODIFIERS                ==</span>
 151 |     | <span class='neutral'>    // ============================================</span>
 152 |     | <span class='neutral'>    modifier activeLP() {</span>
 153 |     | <span class='unexecuted'>        if (!isActiveLP) {</span>
 154 |     | <span class='unexecuted'>            revert InactiveLP();</span>
 155 |     | <span class='neutral'>        }</span>
 156 |     | <span class='neutral'>        _;</span>
 157 |     | <span class='neutral'>    }</span>
 158 |     | <span class='neutral'></span>
 159 |     | <span class='neutral'>    modifier inactiveLP() {</span>
 160 |     | <span class='unexecuted'>        if (isActiveLP) {</span>
 161 |     | <span class='unexecuted'>            revert ActiveLP();</span>
 162 |     | <span class='neutral'>        }</span>
 163 |     | <span class='neutral'>        _;</span>
 164 |     | <span class='neutral'>    }</span>
 165 |     | <span class='neutral'></span>
 166 |     | <span class='neutral'>    modifier registeredPortal() {</span>
 167 |     | <span class='unexecuted'>        if (!registeredPortals[msg.sender]) {</span>
 168 |     | <span class='unexecuted'>            revert PortalNotRegistered();</span>
 169 |     | <span class='neutral'>        }</span>
 170 |     | <span class='neutral'>        _;</span>
 171 |     | <span class='neutral'>    }</span>
 172 |     | <span class='neutral'></span>
 173 |     | <span class='neutral'>    modifier onlyOwner() {</span>
 174 |     | <span class='unexecuted'>        if (msg.sender != owner) {</span>
 175 |     | <span class='unexecuted'>            revert NotOwner();</span>
 176 |     | <span class='neutral'>        }</span>
 177 |     | <span class='neutral'>        _;</span>
 178 |     | <span class='neutral'>    }</span>
 179 |     | <span class='neutral'></span>
 180 |     | <span class='neutral'>    // ============================================</span>
 181 |     | <span class='neutral'>    // ==             LP FUNCTIONS               ==</span>
 182 |     | <span class='neutral'>    // ============================================</span>
 183 |     | <span class='neutral'>    /// @notice This function transfers PSM to a recipient address</span>
 184 |     | <span class='neutral'>    /// @dev Transfer an amount of PSM to a recipient</span>
 185 |     | <span class='neutral'>    /// @dev Can only be called by a registered address (Portal)</span>
 186 |     | <span class='neutral'>    /// @dev All critical logic is handled by the Portal, hence no additional checks</span>
 187 |     | <span class='neutral'>    /// @param _recipient The address that recieves the PSM</span>
 188 |     | <span class='neutral'>    /// @param _amount The amount of PSM send to the recipient</span>
 189 |     | <span class='unexecuted'>    function PSM_sendToPortalUser(</span>
 190 |     | <span class='neutral'>        address _recipient,</span>
 191 |     | <span class='neutral'>        uint256 _amount</span>
 192 |     | <span class='neutral'>    ) external registeredPortal {</span>
 193 |     | <span class='neutral'>        /// @dev Transfer PSM to the recipient</span>
 194 |     | <span class='unexecuted'>        IERC20(PSM_ADDRESS).transfer(_recipient, _amount);</span>
 195 |     | <span class='neutral'>    }</span>
 196 |     | <span class='neutral'></span>
 197 |     | <span class='neutral'>    /// @notice Function to add new Portals to the registry</span>
 198 |     | <span class='neutral'>    /// @dev Add new Portals to the registry. Portals can only be added, never removed</span>
 199 |     | <span class='neutral'>    /// @dev Only callable by owner to prevent malicious interactions</span>
 200 |     | <span class='neutral'>    /// @dev Function can override existing registries to fix potential integration errors</span>
 201 |     | <span class='neutral'>    /// @param _portal The address of the Portal to register</span>
 202 |     | <span class='neutral'>    /// @param _asset The address of the principal token of the Portal</span>
 203 |     | <span class='neutral'>    /// @param _vault The address of the staking Vault used by the Portal in the external protocol</span>
 204 |     | <span class='neutral'>    /// @param _pid The pool identifier of the staking Vault, relevant for the SingleStaking contract</span>
 205 |     | <span class='unexecuted'>    function registerPortal(</span>
 206 |     | <span class='neutral'>        address _portal,</span>
 207 |     | <span class='neutral'>        address _asset,</span>
 208 |     | <span class='neutral'>        address _vault,</span>
 209 |     | <span class='neutral'>        uint256 _pid</span>
 210 |     | <span class='neutral'>    ) external onlyOwner {</span>
 211 |     | <span class='neutral'>        ///@dev register Portal so that it can call protected functions</span>
 212 |     | <span class='unexecuted'>        registeredPortals[_portal] = true;</span>
 213 |     | <span class='neutral'></span>
 214 |     | <span class='neutral'>        /// @dev update the Portal asset mappings</span>
 215 |     | <span class='unexecuted'>        vaults[_portal][_asset] = _vault;</span>
 216 |     | <span class='unexecuted'>        poolID[_portal][_asset] = _pid;</span>
 217 |     | <span class='neutral'>    }</span>
 218 |     | <span class='neutral'></span>
 219 |     | <span class='neutral'>    /// @notice This function disables the ownership access</span>
 220 |     | <span class='neutral'>    /// @dev Set the zero address as owner</span>
 221 |     | <span class='neutral'>    /// @dev Callable by anyone after duration passed</span>
 222 |     | <span class='unexecuted'>    function removeOwner() external {</span>
 223 |     | <span class='unexecuted'>        if (block.timestamp &lt; OWNER_EXPIRY_TIME) {</span>
 224 |     | <span class='unexecuted'>            revert OwnerNotExpired();</span>
 225 |     | <span class='neutral'>        }</span>
 226 |     | <span class='unexecuted'>        if (owner == address(0)) {</span>
 227 |     | <span class='unexecuted'>            revert OwnerRevoked();</span>
 228 |     | <span class='neutral'>        }</span>
 229 |     | <span class='neutral'></span>
 230 |     | <span class='unexecuted'>        owner = address(0);</span>
 231 |     | <span class='neutral'>    }</span>
 232 |     | <span class='neutral'></span>
 233 |     | <span class='neutral'>    // ============================================</span>
 234 |     | <span class='neutral'>    // ==      EXTERNAL PROTOCOL INTEGRATION     ==</span>
 235 |     | <span class='neutral'>    // ============================================</span>
 236 |     | <span class='neutral'>    /// @notice Deposit principal into the yield source</span>
 237 |     | <span class='neutral'>    /// @dev This function deposits principal tokens from a connected Portal into the external protocol</span>
 238 |     | <span class='neutral'>    /// @dev Receive and transfer tokens from the Portal to the external protocol via interface</span>
 239 |     | <span class='neutral'>    /// @param _asset The address of the asset to deposit</span>
 240 |     | <span class='neutral'>    /// @param _amount The amount of asset to deposit</span>
 241 |     | <span class='unexecuted'>    function depositToYieldSource(</span>
 242 |     | <span class='neutral'>        address _asset,</span>
 243 |     | <span class='neutral'>        uint256 _amount</span>
 244 |     | <span class='unexecuted'>    ) external registeredPortal {</span>
 245 |     | <span class='neutral'>        /// @dev Check that the withdraw timeLock is zero to protect stakers from griefing attack</span>
 246 |     | <span class='unexecuted'>        if (IWater(vaults[msg.sender][_asset]).lockTime() &gt; 0) {</span>
 247 |     | <span class='unexecuted'>            revert TimeLockActive();</span>
 248 |     | <span class='neutral'>        }</span>
 249 |     | <span class='neutral'></span>
 250 |     | <span class='neutral'>        /// @dev Deposit tokens into Vault to receive Shares (WATER)</span>
 251 |     | <span class='neutral'>        /// @dev Approval of token spending is handled with a separate function to save gas</span>
 252 |     | <span class='unexecuted'>        uint256 depositShares = IWater(vaults[msg.sender][_asset]).deposit(</span>
 253 |     | <span class='neutral'>            _amount,</span>
 254 |     | <span class='unexecuted'>            address(this)</span>
 255 |     | <span class='neutral'>        );</span>
 256 |     | <span class='neutral'></span>
 257 |     | <span class='neutral'>        /// @dev Stake the Vault Shares into the staking contract using the pool identifier (pid)</span>
 258 |     | <span class='neutral'>        /// @dev Approval of token spending is handled with a separate function to save gas</span>
 259 |     | <span class='unexecuted'>        ISingleStaking(SINGLE_STAKING).deposit(</span>
 260 |     | <span class='unexecuted'>            poolID[msg.sender][_asset],</span>
 261 |     | <span class='neutral'>            depositShares</span>
 262 |     | <span class='neutral'>        );</span>
 263 |     | <span class='neutral'>    }</span>
 264 |     | <span class='neutral'></span>
 265 |     | <span class='neutral'>    /// @notice Withdraw principal from the yield source to the user</span>
 266 |     | <span class='neutral'>    /// @dev This function withdraws principal tokens from the external protocol</span>
 267 |     | <span class='neutral'>    /// @dev Transfer the tokens from the external protocol to a Portal user via integration interface</span>
 268 |     | <span class='neutral'>    /// @param _asset The address of the asset to withdraw</span>
 269 |     | <span class='neutral'>    /// @param _user The address of the user that will receive the withdrawn assets</span>
 270 |     | <span class='neutral'>    /// @param _amount The amount of assets to withdraw</span>
 271 |     | <span class='unexecuted'>    function withdrawFromYieldSource(</span>
 272 |     | <span class='neutral'>        address _asset,</span>
 273 |     | <span class='neutral'>        address _user,</span>
 274 |     | <span class='neutral'>        uint256 _amount</span>
 275 |     | <span class='unexecuted'>    ) external registeredPortal {</span>
 276 |     | <span class='neutral'>        /// @dev Calculate number of Vault Shares that equal the withdraw amount</span>
 277 |     | <span class='unexecuted'>        uint256 withdrawShares = IWater(vaults[msg.sender][_asset])</span>
 278 |     | <span class='neutral'>            .convertToShares(_amount);</span>
 279 |     | <span class='neutral'></span>
 280 |     | <span class='neutral'>        /// @dev Get the withdrawable assets from burning Vault Shares (consider rounding)</span>
 281 |     | <span class='unexecuted'>        uint256 withdrawAssets = IWater(vaults[msg.sender][_asset])</span>
 282 |     | <span class='neutral'>            .convertToAssets(withdrawShares);</span>
 283 |     | <span class='neutral'></span>
 284 |     | <span class='neutral'>        /// @dev Initialize helper variables for withdraw amount sanity check</span>
 285 |     | <span class='unexecuted'>        uint256 balanceBefore;</span>
 286 |     | <span class='neutral'>        uint256 balanceAfter;</span>
 287 |     | <span class='neutral'></span>
 288 |     | <span class='neutral'>        /// @dev Withdraw Vault Shares from Single Staking Contract</span>
 289 |     | <span class='unexecuted'>        ISingleStaking(SINGLE_STAKING).withdraw(</span>
 290 |     | <span class='unexecuted'>            poolID[msg.sender][_asset],</span>
 291 |     | <span class='neutral'>            withdrawShares</span>
 292 |     | <span class='neutral'>        );</span>
 293 |     | <span class='neutral'></span>
 294 |     | <span class='neutral'>        /// @dev Check if handling ETH, withdraw as WETH</span>
 295 |     | <span class='unexecuted'>        address tokenAdr = (_asset == address(0)) ? WETH_ADDRESS : _asset;</span>
 296 |     | <span class='neutral'></span>
 297 |     | <span class='neutral'>        /// @dev Withdraw the staked assets from Vault</span>
 298 |     | <span class='unexecuted'>        balanceBefore = IERC20(tokenAdr).balanceOf(address(this));</span>
 299 |     | <span class='unexecuted'>        IWater(vaults[msg.sender][_asset]).withdraw(</span>
 300 |     | <span class='neutral'>            withdrawAssets,</span>
 301 |     | <span class='unexecuted'>            address(this),</span>
 302 |     | <span class='neutral'>            address(this)</span>
 303 |     | <span class='neutral'>        );</span>
 304 |     | <span class='unexecuted'>        balanceAfter = IERC20(tokenAdr).balanceOf(address(this));</span>
 305 |     | <span class='neutral'></span>
 306 |     | <span class='neutral'>        /// @dev Sanity check on obtained amount from Vault</span>
 307 |     | <span class='unexecuted'>        _amount = balanceAfter - balanceBefore;</span>
 308 |     | <span class='neutral'></span>
 309 |     | <span class='neutral'>        /// @dev Transfer the obtained assets to the user</span>
 310 |     | <span class='neutral'>        /// @dev Convert WETH to ETH before sending</span>
 311 |     | <span class='unexecuted'>        if (_asset == address(0)) {</span>
 312 |     | <span class='unexecuted'>            IWETH(WETH_ADDRESS).withdrawTo(_user, _amount);</span>
 313 |     | <span class='neutral'>        } else {</span>
 314 |     | <span class='unexecuted'>            IERC20(tokenAdr).safeTransfer(_user, _amount);</span>
 315 |     | <span class='neutral'>        }</span>
 316 |     | <span class='neutral'>    }</span>
 317 |     | <span class='neutral'></span>
 318 |     | <span class='neutral'>    /// @notice Claim pending esVKA and USDC rewards, then restake esVKA</span>
 319 |     | <span class='neutral'>    /// @dev Claim protocol rewards for a specific Portal and restake esVKA</span>
 320 |     | <span class='neutral'>    /// @param _portal The address of a registered Portal</span>
 321 |     | <span class='unexecuted'>    function claimProtocolRewards(address _portal) external {</span>
 322 |     | <span class='neutral'>        /// @dev Get the asset of the Portal</span>
 323 |     | <span class='unexecuted'>        address asset = IPortalV2MultiAsset(_portal).PRINCIPAL_TOKEN_ADDRESS();</span>
 324 |     | <span class='neutral'></span>
 325 |     | <span class='neutral'>        /// @dev Claim esVKA rewards from staking the Vault Shares</span>
 326 |     | <span class='unexecuted'>        ISingleStaking(SINGLE_STAKING).deposit(poolID[_portal][asset], 0);</span>
 327 |     | <span class='neutral'></span>
 328 |     | <span class='unexecuted'>        uint256 esVKABalance = IERC20(esVKA).balanceOf(address(this));</span>
 329 |     | <span class='neutral'></span>
 330 |     | <span class='neutral'>        /// @dev Stake esVKA into the Dual Staking contract</span>
 331 |     | <span class='neutral'>        /// @dev Approval of token spending is handled with a separate function to save gas</span>
 332 |     | <span class='unexecuted'>        if (esVKABalance &gt; 0) {</span>
 333 |     | <span class='unexecuted'>            IDualStaking(DUAL_STAKING).stake(esVKABalance, esVKA);</span>
 334 |     | <span class='neutral'>        }</span>
 335 |     | <span class='neutral'></span>
 336 |     | <span class='neutral'>        /// @dev Claim esVKA and USDC from DualStaking, stake the esVKA reward and receive USDC to contract</span>
 337 |     | <span class='unexecuted'>        IDualStaking(DUAL_STAKING).compound();</span>
 338 |     | <span class='neutral'></span>
 339 |     | <span class='neutral'>        /// @dev Emit the event that rewards have been claimed</span>
 340 |     | <span class='unexecuted'>        emit RewardsClaimed(_portal, block.timestamp);</span>
 341 |     | <span class='neutral'>    }</span>
 342 |     | <span class='neutral'></span>
 343 |     | <span class='neutral'>    /// @notice Internal function to get Vault profit before withdrawal fees</span>
 344 |     | <span class='neutral'>    /// @dev Get the surplus assets in the Vault excluding withdrawal fee</span>
 345 |     | <span class='neutral'>    /// @param _portal The address of a registered Portal</span>
 346 |     | <span class='unexecuted'>    function _getProfitOfPortal(</span>
 347 |     | <span class='neutral'>        address _portal</span>
 348 |     | <span class='unexecuted'>    ) private view returns (uint256 profitAsset, uint256 profitShares) {</span>
 349 |     | <span class='neutral'>        /// @dev Get the asset of the Portal</span>
 350 |     | <span class='unexecuted'>        IPortalV2MultiAsset portal = IPortalV2MultiAsset(_portal);</span>
 351 |     | <span class='unexecuted'>        address asset = portal.PRINCIPAL_TOKEN_ADDRESS();</span>
 352 |     | <span class='neutral'></span>
 353 |     | <span class='neutral'>        /// @dev Get the Vault shares owned by Portal</span>
 354 |     | <span class='unexecuted'>        uint256 sharesOwned = ISingleStaking(SINGLE_STAKING).getUserAmount(</span>
 355 |     | <span class='unexecuted'>            poolID[_portal][asset],</span>
 356 |     | <span class='unexecuted'>            address(this)</span>
 357 |     | <span class='neutral'>        );</span>
 358 |     | <span class='neutral'></span>
 359 |     | <span class='neutral'>        /// @dev Calculate the shares to be reserved for user withdrawals</span>
 360 |     | <span class='unexecuted'>        uint256 sharesDebt = IWater(vaults[_portal][asset]).convertToShares(</span>
 361 |     | <span class='unexecuted'>            portal.totalPrincipalStaked()</span>
 362 |     | <span class='neutral'>        );</span>
 363 |     | <span class='neutral'></span>
 364 |     | <span class='neutral'>        /// @dev Calculate the surplus shares owned by the Portal</span>
 365 |     | <span class='unexecuted'>        profitShares = (sharesOwned &gt; sharesDebt)</span>
 366 |     | <span class='unexecuted'>            ? sharesOwned - sharesDebt</span>
 367 |     | <span class='unexecuted'>            : 0;</span>
 368 |     | <span class='neutral'></span>
 369 |     | <span class='neutral'>        /// @dev Calculate the net profit in assets</span>
 370 |     | <span class='unexecuted'>        profitAsset = IWater(vaults[_portal][asset]).convertToAssets(</span>
 371 |     | <span class='neutral'>            profitShares</span>
 372 |     | <span class='neutral'>        );</span>
 373 |     | <span class='neutral'>    }</span>
 374 |     | <span class='neutral'></span>
 375 |     | <span class='neutral'>    /// @notice View current net profit of a Vault used by a specific Portal</span>
 376 |     | <span class='neutral'>    /// @dev Get surplus assets in the Vault after deducting withdrawal fees</span>
 377 |     | <span class='neutral'>    /// @param _portal The address of a registered Portal</span>
 378 |     | <span class='unexecuted'>    function getProfitOfPortal(</span>
 379 |     | <span class='neutral'>        address _portal</span>
 380 |     | <span class='unexecuted'>    ) external view returns (uint256 profitOfPortal) {</span>
 381 |     | <span class='neutral'>        /// @dev Get the asset of the Portal</span>
 382 |     | <span class='unexecuted'>        address asset = IPortalV2MultiAsset(_portal).PRINCIPAL_TOKEN_ADDRESS();</span>
 383 |     | <span class='neutral'></span>
 384 |     | <span class='neutral'>        /// @dev Get the gross profit of the Vault</span>
 385 |     | <span class='unexecuted'>        (uint256 profit, ) = _getProfitOfPortal(_portal);</span>
 386 |     | <span class='neutral'></span>
 387 |     | <span class='neutral'>        /// @dev Calculate the net profit after withdrawal fees</span>
 388 |     | <span class='unexecuted'>        uint256 denominator = IWater(vaults[_portal][asset]).DENOMINATOR();</span>
 389 |     | <span class='unexecuted'>        uint256 withdrawalFee = IWater(vaults[_portal][asset]).withdrawalFees();</span>
 390 |     | <span class='neutral'></span>
 391 |     | <span class='unexecuted'>        profitOfPortal = (profit * (denominator - withdrawalFee)) / denominator;</span>
 392 |     | <span class='neutral'>    }</span>
 393 |     | <span class='neutral'></span>
 394 |     | <span class='neutral'>    /// @notice Withdraw the asset surplus of a Vault used by a specific Portal</span>
 395 |     | <span class='neutral'>    /// @dev Withdraw the asset surplus from Vault to contract</span>
 396 |     | <span class='neutral'>    /// @param _portal The address of a registered Portal</span>
 397 |     | <span class='unexecuted'>    function collectProfitOfPortal(address _portal) public {</span>
 398 |     | <span class='neutral'>        /// @dev Get the asset of the Portal</span>
 399 |     | <span class='unexecuted'>        address asset = IPortalV2MultiAsset(_portal).PRINCIPAL_TOKEN_ADDRESS();</span>
 400 |     | <span class='neutral'></span>
 401 |     | <span class='unexecuted'>        (uint256 profit, uint256 shares) = _getProfitOfPortal(_portal);</span>
 402 |     | <span class='neutral'></span>
 403 |     | <span class='neutral'>        /// @dev Check if there is profit to withdraw</span>
 404 |     | <span class='unexecuted'>        if (profit == 0 || shares == 0) {</span>
 405 |     | <span class='unexecuted'>            revert NoProfit();</span>
 406 |     | <span class='neutral'>        }</span>
 407 |     | <span class='neutral'></span>
 408 |     | <span class='neutral'>        /// @dev Withdraw the surplus Vault Shares from Single Staking Contract</span>
 409 |     | <span class='unexecuted'>        ISingleStaking(SINGLE_STAKING).withdraw(poolID[_portal][asset], shares);</span>
 410 |     | <span class='neutral'></span>
 411 |     | <span class='neutral'>        /// @dev Withdraw the profit Assets from the Vault to contract (collect WETH from ETH Vault)</span>
 412 |     | <span class='unexecuted'>        IWater(vaults[_portal][asset]).withdraw(</span>
 413 |     | <span class='neutral'>            profit,</span>
 414 |     | <span class='unexecuted'>            address(this),</span>
 415 |     | <span class='neutral'>            address(this)</span>
 416 |     | <span class='neutral'>        );</span>
 417 |     | <span class='neutral'>    }</span>
 418 |     | <span class='neutral'></span>
 419 |     | <span class='neutral'>    /// @notice Read the pending USDC protocol rewards earned by the LP contract</span>
 420 |     | <span class='neutral'>    /// @dev Get current USDC rewards pending from protocol fees</span>
 421 |     | <span class='unexecuted'>    function getPendingRewardsUSDC() external view returns (uint256 rewards) {</span>
 422 |     | <span class='unexecuted'>        rewards = IDualStaking(DUAL_STAKING).pendingRewardsUSDC(address(this));</span>
 423 |     | <span class='neutral'>    }</span>
 424 |     | <span class='neutral'></span>
 425 |     | <span class='neutral'>    /// @notice Read the timelock value of a Vault used by a specific Portal</span>
 426 |     | <span class='neutral'>    /// @dev Get the timelock of a Vault used by a Portal</span>
 427 |     | <span class='neutral'>    /// @param _portal The address of a registered Portal</span>
 428 |     | <span class='unexecuted'>    function getPortalVaultLockTime(</span>
 429 |     | <span class='neutral'>        address _portal</span>
 430 |     | <span class='unexecuted'>    ) external view returns (uint256 lockTime) {</span>
 431 |     | <span class='neutral'>        /// @dev Get the asset of the Portal</span>
 432 |     | <span class='unexecuted'>        IPortalV2MultiAsset portal = IPortalV2MultiAsset(_portal);</span>
 433 |     | <span class='unexecuted'>        address asset = portal.PRINCIPAL_TOKEN_ADDRESS();</span>
 434 |     | <span class='neutral'></span>
 435 |     | <span class='unexecuted'>        lockTime = IWater(vaults[_portal][asset]).lockTime();</span>
 436 |     | <span class='neutral'>    }</span>
 437 |     | <span class='neutral'></span>
 438 |     | <span class='neutral'>    /// @notice This function allows to update the Boost Multiplier to earn more esVKA</span>
 439 |     | <span class='neutral'>    /// @dev Update the Boost Multiplier of a Vault used by a specific Portal</span>
 440 |     | <span class='neutral'>    /// @param _portal The address of a registered Portal</span>
 441 |     | <span class='unexecuted'>    function updatePortalBoostMultiplier(address _portal) public {</span>
 442 |     | <span class='neutral'>        /// @dev Get the asset of the Portal</span>
 443 |     | <span class='unexecuted'>        IPortalV2MultiAsset portal = IPortalV2MultiAsset(_portal);</span>
 444 |     | <span class='unexecuted'>        address asset = portal.PRINCIPAL_TOKEN_ADDRESS();</span>
 445 |     | <span class='neutral'></span>
 446 |     | <span class='unexecuted'>        ISingleStaking(SINGLE_STAKING).updateBoostMultiplier(</span>
 447 |     | <span class='unexecuted'>            address(this),</span>
 448 |     | <span class='unexecuted'>            poolID[_portal][asset]</span>
 449 |     | <span class='neutral'>        );</span>
 450 |     | <span class='neutral'>    }</span>
 451 |     | <span class='neutral'></span>
 452 |     | <span class='neutral'>    /// @notice This function increases spending allowance for staking assets by Vaults</span>
 453 |     | <span class='neutral'>    /// @dev Increase the token spending allowance of assets by a staking Vault of a specific Portal</span>
 454 |     | <span class='neutral'>    /// @param _portal The address of a registered Portal</span>
 455 |     | <span class='unexecuted'>    function increaseAllowanceVault(address _portal) public {</span>
 456 |     | <span class='neutral'>        /// @dev Get the asset of the Portal</span>
 457 |     | <span class='unexecuted'>        address asset = IPortalV2MultiAsset(_portal).PRINCIPAL_TOKEN_ADDRESS();</span>
 458 |     | <span class='neutral'></span>
 459 |     | <span class='neutral'>        /// @dev Get the principal token address, WETH for ETH</span>
 460 |     | <span class='unexecuted'>        address tokenAdr = (asset == address(0)) ? WETH_ADDRESS : asset;</span>
 461 |     | <span class='neutral'></span>
 462 |     | <span class='neutral'>        /// @dev For ERC20 that require allowance to be 0 before increasing (e.g. USDT) add the following:</span>
 463 |     | <span class='neutral'>        /// IERC20(tokenAdr).approve(vaults[_portal][asset], 0);</span>
 464 |     | <span class='neutral'></span>
 465 |     | <span class='neutral'>        /// @dev Allow spending of Assets by the associated Vault</span>
 466 |     | <span class='unexecuted'>        IERC20(tokenAdr).safeIncreaseAllowance(</span>
 467 |     | <span class='unexecuted'>            vaults[_portal][asset],</span>
 468 |     | <span class='neutral'>            MAX_UINT</span>
 469 |     | <span class='neutral'>        );</span>
 470 |     | <span class='neutral'>    }</span>
 471 |     | <span class='neutral'></span>
 472 |     | <span class='neutral'>    /// @notice This function increases spending allowance for Vault Shares by the SingleStaking contract</span>
 473 |     | <span class='neutral'>    /// @dev Increase the token spending allowance of Vault Shares by the Single Staking contract</span>
 474 |     | <span class='neutral'>    /// @param _portal The address of a registered Portal</span>
 475 |     | <span class='unexecuted'>    function increaseAllowanceSingleStaking(address _portal) public {</span>
 476 |     | <span class='neutral'>        /// @dev Get the asset of the Portal</span>
 477 |     | <span class='unexecuted'>        address asset = IPortalV2MultiAsset(_portal).PRINCIPAL_TOKEN_ADDRESS();</span>
 478 |     | <span class='neutral'></span>
 479 |     | <span class='neutral'>        /// @dev Allow spending of Vault Shares of a Portal by the single staking contract</span>
 480 |     | <span class='unexecuted'>        IERC20(vaults[_portal][asset]).safeIncreaseAllowance(</span>
 481 |     | <span class='neutral'>            SINGLE_STAKING,</span>
 482 |     | <span class='neutral'>            MAX_UINT</span>
 483 |     | <span class='neutral'>        );</span>
 484 |     | <span class='neutral'>    }</span>
 485 |     | <span class='neutral'></span>
 486 |     | <span class='neutral'>    /// @notice This function increases spending allowance for esVKA by the DualStaking contract</span>
 487 |     | <span class='neutral'>    /// @dev Increase the token spending allowance of esVKA by the DualStaking contract</span>
 488 |     | <span class='unexecuted'>    function increaseAllowanceDualStaking() public {</span>
 489 |     | <span class='unexecuted'>        IERC20(esVKA).safeIncreaseAllowance(DUAL_STAKING, MAX_UINT);</span>
 490 |     | <span class='neutral'>    }</span>
 491 |     | <span class='neutral'></span>
 492 |     | <span class='neutral'>    // ============================================</span>
 493 |     | <span class='neutral'>    // ==              PSM CONVERTER             ==</span>
 494 |     | <span class='neutral'>    // ============================================</span>
 495 |     | <span class='neutral'>    /// @notice Handle the arbitrage conversion of tokens inside the contract for PSM tokens</span>
 496 |     | <span class='neutral'>    /// @dev This function handles the conversion of tokens inside the contract for PSM tokens</span>
 497 |     | <span class='neutral'>    /// @dev Collect rewards for funders and reallocate reward overflow to the LP (indirect)</span>
 498 |     | <span class='neutral'>    /// @dev Transfer the input (PSM) token from the caller to the contract</span>
 499 |     | <span class='neutral'>    /// @dev Transfer the specified output token from the contract to the caller</span>
 500 |     | <span class='neutral'>    /// @param _token The token to be obtained by the recipient</span>
 501 |     | <span class='neutral'>    /// @param _minReceived The minimum amount of tokens received</span>
 502 |     | <span class='unexecuted'>    function convert(</span>
 503 |     | <span class='neutral'>        address _token,</span>
 504 |     | <span class='neutral'>        address _recipient,</span>
 505 |     | <span class='neutral'>        uint256 _minReceived,</span>
 506 |     | <span class='neutral'>        uint256 _deadline</span>
 507 |     | <span class='unexecuted'>    ) external nonReentrant activeLP {</span>
 508 |     | <span class='neutral'>        /// @dev Check the validity of token and recipient addresses</span>
 509 |     | <span class='unexecuted'>        if (_token == PSM_ADDRESS || _recipient == address(0)) {</span>
 510 |     | <span class='unexecuted'>            revert InvalidAddress();</span>
 511 |     | <span class='neutral'>        }</span>
 512 |     | <span class='neutral'></span>
 513 |     | <span class='neutral'>        /// @dev Prevent zero value</span>
 514 |     | <span class='unexecuted'>        if (_minReceived == 0) {</span>
 515 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 516 |     | <span class='neutral'>        }</span>
 517 |     | <span class='neutral'></span>
 518 |     | <span class='neutral'>        /// @dev Check that the deadline has not expired</span>
 519 |     | <span class='unexecuted'>        if (_deadline &lt; block.timestamp) {</span>
 520 |     | <span class='unexecuted'>            revert DeadlineExpired();</span>
 521 |     | <span class='neutral'>        }</span>
 522 |     | <span class='neutral'></span>
 523 |     | <span class='neutral'>        /// @dev Get the contract balance of the specified token</span>
 524 |     | <span class='unexecuted'>        uint256 contractBalance;</span>
 525 |     | <span class='unexecuted'>        if (_token == address(0)) {</span>
 526 |     | <span class='unexecuted'>            contractBalance = address(this).balance;</span>
 527 |     | <span class='neutral'>        } else {</span>
 528 |     | <span class='unexecuted'>            contractBalance = IERC20(_token).balanceOf(address(this));</span>
 529 |     | <span class='neutral'>        }</span>
 530 |     | <span class='neutral'></span>
 531 |     | <span class='neutral'>        /// @dev Check that enough output tokens are available for frontrun protection</span>
 532 |     | <span class='unexecuted'>        if (contractBalance &lt; _minReceived) {</span>
 533 |     | <span class='unexecuted'>            revert InsufficientReceived();</span>
 534 |     | <span class='neutral'>        }</span>
 535 |     | <span class='neutral'></span>
 536 |     | <span class='neutral'>        /// @dev initialize helper variables</span>
 537 |     | <span class='unexecuted'>        uint256 maxRewards = bToken.totalSupply();</span>
 538 |     | <span class='unexecuted'>        uint256 newRewards = (AMOUNT_TO_CONVERT * FUNDING_REWARD_SHARE) / 100;</span>
 539 |     | <span class='neutral'></span>
 540 |     | <span class='neutral'>        /// @dev Check if rewards must be added, adjust reward pool accordingly</span>
 541 |     | <span class='unexecuted'>        if (fundingRewardPool + newRewards &gt;= maxRewards) {</span>
 542 |     | <span class='unexecuted'>            fundingRewardPool = maxRewards;</span>
 543 |     | <span class='neutral'>        } else {</span>
 544 |     | <span class='unexecuted'>            fundingRewardPool += newRewards;</span>
 545 |     | <span class='neutral'>        }</span>
 546 |     | <span class='neutral'></span>
 547 |     | <span class='neutral'>        /// @dev transfer PSM to the LP</span>
 548 |     | <span class='unexecuted'>        IERC20(PSM_ADDRESS).transferFrom(</span>
 549 |     | <span class='unexecuted'>            msg.sender,</span>
 550 |     | <span class='unexecuted'>            address(this),</span>
 551 |     | <span class='unexecuted'>            AMOUNT_TO_CONVERT</span>
 552 |     | <span class='neutral'>        );</span>
 553 |     | <span class='neutral'></span>
 554 |     | <span class='neutral'>        /// @dev Transfer the output token from the contract to the recipient</span>
 555 |     | <span class='unexecuted'>        if (_token == address(0)) {</span>
 556 |     | <span class='unexecuted'>            (bool sent, ) = payable(_recipient).call{value: contractBalance}(</span>
 557 |     | <span class='neutral'>                &quot;&quot;</span>
 558 |     | <span class='neutral'>            );</span>
 559 |     | <span class='unexecuted'>            if (!sent) {</span>
 560 |     | <span class='unexecuted'>                revert FailedToSendNativeToken();</span>
 561 |     | <span class='neutral'>            }</span>
 562 |     | <span class='neutral'>        } else {</span>
 563 |     | <span class='unexecuted'>            IERC20(_token).safeTransfer(_recipient, contractBalance);</span>
 564 |     | <span class='neutral'>        }</span>
 565 |     | <span class='neutral'></span>
 566 |     | <span class='unexecuted'>        emit ConvertExecuted(_token, msg.sender, _recipient, contractBalance);</span>
 567 |     | <span class='neutral'>    }</span>
 568 |     | <span class='neutral'></span>
 569 |     | <span class='neutral'>    // ============================================</span>
 570 |     | <span class='neutral'>    // ==                FUNDING                 ==</span>
 571 |     | <span class='neutral'>    // ============================================</span>
 572 |     | <span class='neutral'>    /// @notice End the funding phase and enable normal contract functionality</span>
 573 |     | <span class='neutral'>    /// @dev This function activates the Virtual LP</span>
 574 |     | <span class='neutral'>    /// @dev Can only be called when the Virtual LP is inactive</span>
 575 |     | <span class='unexecuted'>    function activateLP() external inactiveLP {</span>
 576 |     | <span class='neutral'>        /// @dev Check that the funding phase is over and enough funding has been contributed</span>
 577 |     | <span class='unexecuted'>        if (block.timestamp &lt; CREATION_TIME + FUNDING_PHASE_DURATION) {</span>
 578 |     | <span class='unexecuted'>            revert FundingPhaseOngoing();</span>
 579 |     | <span class='neutral'>        }</span>
 580 |     | <span class='unexecuted'>        if (fundingBalance &lt; FUNDING_MIN_AMOUNT) {</span>
 581 |     | <span class='unexecuted'>            revert FundingInsufficient();</span>
 582 |     | <span class='neutral'>        }</span>
 583 |     | <span class='neutral'></span>
 584 |     | <span class='neutral'>        /// @dev Activate the Virtual LP</span>
 585 |     | <span class='unexecuted'>        isActiveLP = true;</span>
 586 |     | <span class='neutral'></span>
 587 |     | <span class='neutral'>        /// @dev Emit the activation event with the address of the contract and the funding balance</span>
 588 |     | <span class='unexecuted'>        emit LP_Activated(address(this), fundingBalance);</span>
 589 |     | <span class='neutral'>    }</span>
 590 |     | <span class='neutral'></span>
 591 |     | <span class='neutral'>    /// @notice Allow users to deposit PSM to fund the Virtual LP</span>
 592 |     | <span class='neutral'>    /// @dev This function allows users to deposit PSM tokens during the funding phase</span>
 593 |     | <span class='neutral'>    /// @dev The bToken must have been deployed via the contract in advance</span>
 594 |     | <span class='neutral'>    /// @dev Increase the fundingBalance tracker by the amount of PSM deposited</span>
 595 |     | <span class='neutral'>    /// @dev Transfer the PSM tokens from the user to the contract</span>
 596 |     | <span class='neutral'>    /// @dev Mint bTokens to the user</span>
 597 |     | <span class='neutral'>    /// @param _amount The amount of PSM to deposit</span>
 598 |     | <span class='unexecuted'>    function contributeFunding(uint256 _amount) external inactiveLP {</span>
 599 |     | <span class='neutral'>        /// @dev Prevent zero amount transaction</span>
 600 |     | <span class='unexecuted'>        if (_amount == 0) {</span>
 601 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 602 |     | <span class='neutral'>        }</span>
 603 |     | <span class='neutral'></span>
 604 |     | <span class='neutral'>        /// @dev Calculate the amount of bTokens to be minted based on the maximum return</span>
 605 |     | <span class='unexecuted'>        uint256 mintableAmount = (_amount * FUNDING_MAX_RETURN_PERCENT) / 100;</span>
 606 |     | <span class='neutral'></span>
 607 |     | <span class='neutral'>        /// @dev Increase the funding tracker balance by the amount of PSM deposited</span>
 608 |     | <span class='unexecuted'>        fundingBalance += _amount;</span>
 609 |     | <span class='neutral'></span>
 610 |     | <span class='neutral'>        /// @dev Transfer the PSM tokens from the user to the contract</span>
 611 |     | <span class='unexecuted'>        IERC20(PSM_ADDRESS).transferFrom(msg.sender, address(this), _amount);</span>
 612 |     | <span class='neutral'></span>
 613 |     | <span class='neutral'>        /// @dev Mint bTokens to the user</span>
 614 |     | <span class='unexecuted'>        bToken.mint(msg.sender, mintableAmount);</span>
 615 |     | <span class='neutral'></span>
 616 |     | <span class='neutral'>        /// @dev Emit the FundingReceived event with the user address and the mintable amount</span>
 617 |     | <span class='unexecuted'>        emit FundingReceived(msg.sender, mintableAmount);</span>
 618 |     | <span class='neutral'>    }</span>
 619 |     | <span class='neutral'></span>
 620 |     | <span class='neutral'>    /// @notice Allow users to burn bTokens to recover PSM funding before the Virtual LP is activated</span>
 621 |     | <span class='neutral'>    /// @dev This function allows users to burn bTokens during the funding phase of the contract to get back PSM</span>
 622 |     | <span class='neutral'>    /// @dev The bToken must have been deployed via the contract in advance</span>
 623 |     | <span class='neutral'>    /// @dev Decrease the fundingBalance tracker by the amount of PSM withdrawn</span>
 624 |     | <span class='neutral'>    /// @dev Burn the appropriate amount of bTokens from the caller</span>
 625 |     | <span class='neutral'>    /// @dev Transfer the PSM tokens from the contract to the caller</span>
 626 |     | <span class='neutral'>    /// @param _amountBtoken The amount of bTokens burned to withdraw PSM</span>
 627 |     | <span class='unexecuted'>    function withdrawFunding(uint256 _amountBtoken) external inactiveLP {</span>
 628 |     | <span class='neutral'>        /// @dev Prevent zero amount transaction</span>
 629 |     | <span class='unexecuted'>        if (_amountBtoken == 0) {</span>
 630 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 631 |     | <span class='neutral'>        }</span>
 632 |     | <span class='neutral'></span>
 633 |     | <span class='neutral'>        /// @dev Calculate the amount of PSM returned to the user</span>
 634 |     | <span class='unexecuted'>        uint256 withdrawAmount = (_amountBtoken * 100) /</span>
 635 |     | <span class='neutral'>            FUNDING_MAX_RETURN_PERCENT;</span>
 636 |     | <span class='neutral'></span>
 637 |     | <span class='neutral'>        /// @dev Decrease the fundingBalance tracker by the amount of PSM withdrawn</span>
 638 |     | <span class='unexecuted'>        fundingBalance -= withdrawAmount;</span>
 639 |     | <span class='neutral'></span>
 640 |     | <span class='neutral'>        /// @dev Burn bTokens from the user</span>
 641 |     | <span class='unexecuted'>        bToken.burnFrom(msg.sender, _amountBtoken);</span>
 642 |     | <span class='neutral'></span>
 643 |     | <span class='neutral'>        /// @dev Transfer the PSM tokens from the contract to the user</span>
 644 |     | <span class='unexecuted'>        IERC20(PSM_ADDRESS).transfer(msg.sender, withdrawAmount);</span>
 645 |     | <span class='neutral'></span>
 646 |     | <span class='neutral'>        /// @dev Emit an event that the user has withdrawn an amount of funding</span>
 647 |     | <span class='unexecuted'>        emit FundingWithdrawn(msg.sender, withdrawAmount);</span>
 648 |     | <span class='neutral'>    }</span>
 649 |     | <span class='neutral'></span>
 650 |     | <span class='neutral'>    /// @notice Calculate the current burn value of bTokens</span>
 651 |     | <span class='neutral'>    /// @dev Get the current burn value of any amount of bTokens</span>
 652 |     | <span class='neutral'>    /// @param _amount The amount of bTokens to burn</span>
 653 |     | <span class='neutral'>    /// @return burnValue The amount of PSM received when redeeming bTokens</span>
 654 |     | <span class='unexecuted'>    function getBurnValuePSM(</span>
 655 |     | <span class='neutral'>        uint256 _amount</span>
 656 |     | <span class='unexecuted'>    ) public view activeLP returns (uint256 burnValue) {</span>
 657 |     | <span class='neutral'>        /// @dev Calculate the minimum burn value</span>
 658 |     | <span class='unexecuted'>        uint256 minValue = (_amount * 100) / FUNDING_MAX_RETURN_PERCENT;</span>
 659 |     | <span class='neutral'></span>
 660 |     | <span class='neutral'>        /// @dev Calculate the time based burn value</span>
 661 |     | <span class='unexecuted'>        uint256 accruedValue = (_amount *</span>
 662 |     | <span class='unexecuted'>            (block.timestamp - CREATION_TIME) *</span>
 663 |     | <span class='unexecuted'>            FUNDING_APR) / (100 * SECONDS_PER_YEAR);</span>
 664 |     | <span class='neutral'></span>
 665 |     | <span class='neutral'>        /// @dev Calculate the maximum and current burn value</span>
 666 |     | <span class='unexecuted'>        uint256 maxValue = _amount;</span>
 667 |     | <span class='unexecuted'>        uint256 currentValue = minValue + accruedValue;</span>
 668 |     | <span class='neutral'></span>
 669 |     | <span class='unexecuted'>        burnValue = (currentValue &lt; maxValue) ? currentValue : maxValue;</span>
 670 |     | <span class='neutral'>    }</span>
 671 |     | <span class='neutral'></span>
 672 |     | <span class='neutral'>    /// @notice Get the amount of bTokens that can be burned against the reward Pool</span>
 673 |     | <span class='neutral'>    /// @dev Calculate how many bTokens can be burned to redeem the entire reward Pool</span>
 674 |     | <span class='neutral'>    /// @return amountBurnable The amount of bTokens that can be redeemed for rewards</span>
 675 |     | <span class='unexecuted'>    function getBurnableBtokenAmount()</span>
 676 |     | <span class='neutral'>        public</span>
 677 |     | <span class='neutral'>        view</span>
 678 |     | <span class='neutral'>        activeLP</span>
 679 |     | <span class='unexecuted'>        returns (uint256 amountBurnable)</span>
 680 |     | <span class='unexecuted'>    {</span>
 681 |     | <span class='neutral'>        /// @dev Calculate the burn value of 1 full bToken in PSM</span>
 682 |     | <span class='neutral'>        /// @dev Add 1 WEI to handle rounding issue in the next step</span>
 683 |     | <span class='unexecuted'>        uint256 burnValueFullToken = getBurnValuePSM(1e18) + 1;</span>
 684 |     | <span class='neutral'></span>
 685 |     | <span class='neutral'>        /// @dev Calculate and return the amount of bTokens burnable</span>
 686 |     | <span class='neutral'>        /// @dev This will slightly underestimate because of the 1 WEI for reliability reasons</span>
 687 |     | <span class='unexecuted'>        amountBurnable = (fundingRewardPool * 1e18) / burnValueFullToken;</span>
 688 |     | <span class='neutral'>    }</span>
 689 |     | <span class='neutral'></span>
 690 |     | <span class='neutral'>    /// @notice This function allows users to redeem bTokens for PSM tokens</span>
 691 |     | <span class='neutral'>    /// @dev Burn bTokens to receive PSM when the Portal is active</span>
 692 |     | <span class='neutral'>    /// @dev Reduce the funding reward pool by the amount of PSM payable to the user</span>
 693 |     | <span class='neutral'>    /// @dev Burn the bTokens from the user wallet</span>
 694 |     | <span class='neutral'>    /// @dev Transfer the PSM tokens to the user</span>
 695 |     | <span class='neutral'>    /// @param _amount The amount of bTokens to burn</span>
 696 |     | <span class='unexecuted'>    function burnBtokens(uint256 _amount) external {</span>
 697 |     | <span class='neutral'>        /// @dev Check that the burn amount is not zero</span>
 698 |     | <span class='unexecuted'>        if (_amount == 0) {</span>
 699 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 700 |     | <span class='neutral'>        }</span>
 701 |     | <span class='neutral'></span>
 702 |     | <span class='neutral'>        /// @dev Check that the burn amount is not larger than what can be redeemed</span>
 703 |     | <span class='unexecuted'>        uint256 burnable = getBurnableBtokenAmount();</span>
 704 |     | <span class='unexecuted'>        if (_amount &gt; burnable) {</span>
 705 |     | <span class='unexecuted'>            revert InvalidAmount();</span>
 706 |     | <span class='neutral'>        }</span>
 707 |     | <span class='neutral'></span>
 708 |     | <span class='neutral'>        /// @dev Calculate how many PSM the user receives based on the burn amount</span>
 709 |     | <span class='unexecuted'>        uint256 amountToReceive = getBurnValuePSM(_amount);</span>
 710 |     | <span class='neutral'></span>
 711 |     | <span class='neutral'>        /// @dev Reduce the funding reward pool by the amount of PSM payable to the user</span>
 712 |     | <span class='unexecuted'>        fundingRewardPool -= amountToReceive;</span>
 713 |     | <span class='neutral'></span>
 714 |     | <span class='neutral'>        /// @dev Burn the bTokens from the user&#39;s balance</span>
 715 |     | <span class='unexecuted'>        bToken.burnFrom(msg.sender, _amount);</span>
 716 |     | <span class='neutral'></span>
 717 |     | <span class='neutral'>        /// @dev Transfer the PSM to the user</span>
 718 |     | <span class='unexecuted'>        IERC20(PSM_ADDRESS).transfer(msg.sender, amountToReceive);</span>
 719 |     | <span class='neutral'></span>
 720 |     | <span class='neutral'>        /// @dev Event that informs about burn amount and received PSM by the caller</span>
 721 |     | <span class='unexecuted'>        emit RewardsRedeemed(msg.sender, _amount, amountToReceive);</span>
 722 |     | <span class='neutral'>    }</span>
 723 |     | <span class='neutral'></span>
 724 |     | <span class='neutral'>    // ============================================</span>
 725 |     | <span class='neutral'>    // ==           GENERAL FUNCTIONS            ==</span>
 726 |     | <span class='neutral'>    // ============================================</span>
 727 |     | <span class='neutral'>    /// @notice Deploy the bToken of the Virtual LP</span>
 728 |     | <span class='neutral'>    /// @dev This function deploys the bToken of this contract and takes ownership</span>
 729 |     | <span class='neutral'>    /// @dev Must be called before the Virtual LP is activated</span>
 730 |     | <span class='neutral'>    /// @dev Can only be called once</span>
 731 |     | <span class='unexecuted'>    function create_bToken() external inactiveLP {</span>
 732 |     | <span class='unexecuted'>        if (bTokenCreated) {</span>
 733 |     | <span class='unexecuted'>            revert TokenExists();</span>
 734 |     | <span class='neutral'>        }</span>
 735 |     | <span class='neutral'></span>
 736 |     | <span class='neutral'>        /// @dev Update the token creation flag to prevent future calls.</span>
 737 |     | <span class='unexecuted'>        bTokenCreated = true;</span>
 738 |     | <span class='neutral'></span>
 739 |     | <span class='neutral'>        /// @dev Set the token name and symbol</span>
 740 |     | <span class='unexecuted'>        string memory name = &quot;bVaultkaLending&quot;;</span>
 741 |     | <span class='unexecuted'>        string memory symbol = &quot;bVKA-L&quot;;</span>
 742 |     | <span class='neutral'></span>
 743 |     | <span class='neutral'>        /// @dev Deploy the token and update the related storage variable so that other functions can work.</span>
 744 |     | <span class='unexecuted'>        bToken = new MintBurnToken(name, symbol);</span>
 745 |     | <span class='unexecuted'>        bTokenAddress = address(bToken);</span>
 746 |     | <span class='neutral'>    }</span>
 747 |     | <span class='neutral'></span>
 748 |     | <span class='neutral'>    receive() external payable {}</span>
 749 |     | <span class='neutral'></span>
 750 |     | <span class='neutral'>    fallback() external payable {}</span>
 751 |     | <span class='neutral'>}</span>
 752 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/interfaces/IDualStaking.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity =0.8.19;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>interface IDualStaking {</span>
  5 |     | <span class='neutral'>    // enter address of esVKA or VKA</span>
  6 |     | <span class='neutral'>    function stake(uint256 amount, address token) external;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>    /// @notice function to claim protocol fee and re stake the esVKA rewards</span>
  9 |     | <span class='neutral'>    function compound() external;</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    function pendingRewardsUSDC(address account) external view returns (uint);</span>
 12 |     | <span class='neutral'>}</span>
 13 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/interfaces/IPortalV2MultiAsset.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
  2 |     | <span class='neutral'>pragma solidity =0.8.19;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>interface IPortalV2MultiAsset {</span>
  5 |     | <span class='neutral'>    function totalPrincipalStaked()</span>
  6 |     | <span class='neutral'>        external</span>
  7 |     | <span class='neutral'>        view</span>
  8 |     | <span class='neutral'>        returns (uint256 totalPrincipalStaked);</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'>    function PRINCIPAL_TOKEN_ADDRESS()</span>
 11 |     | <span class='neutral'>        external</span>
 12 |     | <span class='neutral'>        view</span>
 13 |     | <span class='neutral'>        returns (address PRINCIPAL_TOKEN_ADDRESS);</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'>    function maxLockDuration() external view returns (uint256);</span>
 16 |     | <span class='neutral'>}</span>
 17 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/interfaces/ISingleStaking.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity =0.8.19;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>interface ISingleStaking {</span>
  5 |     | <span class='neutral'>    function deposit(uint256 _pid, uint256 _amount) external;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>    function withdraw(uint256 _pid, uint256 _amount) external;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    function claimAll() external;</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    function getPoolTokenAddress(uint256 _pid) external view returns (address);</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    function poolLength() external view returns (uint256);</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'>    function getUserAmount(</span>
 16 |     | <span class='neutral'>        uint256 _pid,</span>
 17 |     | <span class='neutral'>        address _user</span>
 18 |     | <span class='neutral'>    ) external view returns (uint256);</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    function updateBoostMultiplier(</span>
 21 |     | <span class='neutral'>        address _user,</span>
 22 |     | <span class='neutral'>        uint256 _pid</span>
 23 |     | <span class='neutral'>    ) external returns (uint256 _newMultiplier);</span>
 24 |     | <span class='neutral'>}</span>
 25 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/interfaces/IUSDC.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
   2 |     | <span class='neutral'>// !! THIS FILE WAS AUTOGENERATED BY abi-to-sol v0.6.6. SEE SOURCE BELOW. !!</span>
   3 |     | <span class='neutral'>pragma solidity &gt;=0.7.0 &lt;0.9.0;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>interface IUSDC {</span>
   6 |     | <span class='neutral'>    event Approval(</span>
   7 |     | <span class='neutral'>        address indexed owner,</span>
   8 |     | <span class='neutral'>        address indexed spender,</span>
   9 |     | <span class='neutral'>        uint256 value</span>
  10 |     | <span class='neutral'>    );</span>
  11 |     | <span class='neutral'>    event AuthorizationCanceled(</span>
  12 |     | <span class='neutral'>        address indexed authorizer,</span>
  13 |     | <span class='neutral'>        bytes32 indexed nonce</span>
  14 |     | <span class='neutral'>    );</span>
  15 |     | <span class='neutral'>    event AuthorizationUsed(address indexed authorizer, bytes32 indexed nonce);</span>
  16 |     | <span class='neutral'>    event Blacklisted(address indexed _account);</span>
  17 |     | <span class='neutral'>    event BlacklisterChanged(address indexed newBlacklister);</span>
  18 |     | <span class='neutral'>    event Burn(address indexed burner, uint256 amount);</span>
  19 |     | <span class='neutral'>    event MasterMinterChanged(address indexed newMasterMinter);</span>
  20 |     | <span class='neutral'>    event Mint(address indexed minter, address indexed to, uint256 amount);</span>
  21 |     | <span class='neutral'>    event MinterConfigured(address indexed minter, uint256 minterAllowedAmount);</span>
  22 |     | <span class='neutral'>    event MinterRemoved(address indexed oldMinter);</span>
  23 |     | <span class='neutral'>    event OwnershipTransferred(address previousOwner, address newOwner);</span>
  24 |     | <span class='neutral'>    event Pause();</span>
  25 |     | <span class='neutral'>    event PauserChanged(address indexed newAddress);</span>
  26 |     | <span class='neutral'>    event RescuerChanged(address indexed newRescuer);</span>
  27 |     | <span class='neutral'>    event Transfer(address indexed from, address indexed to, uint256 value);</span>
  28 |     | <span class='neutral'>    event UnBlacklisted(address indexed _account);</span>
  29 |     | <span class='neutral'>    event Unpause();</span>
  30 |     | <span class='neutral'></span>
  31 |     | <span class='neutral'>    function CANCEL_AUTHORIZATION_TYPEHASH() external view returns (bytes32);</span>
  32 |     | <span class='neutral'></span>
  33 |     | <span class='neutral'>    function DOMAIN_SEPARATOR() external view returns (bytes32);</span>
  34 |     | <span class='neutral'></span>
  35 |     | <span class='neutral'>    function PERMIT_TYPEHASH() external view returns (bytes32);</span>
  36 |     | <span class='neutral'></span>
  37 |     | <span class='neutral'>    function RECEIVE_WITH_AUTHORIZATION_TYPEHASH()</span>
  38 |     | <span class='neutral'>        external</span>
  39 |     | <span class='neutral'>        view</span>
  40 |     | <span class='neutral'>        returns (bytes32);</span>
  41 |     | <span class='neutral'></span>
  42 |     | <span class='neutral'>    function TRANSFER_WITH_AUTHORIZATION_TYPEHASH()</span>
  43 |     | <span class='neutral'>        external</span>
  44 |     | <span class='neutral'>        view</span>
  45 |     | <span class='neutral'>        returns (bytes32);</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    function allowance(address owner, address spender)</span>
  48 |     | <span class='neutral'>        external</span>
  49 |     | <span class='neutral'>        view</span>
  50 |     | <span class='neutral'>        returns (uint256);</span>
  51 |     | <span class='neutral'></span>
  52 |     | <span class='neutral'>    function approve(address spender, uint256 value) external returns (bool);</span>
  53 |     | <span class='neutral'></span>
  54 |     | <span class='neutral'>    function authorizationState(address authorizer, bytes32 nonce)</span>
  55 |     | <span class='neutral'>        external</span>
  56 |     | <span class='neutral'>        view</span>
  57 |     | <span class='neutral'>        returns (bool);</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    function balanceOf(address account) external view returns (uint256);</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    function blacklist(address _account) external;</span>
  62 |     | <span class='neutral'></span>
  63 |     | <span class='neutral'>    function blacklister() external view returns (address);</span>
  64 |     | <span class='neutral'></span>
  65 |     | <span class='neutral'>    function burn(uint256 _amount) external;</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='neutral'>    function cancelAuthorization(</span>
  68 |     | <span class='neutral'>        address authorizer,</span>
  69 |     | <span class='neutral'>        bytes32 nonce,</span>
  70 |     | <span class='neutral'>        uint8 v,</span>
  71 |     | <span class='neutral'>        bytes32 r,</span>
  72 |     | <span class='neutral'>        bytes32 s</span>
  73 |     | <span class='neutral'>    ) external;</span>
  74 |     | <span class='neutral'></span>
  75 |     | <span class='neutral'>    function configureMinter(address minter, uint256 minterAllowedAmount)</span>
  76 |     | <span class='neutral'>        external</span>
  77 |     | <span class='neutral'>        returns (bool);</span>
  78 |     | <span class='neutral'></span>
  79 |     | <span class='neutral'>    function currency() external view returns (string memory);</span>
  80 |     | <span class='neutral'></span>
  81 |     | <span class='neutral'>    function decimals() external view returns (uint8);</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    function decreaseAllowance(address spender, uint256 decrement)</span>
  84 |     | <span class='neutral'>        external</span>
  85 |     | <span class='neutral'>        returns (bool);</span>
  86 |     | <span class='neutral'></span>
  87 |     | <span class='neutral'>    function increaseAllowance(address spender, uint256 increment)</span>
  88 |     | <span class='neutral'>        external</span>
  89 |     | <span class='neutral'>        returns (bool);</span>
  90 |     | <span class='neutral'></span>
  91 |     | <span class='neutral'>    function initialize(</span>
  92 |     | <span class='neutral'>        string memory tokenName,</span>
  93 |     | <span class='neutral'>        string memory tokenSymbol,</span>
  94 |     | <span class='neutral'>        string memory tokenCurrency,</span>
  95 |     | <span class='neutral'>        uint8 tokenDecimals,</span>
  96 |     | <span class='neutral'>        address newMasterMinter,</span>
  97 |     | <span class='neutral'>        address newPauser,</span>
  98 |     | <span class='neutral'>        address newBlacklister,</span>
  99 |     | <span class='neutral'>        address newOwner</span>
 100 |     | <span class='neutral'>    ) external;</span>
 101 |     | <span class='neutral'></span>
 102 |     | <span class='neutral'>    function initializeV2(string memory newName) external;</span>
 103 |     | <span class='neutral'></span>
 104 |     | <span class='neutral'>    function initializeV2_1(address lostAndFound) external;</span>
 105 |     | <span class='neutral'></span>
 106 |     | <span class='neutral'>    function isBlacklisted(address _account) external view returns (bool);</span>
 107 |     | <span class='neutral'></span>
 108 |     | <span class='neutral'>    function isMinter(address account) external view returns (bool);</span>
 109 |     | <span class='neutral'></span>
 110 |     | <span class='neutral'>    function masterMinter() external view returns (address);</span>
 111 |     | <span class='neutral'></span>
 112 |     | <span class='neutral'>    function mint(address _to, uint256 _amount) external returns (bool);</span>
 113 |     | <span class='neutral'></span>
 114 |     | <span class='neutral'>    function minterAllowance(address minter) external view returns (uint256);</span>
 115 |     | <span class='neutral'></span>
 116 |     | <span class='neutral'>    function name() external view returns (string memory);</span>
 117 |     | <span class='neutral'></span>
 118 |     | <span class='neutral'>    function nonces(address owner) external view returns (uint256);</span>
 119 |     | <span class='neutral'></span>
 120 |     | <span class='neutral'>    function owner() external view returns (address);</span>
 121 |     | <span class='neutral'></span>
 122 |     | <span class='neutral'>    function pause() external;</span>
 123 |     | <span class='neutral'></span>
 124 |     | <span class='neutral'>    function paused() external view returns (bool);</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    function pauser() external view returns (address);</span>
 127 |     | <span class='neutral'></span>
 128 |     | <span class='neutral'>    function permit(</span>
 129 |     | <span class='neutral'>        address owner,</span>
 130 |     | <span class='neutral'>        address spender,</span>
 131 |     | <span class='neutral'>        uint256 value,</span>
 132 |     | <span class='neutral'>        uint256 deadline,</span>
 133 |     | <span class='neutral'>        uint8 v,</span>
 134 |     | <span class='neutral'>        bytes32 r,</span>
 135 |     | <span class='neutral'>        bytes32 s</span>
 136 |     | <span class='neutral'>    ) external;</span>
 137 |     | <span class='neutral'></span>
 138 |     | <span class='neutral'>    function receiveWithAuthorization(</span>
 139 |     | <span class='neutral'>        address from,</span>
 140 |     | <span class='neutral'>        address to,</span>
 141 |     | <span class='neutral'>        uint256 value,</span>
 142 |     | <span class='neutral'>        uint256 validAfter,</span>
 143 |     | <span class='neutral'>        uint256 validBefore,</span>
 144 |     | <span class='neutral'>        bytes32 nonce,</span>
 145 |     | <span class='neutral'>        uint8 v,</span>
 146 |     | <span class='neutral'>        bytes32 r,</span>
 147 |     | <span class='neutral'>        bytes32 s</span>
 148 |     | <span class='neutral'>    ) external;</span>
 149 |     | <span class='neutral'></span>
 150 |     | <span class='neutral'>    function removeMinter(address minter) external returns (bool);</span>
 151 |     | <span class='neutral'></span>
 152 |     | <span class='neutral'>    function rescueERC20(</span>
 153 |     | <span class='neutral'>        address tokenContract,</span>
 154 |     | <span class='neutral'>        address to,</span>
 155 |     | <span class='neutral'>        uint256 amount</span>
 156 |     | <span class='neutral'>    ) external;</span>
 157 |     | <span class='neutral'></span>
 158 |     | <span class='neutral'>    function rescuer() external view returns (address);</span>
 159 |     | <span class='neutral'></span>
 160 |     | <span class='neutral'>    function symbol() external view returns (string memory);</span>
 161 |     | <span class='neutral'></span>
 162 |     | <span class='neutral'>    function totalSupply() external view returns (uint256);</span>
 163 |     | <span class='neutral'></span>
 164 |     | <span class='neutral'>    function transfer(address to, uint256 value) external returns (bool);</span>
 165 |     | <span class='neutral'></span>
 166 |     | <span class='neutral'>    function transferFrom(</span>
 167 |     | <span class='neutral'>        address from,</span>
 168 |     | <span class='neutral'>        address to,</span>
 169 |     | <span class='neutral'>        uint256 value</span>
 170 |     | <span class='neutral'>    ) external returns (bool);</span>
 171 |     | <span class='neutral'></span>
 172 |     | <span class='neutral'>    function transferOwnership(address newOwner) external;</span>
 173 |     | <span class='neutral'></span>
 174 |     | <span class='neutral'>    function transferWithAuthorization(</span>
 175 |     | <span class='neutral'>        address from,</span>
 176 |     | <span class='neutral'>        address to,</span>
 177 |     | <span class='neutral'>        uint256 value,</span>
 178 |     | <span class='neutral'>        uint256 validAfter,</span>
 179 |     | <span class='neutral'>        uint256 validBefore,</span>
 180 |     | <span class='neutral'>        bytes32 nonce,</span>
 181 |     | <span class='neutral'>        uint8 v,</span>
 182 |     | <span class='neutral'>        bytes32 r,</span>
 183 |     | <span class='neutral'>        bytes32 s</span>
 184 |     | <span class='neutral'>    ) external;</span>
 185 |     | <span class='neutral'></span>
 186 |     | <span class='neutral'>    function unBlacklist(address _account) external;</span>
 187 |     | <span class='neutral'></span>
 188 |     | <span class='neutral'>    function unpause() external;</span>
 189 |     | <span class='neutral'></span>
 190 |     | <span class='neutral'>    function updateBlacklister(address _newBlacklister) external;</span>
 191 |     | <span class='neutral'></span>
 192 |     | <span class='neutral'>    function updateMasterMinter(address _newMasterMinter) external;</span>
 193 |     | <span class='neutral'></span>
 194 |     | <span class='neutral'>    function updatePauser(address _newPauser) external;</span>
 195 |     | <span class='neutral'></span>
 196 |     | <span class='neutral'>    function updateRescuer(address newRescuer) external;</span>
 197 |     | <span class='neutral'></span>
 198 |     | <span class='neutral'>    function version() external view returns (string memory);</span>
 199 |     | <span class='neutral'>}</span>
 200 |     | <span class='neutral'></span>
 201 |     | <span class='neutral'>// THIS FILE WAS AUTOGENERATED FROM THE FOLLOWING ABI JSON:</span>
 202 |     | <span class='neutral'>/*</span>
 203 |     | <span class='neutral'>[{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;owner&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Approval&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;authorizer&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;nonce&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;name&quot;:&quot;AuthorizationCanceled&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;authorizer&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;nonce&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;name&quot;:&quot;AuthorizationUsed&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;_account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;Blacklisted&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newBlacklister&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;BlacklisterChanged&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;burner&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Burn&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newMasterMinter&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;MasterMinterChanged&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;minter&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Mint&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;minter&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;minterAllowedAmount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;MinterConfigured&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;oldMinter&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;MinterRemoved&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;previousOwner&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newOwner&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;OwnershipTransferred&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[],&quot;name&quot;:&quot;Pause&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newAddress&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;PauserChanged&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newRescuer&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;RescuerChanged&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Transfer&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;_account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;UnBlacklisted&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[],&quot;name&quot;:&quot;Unpause&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;CANCEL_AUTHORIZATION_TYPEHASH&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;DOMAIN_SEPARATOR&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;PERMIT_TYPEHASH&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;RECEIVE_WITH_AUTHORIZATION_TYPEHASH&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;TRANSFER_WITH_AUTHORIZATION_TYPEHASH&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;owner&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;allowance&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;approve&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;authorizer&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;nonce&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;name&quot;:&quot;authorizationState&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;balanceOf&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;_account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;blacklist&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;blacklister&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;_amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;burn&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;authorizer&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;nonce&quot;,&quot;type&quot;:&quot;bytes32&quot;},{&quot;internalType&quot;:&quot;uint8&quot;,&quot;name&quot;:&quot;v&quot;,&quot;type&quot;:&quot;uint8&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;r&quot;,&quot;type&quot;:&quot;bytes32&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;s&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;name&quot;:&quot;cancelAuthorization&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;minter&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;minterAllowedAmount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;configureMinter&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;currency&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;decimals&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;uint8&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint8&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;decrement&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;decreaseAllowance&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;increment&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;increaseAllowance&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;tokenName&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;tokenSymbol&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;tokenCurrency&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;internalType&quot;:&quot;uint8&quot;,&quot;name&quot;:&quot;tokenDecimals&quot;,&quot;type&quot;:&quot;uint8&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newMasterMinter&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newPauser&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newBlacklister&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newOwner&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;initialize&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;newName&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;initializeV2&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;lostAndFound&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;initializeV2_1&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;_account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;isBlacklisted&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;isMinter&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;masterMinter&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;_to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;_amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;mint&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;minter&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;minterAllowance&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;name&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;owner&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;nonces&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;owner&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;pause&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;paused&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;pauser&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;owner&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;deadline&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;internalType&quot;:&quot;uint8&quot;,&quot;name&quot;:&quot;v&quot;,&quot;type&quot;:&quot;uint8&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;r&quot;,&quot;type&quot;:&quot;bytes32&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;s&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;name&quot;:&quot;permit&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;validAfter&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;validBefore&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;nonce&quot;,&quot;type&quot;:&quot;bytes32&quot;},{&quot;internalType&quot;:&quot;uint8&quot;,&quot;name&quot;:&quot;v&quot;,&quot;type&quot;:&quot;uint8&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;r&quot;,&quot;type&quot;:&quot;bytes32&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;s&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;name&quot;:&quot;receiveWithAuthorization&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;minter&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;removeMinter&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;contract IERC20&quot;,&quot;name&quot;:&quot;tokenContract&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;rescueERC20&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;rescuer&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;symbol&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;totalSupply&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transfer&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transferFrom&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newOwner&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;transferOwnership&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;validAfter&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;internalType&quot;:&quot;uint256&quot;,&quot;name&quot;:&quot;validBefore&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;nonce&quot;,&quot;type&quot;:&quot;bytes32&quot;},{&quot;internalType&quot;:&quot;uint8&quot;,&quot;name&quot;:&quot;v&quot;,&quot;type&quot;:&quot;uint8&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;r&quot;,&quot;type&quot;:&quot;bytes32&quot;},{&quot;internalType&quot;:&quot;bytes32&quot;,&quot;name&quot;:&quot;s&quot;,&quot;type&quot;:&quot;bytes32&quot;}],&quot;name&quot;:&quot;transferWithAuthorization&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;_account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;unBlacklist&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;unpause&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;_newBlacklister&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;updateBlacklister&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;_newMasterMinter&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;updateMasterMinter&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;_newPauser&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;updatePauser&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;newRescuer&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;updateRescuer&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;version&quot;,&quot;outputs&quot;:[{&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;}]</span>
 204 |     | <span class='neutral'>*/</span>
 205 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/interfaces/IVirtualLP.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
  2 |     | <span class='neutral'>pragma solidity =0.8.19;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>interface IVirtualLP {</span>
  5 |     | <span class='neutral'>    function PSM_sendToPortalUser(address _recipient, uint256 _amount) external;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>    function depositToYieldSource(address _asset, uint256 _amount) external;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    function withdrawFromYieldSource(</span>
 10 |     | <span class='neutral'>        address _asset,</span>
 11 |     | <span class='neutral'>        address _user,</span>
 12 |     | <span class='neutral'>        uint256 _amount</span>
 13 |     | <span class='neutral'>    ) external;</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'>    function isActiveLP() external view returns (bool);</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    function fundingRewardPool() external view returns (uint256);</span>
 18 |     | <span class='neutral'>}</span>
 19 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/interfaces/IWater.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity =0.8.19;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>interface IWater {</span>
  5 |     | <span class='neutral'>    function deposit(</span>
  6 |     | <span class='neutral'>        uint256 _assets,</span>
  7 |     | <span class='neutral'>        address _receiver</span>
  8 |     | <span class='neutral'>    ) external returns (uint256);</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'>    function withdraw(</span>
 11 |     | <span class='neutral'>        uint256 _assets,</span>
 12 |     | <span class='neutral'>        address _receiver,</span>
 13 |     | <span class='neutral'>        address _owner</span>
 14 |     | <span class='neutral'>    ) external returns (uint256);</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    function withdrawETH(uint256 _assets) external returns (uint256);</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='neutral'>    function convertToShares(uint256 assets) external view returns (uint256);</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    function convertToAssets(uint256 shares) external view returns (uint256);</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='neutral'>    function lockTime() external view returns (uint256);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    function withdrawalFees() external view returns (uint256);</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'>    function DENOMINATOR() external view returns (uint256);</span>
 27 |     | <span class='neutral'>}</span>
 28 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/secoalba/Documents/PROGRAMACION/BLOCKCHAIN_DEV/SOLIDITY/SECURITY/AUDIT/PRIVATE/Portals-local/src/V2MultiAsset/interfaces/IcEther.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: UNLICENSED</span>
   2 |     | <span class='neutral'>// !! THIS FILE WAS AUTOGENERATED BY abi-to-sol v0.6.6. SEE SOURCE BELOW. !!</span>
   3 |     | <span class='neutral'>pragma solidity &gt;=0.7.0 &lt;0.9.0;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>interface IcEther {</span>
   6 |     | <span class='neutral'>    function name() external view returns (string memory);</span>
   7 |     | <span class='neutral'></span>
   8 |     | <span class='neutral'>    function approve(address spender, uint256 amount) external returns (bool);</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>    function mint() external payable;</span>
  11 |     | <span class='neutral'></span>
  12 |     | <span class='neutral'>    function reserveFactorMantissa() external view returns (uint256);</span>
  13 |     | <span class='neutral'></span>
  14 |     | <span class='neutral'>    function borrowBalanceCurrent(address account) external returns (uint256);</span>
  15 |     | <span class='neutral'></span>
  16 |     | <span class='neutral'>    function totalSupply() external view returns (uint256);</span>
  17 |     | <span class='neutral'></span>
  18 |     | <span class='neutral'>    function exchangeRateStored() external view returns (uint256);</span>
  19 |     | <span class='neutral'></span>
  20 |     | <span class='neutral'>    function transferFrom(</span>
  21 |     | <span class='neutral'>        address src,</span>
  22 |     | <span class='neutral'>        address dst,</span>
  23 |     | <span class='neutral'>        uint256 amount</span>
  24 |     | <span class='neutral'>    ) external returns (bool);</span>
  25 |     | <span class='neutral'></span>
  26 |     | <span class='neutral'>    function pendingAdmin() external view returns (address);</span>
  27 |     | <span class='neutral'></span>
  28 |     | <span class='neutral'>    function decimals() external view returns (uint256);</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    function balanceOfUnderlying(address owner) external returns (uint256);</span>
  31 |     | <span class='neutral'></span>
  32 |     | <span class='neutral'>    function getCash() external view returns (uint256);</span>
  33 |     | <span class='neutral'></span>
  34 |     | <span class='neutral'>    function _setComptroller(address newComptroller) external returns (uint256);</span>
  35 |     | <span class='neutral'></span>
  36 |     | <span class='neutral'>    function totalBorrows() external view returns (uint256);</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    function repayBorrow() external payable;</span>
  39 |     | <span class='neutral'></span>
  40 |     | <span class='neutral'>    function comptroller() external view returns (address);</span>
  41 |     | <span class='neutral'></span>
  42 |     | <span class='neutral'>    function _reduceReserves(uint256 reduceAmount) external returns (uint256);</span>
  43 |     | <span class='neutral'></span>
  44 |     | <span class='neutral'>    function initialExchangeRateMantissa() external view returns (uint256);</span>
  45 |     | <span class='neutral'></span>
  46 |     | <span class='neutral'>    function accrualBlockNumber() external view returns (uint256);</span>
  47 |     | <span class='neutral'></span>
  48 |     | <span class='neutral'>    function balanceOf(address owner) external view returns (uint256);</span>
  49 |     | <span class='neutral'></span>
  50 |     | <span class='neutral'>    function totalBorrowsCurrent() external returns (uint256);</span>
  51 |     | <span class='neutral'></span>
  52 |     | <span class='neutral'>    function redeemUnderlying(uint256 redeemAmount) external returns (uint256);</span>
  53 |     | <span class='neutral'></span>
  54 |     | <span class='neutral'>    function totalReserves() external view returns (uint256);</span>
  55 |     | <span class='neutral'></span>
  56 |     | <span class='neutral'>    function symbol() external view returns (string memory);</span>
  57 |     | <span class='neutral'></span>
  58 |     | <span class='neutral'>    function borrowBalanceStored(address account)</span>
  59 |     | <span class='neutral'>        external</span>
  60 |     | <span class='neutral'>        view</span>
  61 |     | <span class='neutral'>        returns (uint256);</span>
  62 |     | <span class='neutral'></span>
  63 |     | <span class='neutral'>    function accrueInterest() external returns (uint256);</span>
  64 |     | <span class='neutral'></span>
  65 |     | <span class='neutral'>    function transfer(address dst, uint256 amount) external returns (bool);</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='neutral'>    function borrowIndex() external view returns (uint256);</span>
  68 |     | <span class='neutral'></span>
  69 |     | <span class='neutral'>    function liquidateBorrow(address borrower, address cTokenCollateral)</span>
  70 |     | <span class='neutral'>        external</span>
  71 |     | <span class='neutral'>        payable;</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='neutral'>    function supplyRatePerBlock() external view returns (uint256);</span>
  74 |     | <span class='neutral'></span>
  75 |     | <span class='neutral'>    function seize(</span>
  76 |     | <span class='neutral'>        address liquidator,</span>
  77 |     | <span class='neutral'>        address borrower,</span>
  78 |     | <span class='neutral'>        uint256 seizeTokens</span>
  79 |     | <span class='neutral'>    ) external returns (uint256);</span>
  80 |     | <span class='neutral'></span>
  81 |     | <span class='neutral'>    function _setPendingAdmin(address newPendingAdmin)</span>
  82 |     | <span class='neutral'>        external</span>
  83 |     | <span class='neutral'>        returns (uint256);</span>
  84 |     | <span class='neutral'></span>
  85 |     | <span class='neutral'>    function exchangeRateCurrent() external returns (uint256);</span>
  86 |     | <span class='neutral'></span>
  87 |     | <span class='neutral'>    function getAccountSnapshot(address account)</span>
  88 |     | <span class='neutral'>        external</span>
  89 |     | <span class='neutral'>        view</span>
  90 |     | <span class='neutral'>        returns (</span>
  91 |     | <span class='neutral'>            uint256,</span>
  92 |     | <span class='neutral'>            uint256,</span>
  93 |     | <span class='neutral'>            uint256,</span>
  94 |     | <span class='neutral'>            uint256</span>
  95 |     | <span class='neutral'>        );</span>
  96 |     | <span class='neutral'></span>
  97 |     | <span class='neutral'>    function borrow(uint256 borrowAmount) external returns (uint256);</span>
  98 |     | <span class='neutral'></span>
  99 |     | <span class='neutral'>    function redeem(uint256 redeemTokens) external returns (uint256);</span>
 100 |     | <span class='neutral'></span>
 101 |     | <span class='neutral'>    function allowance(address owner, address spender)</span>
 102 |     | <span class='neutral'>        external</span>
 103 |     | <span class='neutral'>        view</span>
 104 |     | <span class='neutral'>        returns (uint256);</span>
 105 |     | <span class='neutral'></span>
 106 |     | <span class='neutral'>    function repayBorrowBehalf(address borrower) external payable;</span>
 107 |     | <span class='neutral'></span>
 108 |     | <span class='neutral'>    function _acceptAdmin() external returns (uint256);</span>
 109 |     | <span class='neutral'></span>
 110 |     | <span class='neutral'>    function _setInterestRateModel(address newInterestRateModel)</span>
 111 |     | <span class='neutral'>        external</span>
 112 |     | <span class='neutral'>        returns (uint256);</span>
 113 |     | <span class='neutral'></span>
 114 |     | <span class='neutral'>    function interestRateModel() external view returns (address);</span>
 115 |     | <span class='neutral'></span>
 116 |     | <span class='neutral'>    function admin() external view returns (address);</span>
 117 |     | <span class='neutral'></span>
 118 |     | <span class='neutral'>    function borrowRatePerBlock() external view returns (uint256);</span>
 119 |     | <span class='neutral'></span>
 120 |     | <span class='neutral'>    function _setReserveFactor(uint256 newReserveFactorMantissa)</span>
 121 |     | <span class='neutral'>        external</span>
 122 |     | <span class='neutral'>        returns (uint256);</span>
 123 |     | <span class='neutral'></span>
 124 |     | <span class='neutral'>    function isCToken() external view returns (bool);</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    fallback() external payable;</span>
 127 |     | <span class='neutral'></span>
 128 |     | <span class='neutral'>    event AccrueInterest(</span>
 129 |     | <span class='neutral'>        uint256 interestAccumulated,</span>
 130 |     | <span class='neutral'>        uint256 borrowIndex,</span>
 131 |     | <span class='neutral'>        uint256 totalBorrows</span>
 132 |     | <span class='neutral'>    );</span>
 133 |     | <span class='neutral'>    event Mint(address minter, uint256 mintAmount, uint256 mintTokens);</span>
 134 |     | <span class='neutral'>    event Redeem(address redeemer, uint256 redeemAmount, uint256 redeemTokens);</span>
 135 |     | <span class='neutral'>    event Borrow(</span>
 136 |     | <span class='neutral'>        address borrower,</span>
 137 |     | <span class='neutral'>        uint256 borrowAmount,</span>
 138 |     | <span class='neutral'>        uint256 accountBorrows,</span>
 139 |     | <span class='neutral'>        uint256 totalBorrows</span>
 140 |     | <span class='neutral'>    );</span>
 141 |     | <span class='neutral'>    event RepayBorrow(</span>
 142 |     | <span class='neutral'>        address payer,</span>
 143 |     | <span class='neutral'>        address borrower,</span>
 144 |     | <span class='neutral'>        uint256 repayAmount,</span>
 145 |     | <span class='neutral'>        uint256 accountBorrows,</span>
 146 |     | <span class='neutral'>        uint256 totalBorrows</span>
 147 |     | <span class='neutral'>    );</span>
 148 |     | <span class='neutral'>    event LiquidateBorrow(</span>
 149 |     | <span class='neutral'>        address liquidator,</span>
 150 |     | <span class='neutral'>        address borrower,</span>
 151 |     | <span class='neutral'>        uint256 repayAmount,</span>
 152 |     | <span class='neutral'>        address cTokenCollateral,</span>
 153 |     | <span class='neutral'>        uint256 seizeTokens</span>
 154 |     | <span class='neutral'>    );</span>
 155 |     | <span class='neutral'>    event NewPendingAdmin(address oldPendingAdmin, address newPendingAdmin);</span>
 156 |     | <span class='neutral'>    event NewAdmin(address oldAdmin, address newAdmin);</span>
 157 |     | <span class='neutral'>    event NewComptroller(address oldComptroller, address newComptroller);</span>
 158 |     | <span class='neutral'>    event NewMarketInterestRateModel(</span>
 159 |     | <span class='neutral'>        address oldInterestRateModel,</span>
 160 |     | <span class='neutral'>        address newInterestRateModel</span>
 161 |     | <span class='neutral'>    );</span>
 162 |     | <span class='neutral'>    event NewReserveFactor(</span>
 163 |     | <span class='neutral'>        uint256 oldReserveFactorMantissa,</span>
 164 |     | <span class='neutral'>        uint256 newReserveFactorMantissa</span>
 165 |     | <span class='neutral'>    );</span>
 166 |     | <span class='neutral'>    event ReservesReduced(</span>
 167 |     | <span class='neutral'>        address admin,</span>
 168 |     | <span class='neutral'>        uint256 reduceAmount,</span>
 169 |     | <span class='neutral'>        uint256 newTotalReserves</span>
 170 |     | <span class='neutral'>    );</span>
 171 |     | <span class='neutral'>    event Failure(uint256 error, uint256 info, uint256 detail);</span>
 172 |     | <span class='neutral'>    event Transfer(address indexed from, address indexed to, uint256 amount);</span>
 173 |     | <span class='neutral'>    event Approval(</span>
 174 |     | <span class='neutral'>        address indexed owner,</span>
 175 |     | <span class='neutral'>        address indexed spender,</span>
 176 |     | <span class='neutral'>        uint256 amount</span>
 177 |     | <span class='neutral'>    );</span>
 178 |     | <span class='neutral'>}</span>
 179 |     | <span class='neutral'></span>
 180 |     | <span class='neutral'>// THIS FILE WAS AUTOGENERATED FROM THE FOLLOWING ABI JSON:</span>
 181 |     | <span class='neutral'>/*</span>
 182 |     | <span class='neutral'>[{&quot;inputs&quot;:[],&quot;name&quot;:&quot;name&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;approve&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;mint&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;payable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;reserveFactorMantissa&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;borrowBalanceCurrent&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;totalSupply&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;exchangeRateStored&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;src&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;dst&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transferFrom&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;pendingAdmin&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;decimals&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;owner&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;balanceOfUnderlying&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;getCash&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;newComptroller&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;_setComptroller&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;totalBorrows&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;repayBorrow&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;payable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;comptroller&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;reduceAmount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;_reduceReserves&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;initialExchangeRateMantissa&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;accrualBlockNumber&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;owner&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;balanceOf&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;totalBorrowsCurrent&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;redeemAmount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;redeemUnderlying&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;totalReserves&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;symbol&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;borrowBalanceStored&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;accrueInterest&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;dst&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;transfer&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;borrowIndex&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;borrower&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;cTokenCollateral&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;liquidateBorrow&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;payable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;supplyRatePerBlock&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;liquidator&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;borrower&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;seizeTokens&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;seize&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;newPendingAdmin&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;_setPendingAdmin&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;exchangeRateCurrent&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;account&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;getAccountSnapshot&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;borrowAmount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;borrow&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;redeemTokens&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;redeem&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;owner&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;allowance&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;borrower&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;repayBorrowBehalf&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;payable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;_acceptAdmin&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;newInterestRateModel&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;_setInterestRateModel&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;interestRateModel&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;admin&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;borrowRatePerBlock&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;newReserveFactorMantissa&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;_setReserveFactor&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;name&quot;:&quot;isCToken&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;}],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[{&quot;name&quot;:&quot;comptroller_&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;interestRateModel_&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;name&quot;:&quot;initialExchangeRateMantissa_&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;name_&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;name&quot;:&quot;symbol_&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;name&quot;:&quot;decimals_&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;constructor&quot;},{&quot;stateMutability&quot;:&quot;payable&quot;,&quot;type&quot;:&quot;fallback&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;interestAccumulated&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;borrowIndex&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;totalBorrows&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;AccrueInterest&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;minter&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;mintAmount&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;mintTokens&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Mint&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;redeemer&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;redeemAmount&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;redeemTokens&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Redeem&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;borrower&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;borrowAmount&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;accountBorrows&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;totalBorrows&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Borrow&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;payer&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;borrower&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;repayAmount&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;accountBorrows&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;totalBorrows&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;RepayBorrow&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;liquidator&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;borrower&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;repayAmount&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;cTokenCollateral&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;seizeTokens&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;LiquidateBorrow&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;oldPendingAdmin&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;newPendingAdmin&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;NewPendingAdmin&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;oldAdmin&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;newAdmin&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;NewAdmin&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;oldComptroller&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;newComptroller&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;NewComptroller&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;oldInterestRateModel&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;newInterestRateModel&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;name&quot;:&quot;NewMarketInterestRateModel&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;oldReserveFactorMantissa&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;newReserveFactorMantissa&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;NewReserveFactor&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;admin&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;reduceAmount&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;newTotalReserves&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;ReservesReduced&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:false,&quot;name&quot;:&quot;error&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;info&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;detail&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Failure&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;name&quot;:&quot;from&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:true,&quot;name&quot;:&quot;to&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Transfer&quot;,&quot;type&quot;:&quot;event&quot;},{&quot;anonymous&quot;:false,&quot;inputs&quot;:[{&quot;indexed&quot;:true,&quot;name&quot;:&quot;owner&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:true,&quot;name&quot;:&quot;spender&quot;,&quot;type&quot;:&quot;address&quot;},{&quot;indexed&quot;:false,&quot;name&quot;:&quot;amount&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;Approval&quot;,&quot;type&quot;:&quot;event&quot;}]</span>
 183 |     | <span class='neutral'>*/</span>
 184 |     | <span class='neutral'></span>

</code>
<br />

